[
  {
    "objectID": "qmd_to_R_Script.html",
    "href": "qmd_to_R_Script.html",
    "title": "Convert .qmd Quarto file to .R Script",
    "section": "",
    "text": "If your adviser wants you to send them your code in a .R Script, but you originally wrote it in a .qmd file…\n\nthis process removes the text parts of the .qmd, just keeps code and comments within all code chunks\n\n\nOpen RStudio by double clicking on your .qmd file (which auto sets the working directory to that folder)\nClose just .qmd file (leave RStudio open)\n\n\nOr you could open RStudio and manually set the working directory the folder where .qmd file is (RStudio &gt; Session &gt; Set working directory)\n\n\nRun code below in Rstudio console (but edit file_name.qmd to match your .qmd file name):\n\nknitr::purl(\"file_name.qmd\")\nThis will save a new .R script file in that folder that is just the code from your .qmd file\n\nAdapted from https://bookdown.org/yihui/rmarkdown-cookbook/purl.html\n(.Rmd works same way as .qmd)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BIO 5100 Resources",
    "section": "",
    "text": "Videos, links and explanation for how to install, and what is R, RStudio and R Packages.\n\n\n\n\n\nSome tasty R code for how to do a variety of tasks in R.\n\n\n\n\n\nGeneral style guidance for writing clear and efficient R code.\nAnd additional style guidance can also be found here: https://r4ds.hadley.nz/workflow-style.html\n\n\n\n\n\nData Carpentry develops workshops on the fundamental data skills needed to conduct research, and its lessons are domain specific (e.g., ecology, genomics, geospatial). Lessons are in the form of self-paced tutorials, and are designed for researchers to teach themselves basic concepts and skills for working with data.\nEcology Workshop\nGenomics Workshop\n\n\n\n\n\nBrief 3-8 min videos on various topics From the Duke Center for Computational Thinking covering topics like data manipulation with dplyr, data visualization with ggplot2, and using other functions from the tidyverse.\n\n\n\n\n\nCheat Sheets for writing various types of R code\nStarting out, I’d suggest downloading (and maybe printing out) these two cheat sheets: Data Visualization w/ ggplot2 & Data Transformation w/ dplyr\n\n\n\n\n\nVisualizes dplyr code to help you understand what specific dplyr functions are doing with the data\n\n\n\n\n\nIf your adviser wants you to send them your code in a .R Script, but you originally wrote it in a .qmd file…\nAn other option is the render your .qmd file to a word doc and email them that."
  },
  {
    "objectID": "index.html#r-coding",
    "href": "index.html#r-coding",
    "title": "BIO 5100 Resources",
    "section": "",
    "text": "Videos, links and explanation for how to install, and what is R, RStudio and R Packages.\n\n\n\n\n\nSome tasty R code for how to do a variety of tasks in R.\n\n\n\n\n\nGeneral style guidance for writing clear and efficient R code.\nAnd additional style guidance can also be found here: https://r4ds.hadley.nz/workflow-style.html\n\n\n\n\n\nData Carpentry develops workshops on the fundamental data skills needed to conduct research, and its lessons are domain specific (e.g., ecology, genomics, geospatial). Lessons are in the form of self-paced tutorials, and are designed for researchers to teach themselves basic concepts and skills for working with data.\nEcology Workshop\nGenomics Workshop\n\n\n\n\n\nBrief 3-8 min videos on various topics From the Duke Center for Computational Thinking covering topics like data manipulation with dplyr, data visualization with ggplot2, and using other functions from the tidyverse.\n\n\n\n\n\nCheat Sheets for writing various types of R code\nStarting out, I’d suggest downloading (and maybe printing out) these two cheat sheets: Data Visualization w/ ggplot2 & Data Transformation w/ dplyr\n\n\n\n\n\nVisualizes dplyr code to help you understand what specific dplyr functions are doing with the data\n\n\n\n\n\nIf your adviser wants you to send them your code in a .R Script, but you originally wrote it in a .qmd file…\nAn other option is the render your .qmd file to a word doc and email them that."
  },
  {
    "objectID": "index.html#coding-with-ai-help",
    "href": "index.html#coding-with-ai-help",
    "title": "BIO 5100 Resources",
    "section": "Coding with AI help",
    "text": "Coding with AI help\n\nRtutor.ai\n\nAI R code writer, can help you figure out what you need to do or debug your code\n\n\n\nGitHub Copilot in RStudio\n\nTo use GitHub Copilot, you must have a GitHub account and an active subscription to Copilot. GitHub Copilot is free for students and educators.\n\n\n\n(video) How to use GitHub Copilot and ChatGPT in RStudio\n\nIn this video, we learn how to use GitHub Copilot and ChatGPT directly from within RStudio. Specifically, we’ll go over all of the setup steps that are required for using 1) the RStudio Copilot integration, and 2) the chattr package which allows you to interact with Large Language Models (LLMs) like the OpenAI models."
  },
  {
    "objectID": "index.html#quarto",
    "href": "index.html#quarto",
    "title": "BIO 5100 Resources",
    "section": "Quarto",
    "text": "Quarto\n\nquarto.org\n\nMain reference website\n\n\n\nAwesome Quarto (Github site)\n\nA(n awesome) curated list of Quarto talks, tools, examples & articles\n\n\n\n(Video) Getting started with Quarto\n\nThis video walks you through creating documents, presentations, and websites and publishing with Quarto. The video features authoring Quarto documents with executable R code chunks using the RStudio Visual Editor (https://quarto.org/docs/visual-editor/)."
  },
  {
    "objectID": "index.html#statistics",
    "href": "index.html#statistics",
    "title": "BIO 5100 Resources",
    "section": "Statistics",
    "text": "Statistics\n\nMarinStatsLectures Youtube Channel\n\nThese R Programming and Statistics videos/tutorials were originally created for Master’s and PhD students at UBC by Professor Mike Marin and are now available to public. These videos provide a comprehensive and completely free set of tutorials for introductory and intermediate concepts in Statistics and Statistics with R.\n\n\n\nCommon statistical tests as linear models\n\nReference website showing the linear models underlying common parametric and “non-parametric” traditional statistical tests."
  },
  {
    "objectID": "index.html#data-management",
    "href": "index.html#data-management",
    "title": "BIO 5100 Resources",
    "section": "Data Management",
    "text": "Data Management\n\nOpenscapes - Guidance for data organization in spreadsheets\n\nCompiled (by openscapes.org) guidance from multiple resources for how to organize and format your data in spreadsheets so that it is ready to analyze in R and follows “tidy data” principles.\n\n\n\nHow to name things (files) - by Jenny Bryan\n\nBest practices for naming your files by Jenny Bryan (& she’s got lots of other great resources on her website)\n\n\n\nData Carpentry - Common Mistakes Storing Data in Spreadsheets"
  },
  {
    "objectID": "index.html#misc.",
    "href": "index.html#misc.",
    "title": "BIO 5100 Resources",
    "section": "Misc.",
    "text": "Misc.\n\nScientific writing resources\n\nLinks to papers with advice on scientific writing, including specifics on how to write statistical methods and results sections\n\n\n\nConnect your Google Scholar to CPP Library to access pdfs of journal articles\n\nLink your CPP library account to your google scholar\n\n\n\nHow to appropriately cite R and R packages\n\nA short primer from a popular R blog on how to cite R and R packages in your thesis, publications, etc.\n\n\n\nFisheries-Related R Packages"
  },
  {
    "objectID": "index.html#continue-your-learning",
    "href": "index.html#continue-your-learning",
    "title": "BIO 5100 Resources",
    "section": "Continue your learning",
    "text": "Continue your learning\n\nTidy Tuesday Website\n\nThe weekly #TidyTuesday event people all over the world are doing! Every week they post a raw dataset, a chart or article related to that dataset, and ask you to explore the data. Some people will then post what they come up with on Twitter. A good way to keep practicing your R skills after Bio 5100 is over, can make it weekly thing you do with fellow students…\n\n\n\nprstatistics.com (statistics workshops)\n\nCompany that offers ~1 week workshops on various specific biostatistics and R coding topics.\n\n\n\nHighland Statistics (advanced statistics workshops and books)\n\nCompany that offers “how to” textbooks and ~1 week workshops on advanced statistics topics (e.g., generalized linear models, mixed models)."
  },
  {
    "objectID": "index.html#communities-to-join",
    "href": "index.html#communities-to-join",
    "title": "BIO 5100 Resources",
    "section": "Communities to join",
    "text": "Communities to join\n\nR Ladies\n\nAttend events, or join a Local Chapter (e.g., R Ladies Pasadena,R Ladies Riverside)\n\n\n\nData Science Hangout\n\nJoin a community of data scientists that share insights about what it means to be a responsible, effective, and inspiring leader."
  },
  {
    "objectID": "Example_Code.html",
    "href": "Example_Code.html",
    "title": "Example Code from BIO 5100/L",
    "section": "",
    "text": "Spring 2024 BIO 5100/L class notes and example code\nWeek 2-3 Visualize distributions & descriptive statistics\nWeek 4-5 Scatterplots, correlation, linear models (simple linear regression)\nWeek 7 Linear model to compare means, 2 independent samples and paired data"
  },
  {
    "objectID": "Online_Books.html",
    "href": "Online_Books.html",
    "title": "Online Books",
    "section": "",
    "text": "Statistical Inference via Data Science (A ModernDive into R and the Tidyverse)\n\nIntroduction to R, RStudio and the Tidyverse for visualizing, wrangling and analyzing your data.\n\n\n\nApplied Statistics for Experimental Biology by Jeffrey A. Walker\n\n(Primary text we follow for BIO 5100/L) Takes a statistical modeling approach, focusing on estimates of effects and uncertainty instead of traditional hypothesis testing.\n\n\n\nR for Data Science (2nd Edition) by Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund\n\nMostly covers details of using the tidyverse to import, wrangle and get your data ready to analyze.\n\n\n\nGuide to Effect Sizes and Confidence Intervals\n\nCollaborative guide aims to provide academics, students and researchers with hands-on, step-by-step instructions for calculating effect sizes and confidence intervals for common statistical procedures.\n\n\n\nFundamentals of Data Visualization (using R) by Claus O. Wilke\n\nA guide to making visualizations that accurately reflect the data, tell a story, and look professional.\nThe R code for the book can be found on GitHub, at https://github.com/clauswilke/dataviz\n\n\n\nAnalysis of community ecology data in R by David Zelený\n\nMultivariate analysis including ordination (e.g., PCA, nMDS plots), cluster analysis and diversity analysis\n\n\n\nApplied Biostats by Yaniv Brandvain\n\nA “book” written to accompany his biostats course, lots of good guidance and resources.\n\n\n\nStatistical Thinking for the 21st Century by Russell A. Poldrack\n\nModern approach to introductory statistics, good sections on plotting and summarizing data.\n\n\n\nIntroduction to Modern Statistics by Mine Çetinkaya-Rundel & Johanna Hardin\n\nModern take on introductory statistics in an R based format.\n\n\n\nModern Statistics for Modern Biology by Susan Holmes, Wolfgang Huber\n\nCovers many modern approaches to data analysis, and many different types of data including RNA-Seq, flow-cytometry, taxa abundances, imaging data and single cell measurements.\nNote some of the R code relies on Base R instead of Tidyverse functions.\n\n\n\nBeyond Multiple Linear Regression: Generalized Linear Models and Multilevel Models By Julie Legler and Paul Roback\n\nMore advanced stats topics including Generalized Linear Models likelihood theory, zero-inflated Poisson, and parametric bootstrapping\n\n\n\nBiological Statistics by John H. McDonald\n\nTraditional statistics text, covering details of specific hypothesis tests (not R based, but potentially useful if your adviser makes you to use old school statistics)\n\n\n\nThe Big Book of R (links to online textbooks)\n\nA maintained list of of online R textbook resources"
  },
  {
    "objectID": "Distributions.html",
    "href": "Distributions.html",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "You only need to “install” packages (download them to your computer) once.\nIf you have not already installed the tidyverse package to the computer you are using you can do so by: RStudio &gt; Tools &gt; Install Packages (type in package name)\nBut you have to “load” packages during each R session in order to use the functions within them\n\n\n1library(tidyverse)\n2library(skimr)\n\n\n1\n\nload the tidyverse package (which includes ggplot2 and dplyr)\n\n2\n\nload the skimr package (which includes the skim() function for descriptive statistics)\n\n\n\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse). You could alternatively load them separately library(ggplot2) and then library(dplyr) and so on.\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\n\n\n\nA file named ‘YellowTangData_29_SEP_2016.csv’ is saved in the same folder (directory) as my .qmd file.\n\n1dat_yt &lt;- read_csv(\"YellowTangData_29_SEP_2016.csv\")\n\n\n1\n\nUse the read_csv() function to read the .csv data table file, and assign that to an R object named dat_yt\n\n\n\n\n\nThe read_csv() function is from the readr package in the tidyverse\nAfter running the code chunk above, the dat_yt object you created should show up in the RStudio Environment window (top right)\n\n\n\n\n\n1glimpse(dat_yt)\n\n\n1\n\nuse glimpse() function to examine the structure of the tibble named dat_yt\n\n\n\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;dbl&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…\n\n\nThe glimpse output shows you:\n\nthe number of Rows and Columns in the data frame\nthe name of each column (variable)\nthe data type of each variable: https://tibble.tidyverse.org/articles/types.html (typically you’ll see: chr - character, dbl - double (number), or fct - factor (categorical variable)\n\nAlways check to make sure data is what you expected it to be\nAlso, try double clicking on dat_yt in the environment window (upper right) to open the data viewer\n\n\n\n\nR read-in ‘location’ as dbl (i.e., numerical variable) by default since locations are numbered 1, 2, 3, 4\n\n\n1dat_yt &lt;- dat_yt |&gt;\n2  mutate(location = as_factor(location))\n\n# check if class for location now is factor\n3glimpse(dat_yt)\n\n\n1\n\nAssign the results back to the ‘dat_yt’ object to store the changes\n\n2\n\nUse as_factor() to convert the location variable to a factor, and mutate() overwrites the location variable in dat_yt with the new factor version\n\n3\n\nYou can see in the glimpse() output that the variable location is now class fct (factor).\n\n\n\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;fct&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…"
  },
  {
    "objectID": "Distributions.html#load-packages",
    "href": "Distributions.html#load-packages",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "You only need to “install” packages (download them to your computer) once.\nIf you have not already installed the tidyverse package to the computer you are using you can do so by: RStudio &gt; Tools &gt; Install Packages (type in package name)\nBut you have to “load” packages during each R session in order to use the functions within them\n\n\n1library(tidyverse)\n2library(skimr)\n\n\n1\n\nload the tidyverse package (which includes ggplot2 and dplyr)\n\n2\n\nload the skimr package (which includes the skim() function for descriptive statistics)\n\n\n\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse). You could alternatively load them separately library(ggplot2) and then library(dplyr) and so on.\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)"
  },
  {
    "objectID": "Distributions.html#read-in-the-data-file",
    "href": "Distributions.html#read-in-the-data-file",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "A file named ‘YellowTangData_29_SEP_2016.csv’ is saved in the same folder (directory) as my .qmd file.\n\n1dat_yt &lt;- read_csv(\"YellowTangData_29_SEP_2016.csv\")\n\n\n1\n\nUse the read_csv() function to read the .csv data table file, and assign that to an R object named dat_yt\n\n\n\n\n\nThe read_csv() function is from the readr package in the tidyverse\nAfter running the code chunk above, the dat_yt object you created should show up in the RStudio Environment window (top right)"
  },
  {
    "objectID": "Distributions.html#view-some-of-the-data",
    "href": "Distributions.html#view-some-of-the-data",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "use glimpse() function to examine the structure of the data.frame named dat_yt\n\n\nglimpse(dat_yt)\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;dbl&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…\n\n\nThe glimpse output shows you:\n\nthe number of Rows and Columns in the data frame\nthe name of each column (variable)\nthe data type of each variable: https://tibble.tidyverse.org/articles/types.html (typically you’ll see: chr - character, dbl - double (number), or fct - factor (categorical variable)\n\nAlways check to make sure data is what you expected it to be\nAlso, try double clicking on dat_yt in the environment window (upper right) to open the data viewer"
  },
  {
    "objectID": "Distributions.html#change-the-class-of-variable-location",
    "href": "Distributions.html#change-the-class-of-variable-location",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "R read-in as dbl (i.e., numerical variable) by default since locations are numbered 1, 2, 3, 4\nUse as_factor() function to convert it to a factor (i.e., a nominal categorical variable)\nNote: we also use the mutate() function here since we need to\n\n\ndat_yt &lt;- dat_yt |&gt; \n  mutate(location = as_factor(location))\n\n# check if class for location now is fct\nglimpse(dat_yt)\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;fct&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…\n\n\nYou can see in the glimpse() output that the variable location is now class fct (factor)."
  },
  {
    "objectID": "Distributions.html#ggplot2-reference-pages",
    "href": "Distributions.html#ggplot2-reference-pages",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "ggplot2 reference pages",
    "text": "ggplot2 reference pages\n\nFunctions in ggplot2 package (and the rest of the tidyverse) have their own additional web pages. Here’s the one for geom_histogram: &lt;https://ggplot2.tidyverse.org/reference/geom_histogram.html&gt;\nFind them quickly by Googling: ggplot histogram or geom histogram\nScroll down the the bottom of the geom_histogram web page to find example code and plots. This is often a fast way to find what you are looking to do."
  },
  {
    "objectID": "Distributions.html#create-a-faceted-histogram",
    "href": "Distributions.html#create-a-faceted-histogram",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Create a “faceted” histogram",
    "text": "Create a “faceted” histogram\n\nYellow Tang length_cm (numerical variable) by the variable (column) sex (categorical nominal variable)\nhttps://ggplot2.tidyverse.org/reference/facet_grid.html\n\nCan add a layer: + facet_grid(rows = vars(sex))\nThen try specifying the cols argument instead of rows: facet_grid(cols = vars(sex))\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n  facet_grid(rows = vars(sex)) # each sex in it's own row\n\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n  facet_grid(cols = vars(sex)) # each sex in it's own column\n\n\n\n\n\n\nWhich plot is best for comparing the 2 distributions?\nHistograms stacked on top of each other are better for comparing distributions because the x-axis line up\n\n\nCompare/describe the two distributions (central tendency, spread, shape):\n\nWhich has higher central tendency? male Yellow Tang\nWhich has higher variability? Variability (spread) is hard to judge by eye, they look pretty similar - both of have pretty “Normal” distribution (unimodal - single middle peak)\n\nHistograms can sometimes show you patterns in your data you were not aware of:\n\nIn this case the bimodal shape (2 distinct peaks) suggests there might be something (another variable) that is causing that distribution shape\nYellow Tang fish do not have a sexually distinctive external morphology (other than general body size), so if you just collected and measured a sample of fish you might not realize they were 2 sexes unless you dissected them.\n\n\n\nHistogram of length (numerical variable) faceted by two categorical variables\n&lt;https://ggplot2.tidyverse.org/reference/facet_grid.html&gt;\n\nCan add a layer: + facet_grid(rows = vars(sex), cols = vars(location))\nThen try specifying the cols argument instead of rows: facet_grid(cols = vars(sex))\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n  facet_grid(rows = vars(sex), cols = vars(location)) \n\n\n\n# each sex in it's own row\n# each location in it's own column"
  },
  {
    "objectID": "Distributions.html#histograms-with-skewed-distributions",
    "href": "Distributions.html#histograms-with-skewed-distributions",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Histograms with skewed distributions",
    "text": "Histograms with skewed distributions\n\nggplot(dat_yt, aes(x = home_range_m2)) +\n  geom_histogram() +\n  ggtitle(\"home range (all fish)\")\n\n\n\n\n\nggplot(dat_yt, aes(x = home_range_m2)) +\n  geom_histogram() +\n  facet_grid(rows = vars(sex))+\n  ggtitle(\"home range (by sex)\")\n\n\n\n\n\nCompare/describe the distributions (central tendency, spread, shape):\nThe combined distribution looks similar to when males and females are plotted separately - skewed (“right skewed” or “skewed with long positive tail”) - Most fish have home ranges around 1 to 10 m2, a handful with much larger home ranges, and similar max values\n\n\nDoes the sex variable have an effect on the distribution?\nIn this case sex does not appear to influence the distribution of home range (both distributions are similar). This is in contrast to length_cm, where the sex variable has a strong effect on the distribution."
  },
  {
    "objectID": "Distributions.html#add-vertical-lines-to-a-histogram-using-geom_vline",
    "href": "Distributions.html#add-vertical-lines-to-a-histogram-using-geom_vline",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Add vertical lines to a histogram using geom_vline()",
    "text": "Add vertical lines to a histogram using geom_vline()\nThe very large home range values “pull” the mean out towards the tail in the distribution, where as median is not as affected by outliers.\n\n#Histograms of home range (all fish)\ndat_yt |&gt; \nggplot(aes(x = home_range_m2)) +\n  geom_histogram() +\n#Add vertical lines (geom_vline) for mean (red) and median (blue)\n  geom_vline(aes(xintercept = mean(home_range_m2)),\n             color = \"red\", size = 2) +\n  geom_vline(aes(xintercept = median(home_range_m2)),\n             color = \"blue\", size = 2)"
  },
  {
    "objectID": "Distributions.html#scale_x_continuous-to-define-x-axis-tick-marks-in-histogram",
    "href": "Distributions.html#scale_x_continuous-to-define-x-axis-tick-marks-in-histogram",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "scale_x_continuous() to define x-axis tick marks in histogram",
    "text": "scale_x_continuous() to define x-axis tick marks in histogram\n\nHistograms of Yellow Tang parasites\nWe can define position of tick marks on x-axis by adding a layer with the scale_x_continuous() function, and defining the breaks = argument\nTRY to Google: ggplot scale_x_continuous, go to ggplot reference page to see examples of using it:\n\n# Histogram of parasite count w/ binwidth = 1 \nggplot(dat_yt, aes(x = parasites)) +\n  geom_histogram(binwidth = 1)\n\n\n\n# Make it again adding additional layer to define breaks (position of tick marks on x-axis)\nggplot(dat_yt, aes(x = parasites)) +\n  geom_histogram(binwidth = 1) + \n  scale_x_continuous(breaks = 0:8)\n\n\n\n# could also manually define the breaks (put in specific values)\nggplot(dat_yt, aes(x = parasites)) +\n  geom_histogram(binwidth = 1) + \n  scale_x_continuous(breaks = c(0, 2, 4, 6, 8))\n\n\n\n\n\nCompare/describe the distribution (central tendency, spread, shape):\nskewed (“left skewed” or “skewed with a tail of low values”) - Most fish have 6-8 parasites, and some with fewer, a couple with 0."
  },
  {
    "objectID": "Distributions.html#using-help-files",
    "href": "Distributions.html#using-help-files",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Using Help Files",
    "text": "Using Help Files\nLook at the help file for the function ‘mean’ for the answer\n\n1?mean\n\n\n1\n\nthe ‘?’ opens the help file for the function ‘mean’ in the Help tab (bottom right window). And in the help file you can look at the arguments and see that there is an argument na.rm that you can set to TRUE to ignore the NA’s.\n\n\n\n\nHere’s an annotated description of what is in a standard R help page (each function has one)\n\nAdd argument na.rm = T (remove NA’s) to ‘mean()’ & ‘median()’\n\ndat_yt |&gt; \n  group_by(sex) |&gt; \n1  summarise(mean_gonad_wt_g  = mean(gonad_wt_g, na.rm = T),\n2            median_gonad_wt_g = median(gonad_wt_g, na.rm = T))\n\n\n1\n\nAdd the argument na.rm = T to the mean() and\n\n2\n\nmedian() functions to ignore the NA’s caused here by empty cells (missing data for fish gonad weight) in the original .csv file\n\n\n\n\n# A tibble: 2 × 3\n  sex   mean_gonad_wt_g median_gonad_wt_g\n  &lt;chr&gt;           &lt;dbl&gt;             &lt;dbl&gt;\n1 F               15.0               14.9\n2 M                7.96               8.1\n\n\nand now it will calcualte the mean and median without the NAs"
  },
  {
    "objectID": "Distributions.html#na_if-to-replace-values-with-nas",
    "href": "Distributions.html#na_if-to-replace-values-with-nas",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "na_if() to replace values with NAs",
    "text": "na_if() to replace values with NAs\nThe code below will replace the improbable gut_wt_g values with NA in dat_yt (original values will be overwritten with NA – but not in original .csv file, just in dat_yt table in your R virtual workspace)\n\nWith your actual data you’d want to go back and check the data sheets to see if this was a data recording or entry error, and if so, correct that in the excel and/or .csv file\n\n\n1dat_yt &lt;- dat_yt |&gt;\n2  mutate(gut_wt_g = na_if(gut_wt_g, 1300),\n3         gut_wt_g = na_if(gut_wt_g, 25000))\n\n\n1\n\nAssign dat_yt to itself to save the result, pass dat_yt using the |&gt; pipe operator to\n\n2\n\nthe mutate() function which adds new columns or (in this case) writes over the existing gut_wt_g column, use the na_if() to replace 1300 (a extreme gut weight value) and\n\n3\n\nadd a similar mutate argument for the value of 25000\n\n\n\n\n\ndat_yt |&gt;\n1  filter(gut_wt_g &gt; 1000)\n\n\n1\n\nCan confirm values were replaced with NAs by using the filter function again to confirm the extreme values are no longer in the gut_wt_g column\n\n\n\n\n# A tibble: 0 × 8\n# ℹ 8 variables: sex &lt;chr&gt;, length_cm &lt;dbl&gt;, gonad_wt_g &lt;dbl&gt;,\n#   home_range_m2 &lt;dbl&gt;, gut_wt_g &lt;dbl&gt;, parasites &lt;dbl&gt;, location &lt;fct&gt;,\n#   fishing_level &lt;chr&gt;\n\n\nThis produces an empty table which means the 1300 and 25000 were replaced with NAs and are no longer in the gut_wt_g column of dat_yt\n\nYou could also double click on the dat_yt table in the Environment tab (top right window) to see the table, then click the down arrow sort the gut_wt_g column, and confirm extreme values are not longer there."
  },
  {
    "objectID": "Distributions.html#gonad-weight-all-fish-histogram-boxplot-individual-value-plot-and-descriptive-stats",
    "href": "Distributions.html#gonad-weight-all-fish-histogram-boxplot-individual-value-plot-and-descriptive-stats",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Gonad weight, all fish (histogram, boxplot, individual value plot, and descriptive stats)",
    "text": "Gonad weight, all fish (histogram, boxplot, individual value plot, and descriptive stats)\n\nWritten description of distribution is after the plots and descriptive statistics\n\n\n1ggplot(dat_yt, aes(x = gonad_wt_g)) +\n  geom_histogram() +\n  xlab(\"Gonad Weight (g)\")\n\n\n1\n\nFor histogram: must specify x = gonad_wt_g in aes()\n\n\n\n\n\n\n\n\n1ggplot(dat_yt, aes(y = gonad_wt_g)) +\n  geom_boxplot() +\n  ylab(\"Gonad Weight (g)\") \n\n\n1\n\nFor boxplot: must specify y = gonad_wt_g in aes()\n\n\n\n\n\n\n\n\n1ggplot(dat_yt, aes(x = 1, y = gonad_wt_g)) +\n2  geom_jitter() +\n  ylab(\"Gonad Weight (g)\") \n\n\n1\n\nFor ivp (geom_jitter): must specify x = 1,  y = gonad_wt_g in aes()\n\n2\n\ngeom_jitter() is like geom_point(), but randomly moves values a little bit (“jitters” them) so they don’t overlap for visibility\n\n\n\n\n\n\n\n\nNote the x-axis values have no meaning when you are doing an individual value plot (ivp) like this. It’s just a way to get the points to spread out horizontally.\n\n\n# Descriptive statistics using skim function from skimr package, for all yellow tang in the same, for each variable (column) in data_yt\ndat_yt |&gt; \nskim(gonad_wt_g)\n\n\nData summary\n\n\nName\ndat_yt\n\n\nNumber of rows\n100\n\n\nNumber of columns\n8\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nnumeric\n1\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\ngonad_wt_g\n2\n0.98\n11.48\n4.75\n2\n7.8\n10.25\n14.9\n24.3\n▂▇▃▃▁\n\n\n\n\n\n\nDescribe the distribution:\n\nRelatively symmetrical, some positive skew (right skew)\n1 strong peak ~8 g"
  },
  {
    "objectID": "Distributions.html#gonad-weight-by-sex-histogram-boxplot-individual-value-plot-and-descriptive-stats",
    "href": "Distributions.html#gonad-weight-by-sex-histogram-boxplot-individual-value-plot-and-descriptive-stats",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Gonad weight by sex (histogram, boxplot, individual value plot, and descriptive stats)",
    "text": "Gonad weight by sex (histogram, boxplot, individual value plot, and descriptive stats)\n\nWritten description of distribution is after the plots and descriptive statistics\n\n\n1ggplot(dat_yt, aes(x = gonad_wt_g)) +\n  geom_histogram() +\n2  facet_grid (rows = vars(sex)) +\n  xlab(\"Gonad Weight (g)\")\n\n\n1\n\nFor histogram: must specify x = gonad_wt_g in aes()\n\n2\n\nuse facet_grid to create separate histograms for each sex\n\n\n\n\n\n\n\n\n1ggplot(dat_yt, aes(x = sex, y = gonad_wt_g)) +\n  geom_boxplot() +\n  ylab(\"Gonad Weight (g)\") +\n  xlab(\"Sex\")\n\n\n1\n\nFor boxplot: must specify x = sex, y = gonad_wt_g in aes()\n\n\n\n\n\n\n\n\n1ggplot(dat_yt, aes(x = sex,  y = gonad_wt_g)) +\n2  geom_jitter() +\n  ylab(\"Gonad Weight (g)\") +\n  xlab(\"Sex\") \n\n\n1\n\nFor ivp (geom_jitter): must specify x = sex,  y = gonad_wt_g in aes()\n\n2\n\ngeom_jitter() is like geom_point(), but randomly moves values a little bit (“jitters” them) so they don’t overlap for visibility\n\n\n\n\n\n\n\n\n# Descriptive statistics using skim function from skimr package, for all yellow tang in the same, for each variable (column) in data_yt\ndat_yt |&gt;\n1  group_by(sex) |&gt;\n2  skim(gonad_wt_g)\n\n\n1\n\ngroup_by() is a dplyr function that tells R to calculate the descriptive statistics separately for each group (in this case by sex)\n\n2\n\nskim() is a function from the skimr package that calculates descriptive statistics for each group\n\n\n\n\n\nData summary\n\n\nName\ngroup_by(dat_yt, sex)\n\n\nNumber of rows\n100\n\n\nNumber of columns\n8\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nnumeric\n1\n\n\n________________________\n\n\n\nGroup variables\nsex\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nsex\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\ngonad_wt_g\nF\n1\n0.98\n15.00\n4.00\n6.2\n12.1\n14.9\n17.4\n24.3\n▂▆▇▆▂\n\n\ngonad_wt_g\nM\n1\n0.98\n7.96\n2.06\n2.0\n6.6\n8.1\n9.2\n13.2\n▁▃▇▅▁\n\n\n\n\n\n\nDescribe/compare the distributions:\n\nDistributions are both relatively symmetrical, single peaks\nThe difference based on sex is clear\nFemales have larger gonad weights (higher mean) and there is more variability (more spread) in female gonad weight than male gonad weight\n\n\n\n\nGonad weight by location\nSame as by sex above just switch out sex for location in all the code"
  },
  {
    "objectID": "Distributions.html#gonad-weight-by-sex-location-histogram-boxplot-individual-value-plot-and-descriptive-stats",
    "href": "Distributions.html#gonad-weight-by-sex-location-histogram-boxplot-individual-value-plot-and-descriptive-stats",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Gonad weight by sex & location (histogram, boxplot, individual value plot, and descriptive stats)",
    "text": "Gonad weight by sex & location (histogram, boxplot, individual value plot, and descriptive stats)\n\nHistogram:\n\nspecify both rows and cols arguments in facet_grid()\n\n\n#Histogram gonad weight by sex\nggplot(dat_yt, aes(x = gonad_wt_g)) +\n  geom_histogram() +\n  facet_grid(rows = vars(sex), cols = vars(location)) +\n  xlab(\"Gonad Weight (g)\")\n\n\n\n#reverse rows and cols variables as it provides different perspective on comparisons. \nggplot(dat_yt, aes(x = gonad_wt_g)) +\n  geom_histogram() +\n  facet_grid(rows = vars(location), cols = vars(sex)) +\n  xlab(\"Gonad Weight (g)\")\n\n\n\n\n\n\nBoxplot:\n\nspecify x = location\nand then include the additional aesthetic argument color = sex\n\n\nggplot(dat_yt, aes(x= location, y = gonad_wt_g, color = sex)) +\n  geom_boxplot() +\n  ylab(\"Gonad Weight (g)\") +\n  xlab(\"Location\")\n\n\n\n\n\n\nIndividual value plot\n\nggplot(dat_yt, aes(x= location, y = gonad_wt_g, color = sex)) +\n  geom_jitter(width = 0.1) +\n  ylab(\"Gonad Weight (g)\") +\n  xlab(\"Location\")\n\n\n\n\n\n\nskim() descriptive statistics output by sex and location\n\ndat_yt |&gt; \n  group_by(sex, location) |&gt; \n  skim(gonad_wt_g)\n\n\nData summary\n\n\nName\ngroup_by(dat_yt, sex, loc…\n\n\nNumber of rows\n100\n\n\nNumber of columns\n8\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nnumeric\n1\n\n\n________________________\n\n\n\nGroup variables\nsex, location\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nsex\nlocation\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\n\ngonad_wt_g\nF\n1\n0\n1.00\n16.65\n3.16\n12.5\n14.07\n16.00\n18.83\n22.0\n▇▃▃▃▃\n\n\ngonad_wt_g\nF\n2\n0\n1.00\n12.29\n3.18\n6.2\n10.73\n12.10\n14.75\n17.6\n▂▃▇▃▃\n\n\ngonad_wt_g\nF\n3\n0\n1.00\n15.28\n4.59\n8.2\n11.50\n15.30\n18.10\n24.3\n▅▂▇▅▂\n\n\ngonad_wt_g\nF\n4\n1\n0.92\n15.78\n3.88\n9.9\n12.85\n15.85\n17.88\n21.8\n▇▅▅▇▅\n\n\ngonad_wt_g\nM\n1\n0\n1.00\n7.96\n1.58\n5.9\n6.80\n7.60\n9.00\n11.2\n▇▃▅▃▂\n\n\ngonad_wt_g\nM\n2\n1\n0.92\n7.15\n2.86\n2.0\n5.20\n7.50\n8.52\n11.8\n▂▇▃▆▃\n\n\ngonad_wt_g\nM\n3\n0\n1.00\n7.92\n1.29\n4.7\n7.68\n8.20\n8.53\n9.7\n▁▁▁▇▂\n\n\ngonad_wt_g\nM\n4\n0\n1.00\n8.81\n2.12\n6.0\n7.28\n8.95\n9.93\n13.2\n▆▆▇▂▂\n\n\n\n\n\n\n\nDescribe/compare the distributions:\n\nDistributions are all relatively symmetrical, although the sample sizes are pretty small in each group (sex + location combination) and it is hard to judge distribution shape with small sample sizes.\nThe difference based on sex are clear\nFemales have larger gonad weights and there is more spread (variability) in female gonad weight than male gonad weight\nLocations are pretty similar, site 2 looks a little smaller for females (no very high values)"
  },
  {
    "objectID": "test_html_page.html",
    "href": "test_html_page.html",
    "title": "Untitled",
    "section": "",
    "text": "Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org."
  },
  {
    "objectID": "test_html_page.html#quarto",
    "href": "test_html_page.html#quarto",
    "title": "Untitled",
    "section": "",
    "text": "Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see https://quarto.org."
  },
  {
    "objectID": "test_html_page.html#running-code",
    "href": "test_html_page.html#running-code",
    "title": "Untitled",
    "section": "Running Code",
    "text": "Running Code\nWhen you click the Render button a document will be generated that includes both content and the output of embedded code. You can embed code like this:\n\n1 + 1\n\n[1] 2\n\n\nYou can add options to executable code like this\n\nmean(c(2,4))\n\n[1] 3\n\n2 * 2\n\n[1] 4\n\n\nThe echo: false option disables the printing of code (only output is displayed)."
  },
  {
    "objectID": "Distributions.html#view-the-data-table",
    "href": "Distributions.html#view-the-data-table",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "1glimpse(dat_yt)\n\n\n1\n\nuse glimpse() function to examine the structure of the tibble named dat_yt\n\n\n\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;dbl&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…\n\n\nThe glimpse output shows you:\n\nthe number of Rows and Columns in the data frame\nthe name of each column (variable)\nthe data type of each variable: https://tibble.tidyverse.org/articles/types.html (typically you’ll see: chr - character, dbl - double (number), or fct - factor (categorical variable)\n\nAlways check to make sure data is what you expected it to be\nAlso, try double clicking on dat_yt in the environment window (upper right) to open the data viewer"
  },
  {
    "objectID": "Distributions.html#change-the-class-of-location-to-factor",
    "href": "Distributions.html#change-the-class-of-location-to-factor",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "",
    "text": "R read-in ‘location’ as dbl (i.e., numerical variable) by default since locations are numbered 1, 2, 3, 4\n\n\n1dat_yt &lt;- dat_yt |&gt;\n2  mutate(location = as_factor(location))\n\n# check if class for location now is factor\n3glimpse(dat_yt)\n\n\n1\n\nAssign the results back to the ‘dat_yt’ object to store the changes\n\n2\n\nUse as_factor() to convert the location variable to a factor, and mutate() overwrites the location variable in dat_yt with the new factor version\n\n3\n\nYou can see in the glimpse() output that the variable location is now class fct (factor).\n\n\n\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;fct&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…"
  },
  {
    "objectID": "Distributions.html#calculate-mean-median-length",
    "href": "Distributions.html#calculate-mean-median-length",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Calculate mean & median length",
    "text": "Calculate mean & median length\n\nfor all yellow tang in data set\n\n‘summarize()’ is from dplyr package (part of tidyverse)\n\n1dat_yt |&gt;\n2  summarize(mean_length_cm =  mean(length_cm),\n3            median_length_cm =  median(length_cm))\n\n# Note: ctrl+shift+m or cmd+shift+m (Mac) will insert the pipe operator: |&gt;\n\n\n1\n\nPass dat_yt using the |&gt; pipe operator to the summarize() function\n\n2\n\nusing the mean() and median() functions of the length_cm variable\n\n3\n\nand name those columns mean_length_cm and median_length_cm where those descriptive statistic values will be stored\n\n\n\n\n# A tibble: 1 × 2\n  mean_length_cm median_length_cm\n           &lt;dbl&gt;            &lt;dbl&gt;\n1           18.0             18.2"
  },
  {
    "objectID": "Distributions.html#use-group_by-with-summarize-to-calculate-stats-by-another-variable",
    "href": "Distributions.html#use-group_by-with-summarize-to-calculate-stats-by-another-variable",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Use group_by() with summarize() to calculate stats by another variable",
    "text": "Use group_by() with summarize() to calculate stats by another variable\nmin, mean, median, and max number of parasites for each category in the sex variable\n\n1dat_yt |&gt;\n2  group_by(sex) |&gt;\n3  summarize(min_parasites =  min(parasites),\n4            mean_parasites =  mean(parasites),\n            median_parasites =  median(parasites),\n            max_parasites =  max(parasites))\n\n\n1\n\nPass the dat_yt data.frame using the |&gt; pipe operator\n\n2\n\nto the group_by() function and group (subset) the data by sex, then pass that\n\n3\n\nto the summarize() function to make calculations on each group of data\n\n4\n\nusing the min(), mean(), median(), and max() functions of the parasites variable and name those columns where those descriptive statistic values will be stored accordingly\n\n\n\n\n# A tibble: 2 × 5\n  sex   min_parasites mean_parasites median_parasites max_parasites\n  &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;\n1 F                 1           6.38                7             8\n2 M                 0           5.9                 7             8"
  },
  {
    "objectID": "Distributions.html#calculate-mean-median-length-of-all-fish",
    "href": "Distributions.html#calculate-mean-median-length-of-all-fish",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Calculate mean & median length of all fish",
    "text": "Calculate mean & median length of all fish\n‘summarize()’ is from dplyr package (part of tidyverse)\n\n1dat_yt |&gt;\n2  summarize(mean_length_cm =  mean(length_cm),\n3            median_length_cm =  median(length_cm))\n\n# Note: ctrl+shift+m or cmd+shift+m (Mac) will insert the pipe operator: |&gt;\n\n\n1\n\nPass dat_yt using the |&gt; pipe operator to the summarize() function\n\n2\n\nusing the mean() and median() functions of the length_cm variable\n\n3\n\nand name those columns mean_length_cm and median_length_cm where those descriptive statistic values will be stored\n\n\n\n\n# A tibble: 1 × 2\n  mean_length_cm median_length_cm\n           &lt;dbl&gt;            &lt;dbl&gt;\n1           18.0             18.2"
  },
  {
    "objectID": "Distributions.html#add-group_by-to-calculate-by-sex",
    "href": "Distributions.html#add-group_by-to-calculate-by-sex",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Add group_by() to calculate by sex",
    "text": "Add group_by() to calculate by sex\n\nCalculate min, mean, median, and max number of parasites for each category in the sex variable\n\n\n1dat_yt |&gt;\n2  group_by(sex) |&gt;\n3  summarize(min_parasites =  min(parasites),\n4            mean_parasites =  mean(parasites),\n            median_parasites =  median(parasites),\n            max_parasites =  max(parasites))\n\n\n1\n\nPass the dat_yt data.frame using the |&gt; pipe operator\n\n2\n\nto the group_by() function and group (subset) the data by sex, then pass that\n\n3\n\nto the summarize() function to make calculations on each group of data\n\n4\n\nusing the min(), mean(), median(), and max() functions of the parasites variable and name those columns where those descriptive statistic values will be stored accordingly\n\n\n\n\n# A tibble: 2 × 5\n  sex   min_parasites mean_parasites median_parasites max_parasites\n  &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;\n1 F                 1           6.38                7             8\n2 M                 0           5.9                 7             8"
  },
  {
    "objectID": "Distributions.html#histogram-of-length-for-all-fish",
    "href": "Distributions.html#histogram-of-length-for-all-fish",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Histogram of length for all fish",
    "text": "Histogram of length for all fish\n\n1dat_yt |&gt;\n2ggplot(aes(x = length_cm)) +\n3  geom_histogram()\n\n\n1\n\nPass the dat_yt with the pipe operator to the ggplot() function\n\n2\n\ndefine the “aesthetics” with aes() argument, and set the x variable we want to plot as length_cm\n\n3\n\nthen add + the geom_histogram() layer to plot the histogram\n\n\n\n\n\n\n\n\nSpecify number of bins\n\nAlyways try a few binwidths (or number of bins) each time you make a histogram before settling on one.\nIn the below examples ~25 bins looks pretty good.\n\n\nggplot(dat_yt, aes(x = length_cm)) + \n1  geom_histogram(bins = 5) +\n2  ggtitle(\"5 bins\")\n\n\n1\n\nadd the argument bins = 5 to the layer geom_histogram()\n\n2\n\nadd a title with function + ggtitle()\n\n\n\n\n\n\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n1  geom_histogram(bins = 25) +\n2  ggtitle(\"25 bins\")\n\n\n1\n\nIncrease the number of bins to 25\n\n2\n\nadd a title with function + ggtitle()\n\n\n\n\n\n\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n1  geom_histogram(bins = 100) +\n2  ggtitle(\"100 bins\")\n\n\n1\n\nIncrease the number of bins to 100\n\n2\n\nadd a title with function + ggtitle()\n\n\n\n\n\n\n\n\n\nSpecify the binwidth\n\nbinwidth will be in the same units as the variable you are plotting (cm in this case)\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n1  geom_histogram(binwidth = 1) +\n  ggtitle(\"1 cm binwidth\")\n\n\n1\n\nTypically want to pick binwidths that people are familiar with like 1 cm (i.e., best not to choose binwidths of some random number, for example 0.38 cm)\n\n\n\n\n\n\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 2) +\n  ggtitle(\"2 cm binwidth\")"
  },
  {
    "objectID": "Distributions.html#a-faceted-histogram",
    "href": "Distributions.html#a-faceted-histogram",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "A faceted histogram",
    "text": "A faceted histogram\nYellow Tang length_cm (numerical variable) faceted by the variable sex (categorical nominal variable)\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n1  facet_grid(rows = vars(sex))\n\n\n1\n\neach sex in a row with the ‘rows’ argument in `facet_grid()’ function\n\n\n\n\n\n\n\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n1  facet_grid(cols = vars(sex))\n\n\n1\n\neach sex in a column with the ‘cols’ argument in `facet_grid()’ function\n\n\n\n\n\n\n\n\nWhich histogram above is best for comparing the 2 distributions?\nHistograms stacked on top of each other are better for comparing distributions because the x-axes line up to directly compare values across the 2 plots\n\n\nCompare/describe the two distributions (central tendency, spread, shape):\n\nWhich has higher central tendency? male Yellow Tang\nWhich has higher variability? Variability (spread) is hard to judge by eye, they look pretty similar - both of have pretty “Normal” distribution (unimodal - single middle peak)\n\nHistograms can sometimes show you patterns in your data you were not aware of:\n\nIn this case the bimodal shape (2 distinct peaks) suggests there might be something (another variable) that is causing that distribution shape\nYellow Tang fish do not have a sexually distinctive external morphology (other than general body size), so if you just collected and measured a sample of fish you might not realize they were 2 sexes unless you dissected them."
  },
  {
    "objectID": "Distributions.html#histogram-faceted-by-two-categorical-variables",
    "href": "Distributions.html#histogram-faceted-by-two-categorical-variables",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Histogram faceted by two categorical variables",
    "text": "Histogram faceted by two categorical variables\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n1  facet_grid(rows = vars(sex), cols = vars(location))\n\n\n1\n\neach sex in a row and each location in a column"
  },
  {
    "objectID": "Distributions.html#mean-and-medium-show-skew",
    "href": "Distributions.html#mean-and-medium-show-skew",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Mean and medium show skew",
    "text": "Mean and medium show skew\n\ndat_yt |&gt; \n  #filter(home_range_m2 &lt; 40) |&gt; \n  group_by(sex) |&gt; \n  summarise(mean_home_range_m2 = mean(home_range_m2),\n            median_home_range_m2 = median(home_range_m2))\n\n# A tibble: 2 × 3\n  sex   mean_home_range_m2 median_home_range_m2\n  &lt;chr&gt;              &lt;dbl&gt;                &lt;dbl&gt;\n1 F                   10.8                  6.9\n2 M                   12.6                  5.9\n\n\nThe very large home range values (positive skew) pull the mean out towards to the right, while the median is not as affected by these very high values More normal/symmetrical distributions have mean and median values that are close to each other"
  },
  {
    "objectID": "Distributions.html#facet-by-two-categorical-variables",
    "href": "Distributions.html#facet-by-two-categorical-variables",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Facet by two categorical variables",
    "text": "Facet by two categorical variables\n\nggplot(dat_yt, aes(x = length_cm)) +\n  geom_histogram(binwidth = 1) +\n1  facet_grid(rows = vars(sex), cols = vars(location))\n\n\n1\n\neach sex in a row and each location in a column"
  },
  {
    "objectID": "Distributions.html#compare-mean-to-medium-to-assess-skew",
    "href": "Distributions.html#compare-mean-to-medium-to-assess-skew",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Compare mean to medium to assess skew",
    "text": "Compare mean to medium to assess skew\n\ndat_yt |&gt; \n  #filter(home_range_m2 &lt; 40) |&gt; \n  group_by(sex) |&gt; \n  summarise(mean_home_range_m2 = mean(home_range_m2),\n            median_home_range_m2 = median(home_range_m2))\n\n# A tibble: 2 × 3\n  sex   mean_home_range_m2 median_home_range_m2\n  &lt;chr&gt;              &lt;dbl&gt;                &lt;dbl&gt;\n1 F                   10.8                  6.9\n2 M                   12.6                  5.9\n\n\nThe very large home range values (positive skew) pull the mean out to the right, while the median is not as affected by these very high values. More normal or symmetrical distributions have very similar mean and median values."
  },
  {
    "objectID": "Distributions.html#add-vertical-lines-with-geom_vline",
    "href": "Distributions.html#add-vertical-lines-with-geom_vline",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Add vertical lines with geom_vline()",
    "text": "Add vertical lines with geom_vline()\n\ndat_yt |&gt; \nggplot(aes(x = home_range_m2)) +\n  geom_histogram() +\n1  geom_vline(aes(xintercept = mean(home_range_m2)),\n2             color = \"red\", linewidth = 2) +\n  geom_vline(aes(xintercept = median(home_range_m2)),\n3             color = \"blue\", linewidth = 2)\n\n\n1\n\ngeom_vline() function to add vertical lines to the plot\n\n2\n\ncolor = \"red\" and linewidth = 2 arguments to change the color and thickness of the line\n\n3\n\ncolor = \"blue\" to make the median line blue\n\n\n\n\n\n\n\nThe very large home range values “pull” the mean (red line) out towards the tail in the distribution, where as median (blue line) is not as affected by outliers."
  },
  {
    "objectID": "Distributions.html#specify-x-axis-tick-marks-with-scale_x_continuous",
    "href": "Distributions.html#specify-x-axis-tick-marks-with-scale_x_continuous",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Specify x-axis tick marks with scale_x_continuous()",
    "text": "Specify x-axis tick marks with scale_x_continuous()\nTRY to Google: ggplot scale_x_continuous, go to ggplot reference page to see examples of using it:\n\n# Histogram of parasite count w/ binwidth = 1 \nggplot(dat_yt, aes(x = parasites)) +\n  geom_histogram(binwidth = 1) +\n  ggtitle(\"Parasite count (bad x-axis tick marks)\")\n\n\n\n\nWe can define position of tick marks on x-axis by adding a layer with the scale_x_continuous() function, and defining the breaks = argument\n\nggplot(dat_yt, aes(x = parasites)) +\n  geom_histogram(binwidth = 1) + \n1  scale_x_continuous(breaks = 0:8) +\n  ggtitle(\"Parasite count (tick at marks at 0, 1, 2, 3, 4, 5, 6, 7, 8)\")\n\n\n1\n\nAdd a ‘scale_x_continuous()’ layer with ‘breaks’ argument to define the position of the tick marks. ‘0:8’ creates a sequence of numbers from 0 to 8.\n\n\n\n\n\n\n\n\n# could also manually define the breaks (put in specific values)\nggplot(dat_yt, aes(x = parasites)) +\n  geom_histogram(binwidth = 1) + \n1  scale_x_continuous(breaks = c(0, 2, 4, 6, 8)) +\n  ggtitle(\"Parasite count (tick at marks at 0, 2, 4, 6, 8)\")\n\n\n1\n\nAdd a ‘scale_x_continuous()’ layer with ‘breaks’ argument to define the position of the tick marks. ‘c(0, 2, 4, 6, 8)’ manually sets tick marks at those values.\n\n\n\n\n\n\n\n\nCompare/describe the distribution (central tendency, spread, shape):\nskewed (“left skewed” or “skewed with a tail of low values”) - Most fish have 6-8 parasites, and some with fewer, a couple with 0."
  },
  {
    "objectID": "Distributions.html#use-filter-to-select-or-exclude-rows-that-contain-extreme-values",
    "href": "Distributions.html#use-filter-to-select-or-exclude-rows-that-contain-extreme-values",
    "title": "BIO 5100 - Visualize Distributions & Descriptive Statistics",
    "section": "Use filter() to select or exclude rows that contain extreme values",
    "text": "Use filter() to select or exclude rows that contain extreme values\n\nggplot(dat_yt, aes(x = gut_wt_g)) +\n  geom_histogram() +\n  ggtitle(\"Histogram of gut weight (g) for all Yellow Tang\")\n\n\n\n\nlooks like the two really extreme values are over 1000g\n\ndat_yt |&gt;\n1  filter(gut_wt_g &gt; 1000)\n\n\n1\n\nUse the filter() function to select the rows where gut_wt_g is greater than 1000g\n\n\n\n\n# A tibble: 2 × 8\n  sex   length_cm gonad_wt_g home_range_m2 gut_wt_g parasites location\n  &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;   \n1 M          20.6        7.7           8.5     1300         0 2       \n2 F          15.6       17.2           3.5    25000         7 1       \n# ℹ 1 more variable: fishing_level &lt;chr&gt;\n\n\nThere were 2 rows (two fish) with really (unrealistically) large gut weights (i.e., ~ 3 lbs and ~55 lbs for fish that are 6-8 inches long). These were probably the result of a data recording or data entry error.\n\ndat_yt |&gt;\n1  filter(gut_wt_g &lt; 1000) |&gt;\n  ggplot(aes(x = gut_wt_g)) +\n  geom_histogram(bins = 15)\n\n\n1\n\nUse the filter() function to select the rows where gut_wt_g is less than 1000g (i.e., filter out the two extreme values)\n\n\n\n\n\n\n\n\nDescribe the distribution:\nthe distribution of gut weights (with the unrealistic values removed) is somewhere between normal and a uniform distribution"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html",
    "href": "Scatterplots_cor_lm_regression.html",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "",
    "text": "Install tidymodels package (contains broom package) if you have not before.\n\n# load tidyverse\nlibrary(tidyverse)\n\n# install.packages(\"tidymodels\") #contains broom package\n#if you have not before, uncomment line above and install tidymodels package (only need to do this once)\n\n# load broom package (for linear model related functions)\nlibrary(broom)\n\n# load skimr package - to use skim() function for descriptive statistics\nlibrary(skimr)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nNOTE: The broom Package is installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\n\nThe broom package includes functions glance() (to look at statistics, like R2, from a linear model object) and augment() (to extract things like model residual values from a linear model object)"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#load-packages",
    "href": "Scatterplots_cor_lm_regression.html#load-packages",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "",
    "text": "Install tidymodels package (contains broom package) if you have not before.\n\n# load tidyverse\nlibrary(tidyverse)\n\n# install.packages(\"tidymodels\") #contains broom package\n#if you have not before, uncomment line above and install tidymodels package (only need to do this once)\n\n# load broom package (for linear model related functions)\nlibrary(broom)\n\n# load skimr package - to use skim() function for descriptive statistics\nlibrary(skimr)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nNOTE: The broom Package is installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\n\nThe broom package includes functions glance() (to look at statistics, like R2, from a linear model object) and augment() (to extract things like model residual values from a linear model object)"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#read-in-the-data-file",
    "href": "Scatterplots_cor_lm_regression.html#read-in-the-data-file",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Read-in the data file",
    "text": "Read-in the data file\n\nUse the read_csv() function to read the .csv data table file into RStudio\nAssign to an R object named dat_yt\n\n\n\ndat_yt &lt;- read_csv(\"YellowTangData_29_SEP_2016.csv\")\n\nView (some of) the data\n\nuse glimpse() function to examine the structure of the data.frame named dat_yt\n\n\n\nglimpse(dat_yt)\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;dbl&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…\n\n\nThe data type of each variable: https://tibble.tidyverse.org/articles/types.html (typically you’ll see: chr - character, dbl - double (number), or fct - factor (categorical variable)"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#change-the-class-of-variable-location",
    "href": "Scatterplots_cor_lm_regression.html#change-the-class-of-variable-location",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Change the class of variable location",
    "text": "Change the class of variable location\n\nR reads-in the location variable as dbl (i.e., numerical variable) by default since locations are numbered 1, 2, 3, 4\nChange location to a factor (i.e., a nominal categorical variable) so that it plots correctly\n\n\ndat_yt &lt;- dat_yt |&gt; \n  mutate(location = as_factor(location))\n\n# see the structure of the dat_yt table\nglimpse(dat_yt)\n\nRows: 100\nColumns: 8\n$ sex           &lt;chr&gt; \"M\", \"F\", \"F\", \"F\", \"F\", \"M\", \"F\", \"F\", \"M\", \"M\", \"M\", \"…\n$ length_cm     &lt;dbl&gt; 20.3, 16.0, 17.2, 17.1, 15.9, 20.5, 17.7, 15.1, 21.1, 19…\n$ gonad_wt_g    &lt;dbl&gt; 6.6, 22.0, 6.2, 17.4, 17.6, NA, 9.1, 15.4, 8.8, 7.6, 9.0…\n$ home_range_m2 &lt;dbl&gt; 3.6, 24.5, 3.4, 19.8, 15.7, 5.1, 7.8, 2.1, 3.5, 1.7, 2.2…\n$ gut_wt_g      &lt;dbl&gt; 2.6, 0.6, 2.1, 0.7, 0.4, 0.7, 1.6, 2.7, 0.4, 2.2, 0.8, 0…\n$ parasites     &lt;dbl&gt; 8, 8, 7, 8, 8, 8, 8, 6, 8, 7, 6, 7, 6, 7, 6, 7, 7, 8, 7,…\n$ location      &lt;fct&gt; 3, 1, 2, 4, 2, 2, 3, 1, 4, 1, 1, 2, 3, 4, 1, 3, 4, 2, 3,…\n$ fishing_level &lt;chr&gt; \"low\", \"high\", \"medium\", \"prohibited\", \"medium\", \"medium…\n\n\nYou can see in the glimpse() output that the variable location is now class fct (factor)."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#probability-density-function-curve",
    "href": "Scatterplots_cor_lm_regression.html#probability-density-function-curve",
    "title": "BIO 5100 - Normal Distributions, Scatterplots, Correlation & Regression Intro",
    "section": "Probability Density Function (curve)",
    "text": "Probability Density Function (curve)\nHow many “Normal” distributions are there?\n\nThere are an infinite number of Normal distributions\nChange the mean to slide the distribution left or right\nChange the sd to change spread in the distribution\n\n\n# Plot of Normal distribution Probability Density Function (curve)\n# Just for demo purposes (you'll probably never need/want to create a plot light this unless you are teaching statistics)\n\nggplot(data.frame(values = c(-100, 100)), aes(x = values)) +\n  ylab(\"probablity density\") +\n  stat_function(fun = dnorm, args = list(-40, 20), color = \"black\", size = 2) +\n  stat_function(fun = dnorm, args = list(0, 20), color = \"purple\", size = 2) +\n  stat_function(fun = dnorm, args = list(40, 20), color = \"gold\", size = 2) +\n  ggtitle(\"changing mean\")\n\n\n\n#the args argument above specifies the mean, sd\n\nggplot(data.frame(values = c(-100, 100)), aes(x = values)) +\n  ylab(\"probablity density\") +\n  stat_function(fun = dnorm, args = list(0, 10), color = \"black\", size = 2) +\n  stat_function(fun = dnorm, args = list(0, 20), color = \"purple\", size = 2) +\n  stat_function(fun = dnorm, args = list(0, 30), color = \"gold\", size = 2) +\n  ggtitle(\"changing sd\")\n\n\n\n#the args argument above specifies the mean, sd\n\n#Go Lakers!\n\n# dnorm function: given an x value it returns the density of that value \n# for a normal distribution with a specified mean and sd\n#?dnorm"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#standard-normal-distribution",
    "href": "Scatterplots_cor_lm_regression.html#standard-normal-distribution",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Standard Normal Distribution",
    "text": "Standard Normal Distribution\nThe “Standard Normal Distribution” is a special case of a Normal distribution when mean = 0 and sd = 1\n\nggplot(data.frame(values = c(-5, 5)), aes(x = values)) +\n  stat_function(fun = dnorm, args = list(0, 1)) +\n  ylab(\"probablity density\") +\n  scale_x_continuous(breaks = -5:5) +\n  geom_hline(yintercept = 0) +\n# make y-axis plot start at 0  \n  scale_y_continuous(expand = c(0, 0)) + \n  ggtitle(\"Standard Normal Distribution\") +\n  theme_classic() +\n  geom_vline(xintercept = c(-1,1), color = \"gold\", \n             linetype = \"dashed\") +\n  geom_vline(xintercept = c(-2,2), color = \"purple\", \n             linetype = \"dashed\") +\n  geom_vline(xintercept = c(-3,3), color = \"gray\", \n             linetype = \"dashed\") +\n# illistrate the 68 - 95 - 99.7% rule\n  annotate(geom=\"text\", x=0, y=0.1, label=\"68%\", color=\"gold\", \n           size = 7) +\n  annotate(geom=\"text\", x=0, y=0.2, label=\"95%\", color=\"purple\", \n           size = 7) +\n  annotate(geom=\"text\", x=0, y=0.3, label=\"99.7%\", color=\"gray\", \n           size = 7) +\n  geom_segment(x = -0.9, y =0.08, xend = 0.9, yend = 0.08, \n               colour = \"gold\") +\n  geom_segment(x = -1.9, y =0.18, xend = 1.9, yend = 0.18, \n               colour = \"purple\") +\n  geom_segment(x = -2.9, y =0.28, xend = 2.9, yend = 0.28, \n               colour = \"gray\")"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#normal-vs.-t-distributions",
    "href": "Scatterplots_cor_lm_regression.html#normal-vs.-t-distributions",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Normal vs. t distributions",
    "text": "Normal vs. t distributions\nThe t distribution is another symmetric bell-shaped density curve that is slightly different from the Normal distribution\n\nggplot(data.frame(values = c(-4, 4)), aes(x = values)) +\n  ylab(\"probablity density\") +\n  stat_function(fun = dnorm, args = list(0, 1), \n                color = \"gold\", size = 1) +\n  stat_function(fun = dt, args = list(df = 8), \n                color = \"purple\", size = 1) +\n  ggtitle(\"Normal (gold) vs. t distribution (purple)\")\n\n\n\n\nThe smaller the sample size (8 in this example) the “fatter the tails” become on the t-distribution meaning there is a higher probability you could get a more extreme value, and thus the t-distribution provides a more conservative approach when sample sizes are small."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#customizing-scatter-plots",
    "href": "Scatterplots_cor_lm_regression.html#customizing-scatter-plots",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Customizing Scatter plots",
    "text": "Customizing Scatter plots\nSee the tidyverse reference page for geom_point() to see how to customize scatter plots:\n&lt;https://ggplot2.tidyverse.org/reference/geom_point.html&gt;\nThere’s also additional options (like how to specify a certain point shape) here:\nhttps://ggplot2.tidyverse.org/articles/ggplot2-specs.html\nChange characteristics (size, color, shape) of ALL POINTS:\n\nArguments in geom_point() will apply to (change) all the points:\n\n\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point(color = \"dark green\", size =  3, shape = 1) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n\nMap a variable to color\n\nArguments are put in aes() when you want to map a categorical variable (sex) to some feature of the plot (color)\n\n\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g, color = sex)) +\n  geom_point() +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#geom_smoothlowess-moving-average-curves",
    "href": "Scatterplots_cor_lm_regression.html#geom_smoothlowess-moving-average-curves",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "geom_smooth()LOWESS moving average curves",
    "text": "geom_smooth()LOWESS moving average curves\nhttps://ggplot2.tidyverse.org/reference/geom_smooth.html\n\ngeom_smooth() by default adds a moving average smoother line, also referred to as a LOWESS smoother curve (Locally Weighted Scatterplot Smoothing)\nwe add the argument se = FALSE so that error bars do not plot on the line, which is not necessary here.\n\n\n# a smoother line (moving average) for all data\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n\n\nthe span argument changes the range of x values over which the the moving average is done.\nTypically use trial and error, try values between 0.3 and 1.0 for span.\n\n\n# span = 0.3\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(span = 0.3, se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n# span = 1\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(span = 1, se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n\n\nif we add color = sex to aes, it will do a smoother line (moving average) for each sex\n\n\n# add color = sex to aes\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g, color = sex)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\nggplot(dat_yt, aes(length_cm, gonad_wt_g, color = fishing_level)) +\n  geom_point()  +\n  geom_smooth(se = FALSE)\n\n\n\n\nCan see differences in the relationship between the sexes. However fishing_level does not appear to impact the relationship at all (all fishing levels have very similar smoother lines)."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#cor-within-summarize",
    "href": "Scatterplots_cor_lm_regression.html#cor-within-summarize",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "cor() within summarize()",
    "text": "cor() within summarize()\n\ncor() is the original base R function to calculate a correlation coefficient.\nYou can use cor() work with the pipe operator and the summarize() function, similar to calculating a mean, median, etc.\nNote: the cor() function has arguments for the x and y variables in the correlation\nand if there are NAs in either variable you need to add the argument use = \"pairwise.complete.obs\" so the result is not an NA (it will make R ignore any observations (fish in the this case) that has an NA (missing data) for either its length or gonad weight in the raw data.\n\n\ndat_yt |&gt;\n  summarize(r = cor(x = length_cm, y = gonad_wt_g, use = \"pairwise.complete.obs\"))\n\n# A tibble: 1 × 1\n       r\n   &lt;dbl&gt;\n1 -0.634\n\n\nHere -0.63 indicates a moderately strong (strength) negative (direction) relationship between for the entire sample of Yellow Tang length and gonad weight as can be seen in the previous scatter plot."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#correlation-coefficient-r-for-each-level-of-a-variable-w-group_by",
    "href": "Scatterplots_cor_lm_regression.html#correlation-coefficient-r-for-each-level-of-a-variable-w-group_by",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Correlation Coefficient r for each level of a variable w/ group_by()\n",
    "text": "Correlation Coefficient r for each level of a variable w/ group_by()\n\n\nCalculate the correlation coefficient each sex using the group_by function:\n\n\ndat_yt |&gt;\n  group_by(sex) |&gt;\n  summarize(r = cor(length_cm, gonad_wt_g, \n                    use = \"pairwise.complete.obs\"))\n\n# A tibble: 2 × 2\n  sex       r\n  &lt;chr&gt; &lt;dbl&gt;\n1 F     0.104\n2 M     0.192\n\n\nWhen we ran the correlation with all data (all fish in the sample) it was -0.63, but now for each sex individually it switches to very week positive relationships (0.19 for males and 0.10 for females)."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#corrr-tidyverse-package",
    "href": "Scatterplots_cor_lm_regression.html#corrr-tidyverse-package",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "\ncorrr tidyverse package",
    "text": "corrr tidyverse package\nhttps://www.tidyverse.org/blog/2020/12/corrr-0-4-3/\ncorrr is a package for exploring correlations in R, focused on creating and working with data frames of correlations that can be easily explored via corrr functions or by leveraging other functions in the tidyverse. It’s main value is if you want to run a lot of correlations between many different variables in a data.frame, so we won’t use it much/at all in our course. JUST HERE FOR DEMO, don’t need to install/use…\n\n(install if necessary, and) load the corrr package with the library() function\n\n\n# must download and install corrr package on your computer if you have never done so before (only need to do this once).\n# uncomment the code below to install if needed:\n# install.packages(\"corrr\")\nlibrary(corrr)\n\n\n\ncorrelate() is the function from the corrr package to produce correlation coefficients.\n\n\ndat_yt |&gt; \n  select(length_cm, gonad_wt_g) |&gt; \n  correlate()\n\n# A tibble: 2 × 3\n  term       length_cm gonad_wt_g\n  &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;\n1 length_cm     NA         -0.634\n2 gonad_wt_g    -0.634     NA    \n\n\n\nThe output is similar to the one produced by the cor() function above if you just want to see the correlation coefficient for a pair of numerical variables.\nHowever, the correlate() output is a data.frame (i.e., a tidyverse “tibble”) instead of being a matrix, so there are some advantages. But the real benefits come if you want to run correlations between many pairs of variables and/or visualize those.\nSee the tidyverse help page for the corrr package if you want to see more examples of what it can do: https://www.tidyverse.org/blog/2020/12/corrr-0-4-3/\n\n\n\nHere we select all numerical columns, and then calculate correlation between all pair-wise combinations of variables.\n\n\ndat_yt |&gt;\n  select_if(is.numeric) |&gt; \n  correlate()\n\n# A tibble: 5 × 6\n  term          length_cm gonad_wt_g home_range_m2 gut_wt_g parasites\n  &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 length_cm       NA         -0.634         0.0452  -0.0998   -0.0944\n2 gonad_wt_g      -0.634     NA            -0.0356   0.119     0.0479\n3 home_range_m2    0.0452    -0.0356       NA       -0.0558   -0.294 \n4 gut_wt_g        -0.0998     0.119        -0.0558  NA         0.0268\n5 parasites       -0.0944     0.0479       -0.294    0.0268   NA"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#guess-the-correlation-coefficient",
    "href": "Scatterplots_cor_lm_regression.html#guess-the-correlation-coefficient",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Guess the correlation coefficient:",
    "text": "Guess the correlation coefficient:\nhttps://psu-eberly.shinyapps.io/Correlation_Guessing/\nIt is good to be able to relatively precisely (maybe within 0.3) guess a correlation coefficient from looking at a plot of data.\n(This Shiny App is something else built with R)"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#examples-to-illustrate-relationships-to-traditional-inference-methods-well-be-covering-this-semester",
    "href": "Scatterplots_cor_lm_regression.html#examples-to-illustrate-relationships-to-traditional-inference-methods-well-be-covering-this-semester",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Examples to illustrate relationships to traditional inference methods we’ll be covering this semester",
    "text": "Examples to illustrate relationships to traditional inference methods we’ll be covering this semester\n\nIn all examples below we have 1 numerical response variable (gonad weight)\n\nGeneral Linear Models assess the influence of one or more predictor variables. Examples of these could be:\n\none numerical predictor (Simple Linear Regression)\none categorical predictor (ANOVA) (or t-test if only 2 levels of that variable)\none numerical predictor + one categorical predictor (ANCOVA)\nAnd then many more complicated examples also possible\n\n\n\n\n# one numerical predictor (Simple Linear Regression)\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point()  +\n  geom_smooth(method = lm, se = FALSE) +\n  ggtitle(\"Simple Linear Regression - predict Y for each X\")\n\n\n\n# one categorical predictor (ANOVA)\nggplot(dat_yt, aes(x = fishing_level, y = gonad_wt_g)) +\n  geom_point()  +\n  stat_summary(fun = \"mean\", color = \"blue\", size = 10, \n               geom = \"point\", shape = \"_\") +\n  ggtitle(\"ANOVA - compare group means\")\n\n\n\n# one numerical predictor + one categorical predictor (ANCOVA)\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g, color = fishing_level)) +\n  geom_point()  +\n  geom_smooth(method = lm, se = FALSE) +\n  ggtitle(\"ANCOVA - compare linear relationships across groups\")"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#fitting-a-linear-regression-model-with-lm",
    "href": "Scatterplots_cor_lm_regression.html#fitting-a-linear-regression-model-with-lm",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Fitting a Linear Regression Model with lm()\n",
    "text": "Fitting a Linear Regression Model with lm()\n\ndoes yellow tang length explain (predict) gonad weight?\n\nFit the linear model using the lm() function\n\ndefine the model in lm() with a formula:\n\n\nresponse_variable ~ predictor_variable\n\ny ~ x\ngonad_wt_g ~ length_cm\n(in words: “gonad weight as a function of length”)\n\n\nuse the argument: data = dat_yt to tell the function where the variables are stored\nstore result as a object named lm_gonad_length\nThen run the lm object name to view the model coefficients (i.e, the “parameter estimates”)\n\n\n#fit the regression line (linear model function lm), store result as a object named lm_gonad_length \nlm_gonad_length &lt;- lm(gonad_wt_g ~ length_cm, data = dat_yt)\n\n\n#then run the lm object name to view the fitted model coefficients\nlm_gonad_length\n\n\nCall:\nlm(formula = gonad_wt_g ~ length_cm, data = dat_yt)\n\nCoefficients:\n(Intercept)    length_cm  \n     35.175       -1.318  \n\n\ny-intercept = 35.2, and slope = -1.3\nSlope interpretation (put in context of units of each variable): as length increases by 1 cm, gonad weight decreases by 1.3 g\nRegression line equation (Y = b0 + b1X):\n(gonad weight) = 35.2 - 1.3*(length)"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#add-the-regression-line-to-your-plot-w-geom_smooth",
    "href": "Scatterplots_cor_lm_regression.html#add-the-regression-line-to-your-plot-w-geom_smooth",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Add the regression line to your plot w/ geom_smooth()",
    "text": "Add the regression line to your plot w/ geom_smooth()\n\nuse argument method  = lm in geom_smooth()\n\nalso include argument se = FALSE to not plot confidence interval bands (not relevant here)\n\n\n\n# add the regression line to your plot using argument\n# method  = lm in geom_smooth\nggplot(dat_yt, aes(length_cm, gonad_wt_g)) +\n  geom_point()  +\n  geom_smooth(method = lm, se = FALSE)\n\n\n\n\n\n\nthe coef() function extracts the coefficients from the linear model object\n\n\n# display model coefficients\ncoef(lm_gonad_length)\n\n(Intercept)   length_cm \n  35.174927   -1.317731 \n\n\n\nCan also use base R selection code to extract each parameter\n\n\n# extract the first coefficient (Intercept)\ncoef(lm_gonad_length)[[1]]\n\n[1] 35.17493\n\n# extract the second coefficient (slope)\ncoef(lm_gonad_length)[[2]]\n\n[1] -1.317731"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#r2-coefficient-of-determination",
    "href": "Scatterplots_cor_lm_regression.html#r2-coefficient-of-determination",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "R2 “Coefficient of Determination”",
    "text": "R2 “Coefficient of Determination”\nr2 (for simple linear regression) or R2 (all other model types)\n\nranges from: 0 to 1.0 (0 to 100% of variation in Y explained by model)\nMeasures only the STRENGTH of the linear relationship between two quantitative variables\n“How well do the points fit the line?”\nindependent of direction of relationship (+/- slope doesn’t matter)\n\nThere are many ways to find/extract the r2 value (using glance is probably the preferred method):\n\n#PREFERRED METHOD - using glance from broom package (in tidymodels)\n# use/report Adjusted R-sqrd\nglance(lm_gonad_length)\n\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     0.402         0.395  3.69      64.4 2.50e-12     1  -266.  538.  546.\n# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;\n\n# can also extract r-squared value (coefficient of determination) from the model\n# with base R summary function\nsummary(lm_gonad_length)\n\n\nCall:\nlm(formula = gonad_wt_g ~ length_cm, data = dat_yt)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.8203 -2.3654 -0.8058  1.9021 10.6041 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  35.1749     2.9755  11.822  &lt; 2e-16 ***\nlength_cm    -1.3177     0.1642  -8.026  2.5e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.693 on 96 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.4015,    Adjusted R-squared:  0.3953 \nF-statistic: 64.41 on 1 and 96 DF,  p-value: 2.505e-12\n\n# use Adjusted R-sqrd\n\nNote that the Adjusted R-squared is an attempt to account for the phenomenon of the R2 automatically and spuriously increasing when extra explanatory variables are added to the model (from &lt;https://en.wikipedia.org/wiki/Coefficient_of_determination&gt;). This is often what is actually reported in papers as the R2 value (and they don’t note that it is the “adjusted” value). It is always going to be a little lower than the “regular” or “Multiple” R2 value, so it is the more conservative statistic to report."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#compare-a-smoother-line-i.e.-moving-average-curve-to-the-linear-regression-line",
    "href": "Scatterplots_cor_lm_regression.html#compare-a-smoother-line-i.e.-moving-average-curve-to-the-linear-regression-line",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Compare a smoother line (i.e., moving average curve) to the linear regression line:",
    "text": "Compare a smoother line (i.e., moving average curve) to the linear regression line:\n\ndat_yt |&gt; \nggplot(aes(x =  length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(se = F, span = 0.5, color = \"purple\") +\n  geom_smooth(se = F, method = lm, color = \"gold\")\n\n\n\n\nIn many places most of the data is either below or above the (gold) regression line, and the purple smoother (moving average LOESS line) tracks the data and shows this “lack of fit” to the linear regression model."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#model-residuals-examining-them",
    "href": "Scatterplots_cor_lm_regression.html#model-residuals-examining-them",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Model Residuals (examining them)",
    "text": "Model Residuals (examining them)\nModel residuals are the difference (in the Y or vertical direction) between the observed y values (the data) and the predicted y values (the regression line).\n\nWe can use the augment() function (from broom package) to extract information from the model about each point in our data set\nWe can save those as a data.frame named lm_gonad_length_augment\n\n\n## use augment() function (from broom package, loaded in tidymodels) to extract information from the model\n# about each point in our data set\nlm_gonad_length_augment &lt;- augment(lm_gonad_length)\n#\nlm_gonad_length_augment\n\n# A tibble: 98 × 9\n   .rownames gonad_wt_g length_cm .fitted .resid   .hat .sigma   .cooksd\n   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;\n 1 1                6.6      20.3    8.42 -1.82  0.0208   3.71 0.00265  \n 2 2               22        16     14.1   7.91  0.0179   3.62 0.0427   \n 3 3                6.2      17.2   12.5  -6.31  0.0114   3.66 0.0170   \n 4 4               17.4      17.1   12.6   4.76  0.0117   3.68 0.00997  \n 5 5               17.6      15.9   14.2   3.38  0.0188   3.70 0.00814  \n 6 7                9.1      17.7   11.9  -2.75  0.0104   3.70 0.00293  \n 7 8               15.4      15.1   15.3   0.123 0.0266   3.71 0.0000155\n 8 9                8.8      21.1    7.37  1.43  0.0294   3.71 0.00234  \n 9 10               7.6      19.1   10.0  -2.41  0.0127   3.70 0.00276  \n10 11               9        19.1   10.0  -1.01  0.0127   3.71 0.000483 \n# ℹ 88 more rows\n# ℹ 1 more variable: .std.resid &lt;dbl&gt;\n\n\n\nThe .fitted column are the predicted y values (along the regression line) for each point (length value)\nThe .resid column are the residuals (in this example: gonad_wt_g - .fitted)"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#histogram-of-model-residuals",
    "href": "Scatterplots_cor_lm_regression.html#histogram-of-model-residuals",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Histogram of model residuals",
    "text": "Histogram of model residuals\n\nThis is a standard plot you should make to assess “model fit”\nIf the model fits well, residuals should be relatively normally distributed (e.g., symmetrical, no big outliers or multi-modality)\n\n\n## Plot a histogram of the model residuals, \nggplot(lm_gonad_length_augment, aes(x = .resid)) +\n  geom_histogram()\n\n\n\n\nIn this example the distribtion of the residuals is somewhat skewed with a positive tail, although that by itself would not be too worrisome (need to look at the other plots as well), but could mean a signle regression line is not the best way to model the relationship…"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#residuals-vs-predictor-plot",
    "href": "Scatterplots_cor_lm_regression.html#residuals-vs-predictor-plot",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Residuals vs Predictor Plot",
    "text": "Residuals vs Predictor Plot\n\nThis is another standard plot you should make to assess “model fit”\nScatterplot of the model residuals vs. the predictor (x) values from your model\nIf the model fits well, there should be no clear patterns in this plot (should look like just a random scatter of points)\nYou can add a smoother (moving average line) to this plot as another way to assess if there is pattern in residuals (if not pattern it should be more or less a flat horizontal line)\n\n\n## Scatterplot of the model residuals vs. the predictor (x) values\nggplot(lm_gonad_length_augment, aes(x =  length_cm, y = .resid)) +\n  geom_point() +\n  geom_smooth(se = F)\n\n\n\n\nIn this example there is CLEARLY a pattern to the residuals, indicating the linear regression line does NOT fit the data well. If there was no pattern in the residuals the blue line would be closer to a flat/horizontal line."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#high-leverageinfluence-points",
    "href": "Scatterplots_cor_lm_regression.html#high-leverageinfluence-points",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "High Leverage/Influence Points",
    "text": "High Leverage/Influence Points\nVisually check your plot of the data for individual points that have high leverage and may be highly influential.\n\ni.e., look for outliers that also have “high leverage” meaning they are extreme in terms of their X (predictor) values\nIf a high leverage point, also has a large residual, it is highly influential. (i.e., quantified as “cooks distance”.)\nFor the upcoming assignment, just note if there are any points you think might be like this. Later in the semester we’ll discuss other ways to better assess/address the influence of these points on your model.\nFor more info on Outliers, Leverage Points and Influential Points see: https://www2.stat.duke.edu/courses/Spring19/sta101.002/post/project/outliers.html\n\n\nJust for demo purposes… (this goes beyond the scope of the next assignment, here we’ll bring in another explanatory (categorical) variable to our linear model)."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#how-do-residual-plots-look-in-a-better-fitting-model",
    "href": "Scatterplots_cor_lm_regression.html#how-do-residual-plots-look-in-a-better-fitting-model",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "How do residual plots look in a better fitting model?",
    "text": "How do residual plots look in a better fitting model?\nPrimary thing I want you to notice is the two residual examination plots below. Check out the:\n\n\nHistogram of Residuals (now much more Normal compared to the one above without the sex in the model)\nScatter plot of residual vs. predictor values (now no pattern in points, and smoother goes more or less flat/horizontally across the plot)\nThese both indicate that this model fits the data much better than our previous model.\n\n\n# Let's add variable sex to our model and see how that changes the residuals\nggplot(dat_yt, aes(length_cm, gonad_wt_g, color = sex)) +\n  geom_point()  +\n  geom_smooth(method = lm, se = FALSE) +\n  ggtitle(\"1 Numerical and 1 Categorical Predictor Variable (ANCOVA)\")\n\n\n\n#fit the regression line (linear model function lm), store result as a object named lm_gonad_length \nlm_gonad_length_by_sex &lt;- lm(gonad_wt_g ~ length_cm*sex, data = dat_yt)\n\n# diplay linear model results\nlm_gonad_length_by_sex\n\n\nCall:\nlm(formula = gonad_wt_g ~ length_cm * sex, data = dat_yt)\n\nCoefficients:\n   (Intercept)       length_cm            sexM  length_cm:sexM  \n      8.516886        0.407111       -8.618333       -0.004471  \n\n# use augment function to extract residuals of our new model\nlm_gonad_length_by_sex_augment &lt;- augment(lm_gonad_length_by_sex)\n\n# histogram of residuals\nggplot(lm_gonad_length_by_sex_augment, aes(x = .resid)) +\n  geom_histogram() +\n  ggtitle(\"histogram of residuals\")\n\n\n\n# residuals vs. predictor (x-values) plot\nggplot(lm_gonad_length_by_sex_augment, aes(x =  length_cm, y = .resid)) +\n  geom_point() +\n  geom_smooth(se = F) +\n  ggtitle(\"residuals vs. predictor (x-values) scatter plot\")\n\n\n\n\nThe plots above all indicate that this model (now including sex variable) fits the data much better than our previous model (without the sex variable)."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#making-predictions-with-your-linear-model-line-equation",
    "href": "Scatterplots_cor_lm_regression.html#making-predictions-with-your-linear-model-line-equation",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Making Predictions with your linear model line equation",
    "text": "Making Predictions with your linear model line equation\nCalculate the predicted gonad weight for length of 20 cm using the linear model\n\n# Y = b0 + b1*X\n\n# predicted Y = y-intercept + slope * x-value\n\n# type in y-intercept and slope values\n35.174 + (-1.318 * 20)\n\n[1] 8.814\n\n# You could also use the coef() function to extract the intercept and slope within the line equation\ncoef(lm_gonad_length)[[1]] + coef(lm_gonad_length)[[2]]*20\n\n[1] 8.820298\n\n\nCan also use the predict() function to predict y values for a given x\n\n#create a data.frame with the length you want a prediction of gonad weight for\nnew_data &lt;- data.frame(length_cm = 20)\n# use predict function and your linear model\npredict(lm_gonad_length, newdata = new_data)\n\n       1 \n8.820298 \n\n\nVisualize a prediction by adding lines to the plot\n\nTo visualize the prediction, add a vertical line to your plot with geom_vline() at length = 20 cm\nAnd a horizontal line to your plot with geom_hline() at the predicted gonad weight value\n\n\nggplot(dat_yt, aes(length_cm, gonad_wt_g)) +\n  geom_point()  +\n  geom_smooth(method = lm, se = FALSE) +\n # add a vertical  line at length = 20 cm \n  geom_vline(xintercept = 20, color = \"green\") + \n# add a horizontal line at the predicted gonad weight value\n  geom_hline(yintercept = 8.8, color = \"brown\")"
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#geom_smooth-to-add-lowess-moving-average-curve",
    "href": "Scatterplots_cor_lm_regression.html#geom_smooth-to-add-lowess-moving-average-curve",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "\ngeom_smooth() to add LOWESS moving average curve",
    "text": "geom_smooth() to add LOWESS moving average curve\nhttps://ggplot2.tidyverse.org/reference/geom_smooth.html\n\ngeom_smooth() by default adds a moving average smoother line, also referred to as a LOWESS smoother curve (Locally Weighted Scatterplot Smoothing)\nwe add the argument se = FALSE so that confidence interval bands around smoother line do not plot, which is not necessary here.\n\n\n# a smoother line (moving average) for all data\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n\nAdjust the span argument\n\nThe span changes the range of x values over which the the moving average is done.\nSimilar to adjusting binwidths in a histogram, try values between 0.3 and 1.0 for span to see how it affects the smoother line and what patterns in the data it reveals.\n\n\n# span = 0.3\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(span = 0.3, se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n# span = 1\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(span = 1, se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\n\n\nif we add color = sex to aes, it will plot a smoother line (moving average) for each sex\n\n\n# add color = sex to aes\nggplot(dat_yt, aes(x = length_cm, y = gonad_wt_g, color = sex)) +\n  geom_point() +\n  geom_smooth(se = FALSE) +\n  xlab(\"length (cm)\") +\n  ylab(\"gonad weight (g)\")\n\n\n\nggplot(dat_yt, aes(length_cm, gonad_wt_g, color = fishing_level)) +\n  geom_point()  +\n  geom_smooth(se = FALSE)\n\n\n\n\nCan see differences in the relationship between the sexes. However fishing_level does not appear to impact the relationship at all (all fishing levels have very similar smoother lines)."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#compare-a-smoother-curve-to-the-linear-regression-line",
    "href": "Scatterplots_cor_lm_regression.html#compare-a-smoother-curve-to-the-linear-regression-line",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "Compare a smoother curve to the linear regression line",
    "text": "Compare a smoother curve to the linear regression line\n\ndat_yt |&gt; \nggplot(aes(x =  length_cm, y = gonad_wt_g)) +\n  geom_point() +\n  geom_smooth(se = F, span = 0.5, color = \"purple\") +\n  geom_smooth(se = F, method = lm, color = \"gold\")\n\n\n\n\nIn many places most of the data is either below or above the (gold) regression line, and the purple smoother (moving average LOESS line) tracks the data and shows this “lack of fit” to the linear regression model."
  },
  {
    "objectID": "Scatterplots_cor_lm_regression.html#fancy-residuals-plot-for-demo-purposes",
    "href": "Scatterplots_cor_lm_regression.html#fancy-residuals-plot-for-demo-purposes",
    "title": "BIO 5100 - Correlation & Regression Intro, Normal Distributions",
    "section": "“Fancy” Residuals plot (for demo purposes)",
    "text": "“Fancy” Residuals plot (for demo purposes)\nWe can make a fancy plot visualizing the residuals (larger residuals have larger points and more red color). Adapted code from https://drsimonj.svbtle.com/visualising-residuals\n\nlm_gonad_length_augment |&gt; \nggplot(aes(x = length_cm, y = gonad_wt_g)) +\n  geom_smooth(method = lm, se = FALSE, color = \"lightgrey\") +\n  geom_segment(aes(xend = length_cm, yend = .fitted), alpha = .2) +\n  # point color AND size mapped to residual size\n  geom_point(aes(color = abs(.resid), size = abs(.resid))) +\n  scale_color_continuous(low = \"black\", high = \"red\") +\n  # color and size legend also removed\n  guides(color = \"none\", size = \"none\") +  \n  geom_point(aes(y = .fitted), shape = 1) +\n  theme_bw()"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html",
    "href": "Compare_means_independent_paried_samples.html",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "",
    "text": "# load tidyverse packages\nlibrary(tidyverse)\n\n# load broom package (for linear model related functions)\n# note broom package is installed as part of tidymodels package\nlibrary(broom)\n\n# load skimr package - to use skim() function for descriptive statistics\nlibrary(skimr)\n\n# load emmeans \"estimated marginal means\" package\nlibrary(emmeans)\n\n# load cowplot package - used to combine multiple ggplots into a single figure\nlibrary(cowplot)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nThe broom Package is installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\nThe emmeans Package will be used to output means, 95% CIs, p-values and other statistics from specified lm() objects\n\nLots of vignettes here that demo what the package can do: https://cran.r-project.org/web/packages/emmeans/index.html\nThis one reviews the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\nThe cowplot Package will be used here to combined multiple ggplots into a single figure. But it also contains functions for all sorts other plotting purposes (some cool/useful, others I would not necessarily advise using):\n\ncowplot https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#load-packages",
    "href": "Compare_means_independent_paried_samples.html#load-packages",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "",
    "text": "# load tidyverse packages\nlibrary(tidyverse)\n\n# load broom package (for linear model related functions)\n# note broom package is installed as part of tidymodels package\nlibrary(broom)\n\n# load skimr package - to use skim() function for descriptive statistics\nlibrary(skimr)\n\n# load emmeans \"estimated marginal means\" package\nlibrary(emmeans)\n\n# load cowplot package - used to combine multiple ggplots into a single figure\nlibrary(cowplot)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nThe broom Package is installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\nThe emmeans Package will be used to output means, 95% CIs, p-values and other statistics from specified lm() objects\n\nLots of vignettes here that demo what the package can do: https://cran.r-project.org/web/packages/emmeans/index.html\nThis one reviews the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\nThe cowplot Package will be used here to combined multiple ggplots into a single figure. But it also contains functions for all sorts other plotting purposes (some cool/useful, others I would not necessarily advise using):\n\ncowplot https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html\n\n\n\n\n# General modeling strategy:\n\n\n\n# Linear model w/ a categorical X (explanatory) variable (comparing means of 2 independent samples)\n\n\nFor this analysis we’ll use one of the data sets built into R:\n\n\n\nToothGrowth (The Effect of Vitamin C on Tooth Growth in Guinea Pigs)\n\n\nFrom: Crampton, E. W. (1947). The growth of the odontoblast of the incisor teeth as a criterion of vitamin C intake of the guinea pig. The Journal of Nutrition, 33(5), 491-504. doi: https://academic.oup.com/jn/article-abstract/33/5/491/4726758.\n\n\n\n\nNote: R has many built-in data sets and a list of them can be viewed with the data() function\n\n\n\nIn the ToothGrowth data set the response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\n\n\n::: {.cell}\n\n\n```{.r .cell-code} #Each built in data set has a help file that can be viewed: ?ToothGrowth\n\n\n#View the structure of the full data set: glimpse(ToothGrowth) ```\n\n\n::: {.cell-output .cell-output-stdout}\n\n\nWhile the full data set has 1 numeric response (len) and 2 categorical explanatory variables (Supplement Type and Dose) we are going to reduce the data set to only one explanatory variable (supp: Supplement Type) with 2 levels (OJ: Orange Juice; VC: Ascorbic Acid) by filtering the data to select only guinea pigs that received a dose == 1\n\n\n\n::: {.cell}\n\n\n```{.r .cell-code} dat_tg &lt;- ToothGrowth |&gt; filter(dose == 1) |&gt; select(len, supp)\n\n\nglimpse(dat_tg) ```\n\n\n::: {.cell-output .cell-output-stdout}\n\n\nBiological Question: Does supplement type of vitamin C have an effect on length of odontoblasts (cells responsible for tooth growth) in guinea pigs? (when given a dose level of 1 mg/day)\n\n\n## Initial Exploratory Analysis\n\n\n::: {.cell}\n\n\n{.r .cell-code} # Individual Value Plot (Stripchart) length by supplement type dat_tg |&gt; ggplot(aes(x = supp, y = len)) + geom_jitter(width = 0.1)\n\n\n::: {.cell-output-display}  :::\n\n\n{.r .cell-code} # Histogram of length faceted by supplement type dat_tg |&gt; ggplot(aes(x = len)) + geom_histogram(bins = 6) + facet_grid(rows = vars(supp))\n\n\n::: {.cell-output-display}  :::\n\n\n{.r .cell-code} # Boxplots of length by supplement type dat_tg |&gt; ggplot(aes(x = supp, y = len)) + geom_boxplot()\n\n\n::: {.cell-output-display}  :::\n\n\n{.r .cell-code} # summary/descriptive statistics of length by supplement type dat_tg |&gt; group_by(supp) |&gt; skim()\n\n\n::: {.cell-output-display} Table: Data summary\n\n\n| | | |:————————|:———————-| |Name |group_by(dat_tg, supp) | |Number of rows |20 | |Number of columns |2 | |_______________________ | | |Column type frequency: | | |numeric |1 | |________________________ | | |Group variables |supp |\n\n\nVariable type: numeric\n\n\n|skim_variable |supp | n_missing| complete_rate| mean| sd| p0| p25| p50| p75| p100|hist | |:————-|:—-|———:|————-:|—–:|—-:|—-:|—–:|—–:|—–:|—-:|:—–| |len |OJ | 0| 1| 22.70| 3.91| 14.5| 20.30| 23.45| 25.65| 27.3|▂▁▆▃▇ | |len |VC | 0| 1| 16.77| 2.52| 13.6| 15.27| 16.50| 17.30| 22.5|▇▇▇▁▂ | ::: :::\n\n\n## Checking assumptions\n\n\nLinear model assumptions:\n\n\nMore details/descriptions can be found here:\n\n\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model\n\n\nt-test assumptions are also described in (way too much) detail here: https://en.wikipedia.org/wiki/Student%27s_t-test#Assumptions\n\n\n\nThe most relevant are:\n\n\n- data are independent (e.g., not paired, grouped, or otherwise related by some other factor that the grouping variable already in your model), collected with a random sampling approach - model residuals are normally distributed - Constant or “equal” variance or homoskedasticity\n\n\n### In practical terms just check to make sure during exploratory analysis:\n\n\n1. there are no “large” outliers 2. the distributions of each group are not highly skewed or bimodal (although this is often hard to judge at small sample sizes) 3. Check for “equal” variances among groups (homoscedasticity)\n\n\n\n- This assumption says that all groups (samples) of data have “the same” variance (e.g., spread, sd), but in terms of checking it’s about making sure the standard deviations are not too different from each other.\n\n\nFirst look at plots above (histogram, boxplot, individual value plot): Does the spread look similar in 2 samples?\n\n\n\nThen assess equal variance assumption with a “rule of thumb”:\n\n\n- Primary rule: (When n/group &gt; 5 & n/groups similar) Consider alternative approach if largest sd &gt; 4*smallest sd (i.e., variances not similar enough) - Secondary Rule: (When n/group NOT similar) Be extra cautious when largest sd is associated with the group with the smallest n. In this case consider alternative approach if largest sd &gt; 2*smallest sd. - see Zar Biostatistical Analysis textbook for more info (and/or could cite in thesis/paper if necessary)\n\n\n\nIf there are large outliers, one/both of the distributions are very highly skewed, and/or the spread in the data is very different between groups, then can consider other options for calculating the 95% CIs (e.g., bootstrapping), using a Generalized linear model, and/or running a non-parametric test.\n\n\n\n## Descriptive Statistics for comparing two groups\n\n\nFor EACH GROUP (SAMPLE) of numerical response variable length we’ll calculate:\n\n\n- mean: mean()\n\n\n\n- standard deviation (spread in data): sd()\n\n\n\n- sample size: n()\n\n\n\n::: {.cell}\n\n\n{.r .cell-code} dat_tg |&gt; group_by(supp) |&gt; summarise( mean_length = mean(len), sd_length = sd(len), n_length = n() )\n\n\n::: {.cell-output .cell-output-stdout}\n\n\n## Magnitude of the effect size\n\n\nWe can then pull values from the calculated statistics above to make an additional calculation of the magnitude of the effect size (i.e., how different are the 2 means?)\n\n\n- effect size (difference between the means)\n\n\n- effect size as a percent difference (difference between the means/smaller mean * 100)\n\n\n- Note: “Direction” of effect size in this instance refers to indicating which mean is larger.\n\n\n\n::: {.cell}\n\n\n{.r .cell-code} # effect size: mean OJ - mean VC 22.7-16.8\n\n\n::: {.cell-output .cell-output-stdout}\n\n\n{.r .cell-code} # effect size expressed as percentage difference # use round() function to round to 0 decimal places round((22.7-16.8)/16.8*100, 0)\n\n\n::: {.cell-output .cell-output-stdout}\n\n\n## Fit linear model\n\n\nNote this code/process is adapted from: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#oneway\n\n\n\n- If you want more background, detailed explanation or need to do a more complicated analysis, that is a great resource.\n\n\n\nFit the linear model (numerical response w/ 1 categorical X value)\n\n\n- in lm() formula: - Y ~ X\n\n\n- Response (numeric variable) ~ Explanatory (in this case a categorical variable)\n\n\n::: {.cell}\n\n\n```{.r .cell-code} lm_len_supp &lt;- lm(len ~ supp, data = dat_tg)\n\n\nlm_len_supp ```\n\n\n::: {.cell-output .cell-output-stdout} ```\n\n\nCall: lm(formula = len ~ supp, data = dat_tg)\n\n\nCoefficients: (Intercept) suppVC 22.70 -5.93 ``` ::: :::\n\n\n### Coefficient table\n\n\nCreate a “coefficient table” in a “tidy” table format using tidy() function from broom package, with a conf.int = T argument to include calculation of 95% CIs.\n\n\n- Note: the coefficient table is not the most useful/friendly format and can include some irrelevant information. While it is a good idea to create and review it, you will mostly use/interpret the emmeans and contrast (pairs) tables below.\n\n\n\n::: {.cell}\n\n\n```{.r .cell-code} # use tidy function from broom package with the linear model object lm_len_supp_coef &lt;- tidy(lm_len_supp, conf.int = TRUE)\n\n\nlm_len_supp_coef ```\n\n\n::: {.cell-output .cell-output-stdout}\n\n\n## Create emmeans table\n\n\nUsing emmeans() function from the emmeans package\n\n\n\n- Provides the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\n\n\n- & Lots of vignettes for other uses of functions in this package: https://cran.r-project.org/web/packages/emmeans/index.html\n\n\n\n::: {.cell}\n\n\n```{.r .cell-code} # create emmeans table object lm_len_supp_emm &lt;- emmeans(lm_len_supp, ~ supp)\n\n\nlm_len_supp_emm ```\n\n\n::: {.cell-output .cell-output-stdout} ``` supp emmean SE df lower.CL upper.CL OJ 22.7 1.04 18 20.5 24.9 VC 16.8 1.04 18 14.6 19.0\n\n\nConfidence level used: 0.95 ``` ::: :::\n\n\n- The means (emmean column) in the emmeans table are technically “modeled” means, but here, and for many linear models, these will be equal to the sampled means (the means calculated from each group of raw data). This may not be the case for some more complicated models.\n\n\n- The 95% CIs in the emmeans table (lower.CL to upper.CL) are calculated using all the data in the model (using a pooled standard deviation and sample size across both groups of data). You’ll notice they both have the same size:\n\n\n- OJ: 20.5 to 24.9 = 4.4\n\n\n- VC: 14.6 to 19.0 = 4.4\n\n\n- If 95% CIs were calculated using just the OJ (or VC) data for each mean individually they would be different sizes.\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics\n\n\n\n## Points & means plot w/ (model) 95% CIs\n\n\n::: {.cell}\n\n\n```{.r .cell-code} # note in ggplot below we had to turn the emmeans object into a tibble (data.frame) so it would work as data in ggplot # as_tibble(lm_len_supp_emm)\n\n\nplot_lm_len_supp_emm &lt;- dat_tg |&gt; ggplot(aes(x = supp, y = len, color = supp)) + geom_jitter(width = 0.1) + ylab(“Length of Odontoblasts (μm)”) + xlab(“Supplement Type”) + #use emm object as 2nd data table to plot 95% CIs geom_crossbar( data = as_tibble(lm_len_supp_emm), aes(y = emmean, ymin = lower.CL, ymax = upper.CL), width = 0.1 ) + theme_classic() + theme(legend.position = “none”)\n\n\nplot_lm_len_supp_emm ```\n\n\n::: {.cell-output-display}  ::: :::\n\n\nThis plot shows the raw data for each group (OJ, VC) as points. The geom_crossbar() plots the group means (middle line) and the 95% CIs from the associated linear model which were calculated in the emmeans table above.\n\n\n- Note geom_pointrange() could be used instead of geom_crossbar() if you prefer that style of plotting mean + CIs https://ggplot2.tidyverse.org/reference/geom_linerange.html (scroll down to bottom of page to see various examples of ways to plot error bars around a mean)\n\n\n## Contrasts table & corresponding “effects” plot\n\n\n\n“Contrasts table” using contrast() function from emmeans package\n\n\n\n- For details on the argument method = see help(“contrast-methods”)\n\n\n::: {.cell}\n\n\n```{.r .cell-code} lm_len_supp_pairs &lt;- contrast(lm_len_supp_emm, method = “pairwise”) |&gt; summary(infer = TRUE) # Note: method = “revpairwise” switches the order in subtraction for comparison # (up to researcher/you to determine which is more appropriate)\n\n\nlm_len_supp_pairs ```\n\n\n::: {.cell-output .cell-output-stdout} ``` contrast estimate SE df lower.CL upper.CL t.ratio p.value OJ - VC 5.93 1.47 18 2.84 9.02 4.033 0.0008\n\n\nConfidence level used: 0.95 ``` ::: :::\n\n\nThis table is important for reporting treatment effect and 95% CI and the object lm_len_supp_pairs is used in the ggplot code below to create the effects plot.\n\n\n- A contrast is a difference in means. - The “estimate” column is this difference - 95% CI of this difference is lower.CL to upper.CL - The columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio. - The p-value here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0? - Or a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means? - And interpret it as a %: There is only a 0.08% chance that these data came from a true population where there was no difference between the 2 means.\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table\n\n\n\n## Effects plot w/ 95% CI\n\n\n::: {.cell}\n\n\n```{.r .cell-code} # NOTE: in ggplot code below we had to turn the contrast object into # a tibble (data.frame) so it would work as data in ggplot\n\n\nplot_lm_len_supp_pairs &lt;- as_tibble(lm_len_supp_pairs) |&gt; ggplot(aes(y = contrast, x = estimate)) + geom_pointrange(aes(xmin = lower.CL, xmax = upper.CL)) + geom_vline(xintercept = 0, linetype = 2) + xlab(“Effects (μm)”) + ylab(““) + scale_x_continuous(position =”top”) + theme_classic()\n\n\nplot_lm_len_supp_pairs ```\n\n\n::: {.cell-output-display}  ::: :::\n\n\nThis plot shows the difference between the 2 means (OJ mean - VC mean = 5.9), and the 95% CI for that difference (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between OJ and VC to be between 2.8 and 9.0”).\n\n\n- The dashed line at 0 is there for reference since if the OJ and VC treatments produced the same tooth cell growth, the difference in their means would be 0.\n\n\n## Combine plots into a single results figure\n\n\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure.\n\n\n- The align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\n::: {.cell}\n\n\n```{.r .cell-code} results_plot &lt;- plot_grid(plot_lm_len_supp_pairs, plot_lm_len_supp_emm, nrow = 2, align = “v”, axis = “rl”, rel_heights = c(0.25, 1) ) # rel_heights argument specifies relative size of two plots (i.e., first plot is 0.25 as tall as the second plot)\n\n\nresults_plot ```\n\n\n::: {.cell-output-display}  ::: :::\n\n\nThis primary results plot is adapted from code in (the version you are using is based on regular ggplot code): https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-6-plot-the-model\n\n\n\n## Export (save) plot to a .png file with ggsave()\n\n\n- the file will be saved to your “working directory” (typically the folder where your .qmd file is). You’ll need to look in that folder to see the .png file\n\n\n\n- You identify the type of file format you want to save it to with the file name extension at the end of the file name. Here we use .png (a great default for putting images into word docs or PPT presentations). But many others are available such as: “.pdf” (easy to view or email a .pdf to someone; and good to use for uploading plot files to journals if they’ll accept this format), “.eps” (another vector format some journals one), “.png”, “.jpeg”, “.tiff”, “.svg”(use for further editing in https://inkscape.org/ freeware on windows).\n\n\n- You can read more about the difference between vector vs. raster image file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885352. And more about specific file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885348\n\n\n\n- You specify the dimensions of the plot with the width = and height = arguments, default is inches. Try different widths and heights (keeping in mind what would fit on a 8in by 11in page size) and see what works for the plot you making. Often a plot shows the data better when it is taller or wider (so try different ratios of width to height).\n\n\n- You can also specify the image “quality” using the “dots per inch” argument dpi = and typically you want to use 300 or 600 for a high quality image. Depending on the file type (with .tiff for example) 600 dpi can sometimes create huge file sizes, but that is usually where I start (then only go down to 300 if needed).\n\n\n- NOTE - sometimes you can get an error when running ggsave() repeatedly if the saved .png file is already open on your computer in your image viewer - need to close it each time you want to edit and re-output the image file.\n\n\n\n::: {.cell}\n\n\n\n{.r .cell-code} # output plot to .png file type, set size (default is inches), 300 or 600 dpi is high quality ggsave( \"plot_len_by_supp_95CIs.png\", results_plot, width = 4, height = 4, dpi = 600 ) :::\n\n\n## Results sentence:\n\n\nUsing statistics produced in the code chunks above we can write:\n\n\nMean length of odontoblasts that received vitamin C from orange juice (mean length: 22.7 μm, 95% CI: 20.5 to 24.9) was 35% higher (mean difference: 5.9 μm , 95% CI: 2.84 to 9.02, p = 0.0008) than those that received vitamin C from an ascorbic acid supplement (mean length: 16.8 μm, 95% CI: 14.6 to 19.0) (Fig. X).\n\n\nNote:\n\n\n1. (Fig. X) would be citing the combined results figure that includes (top) the effects plot and (below) plot w/ the data points, means and the 95% CIs for each group.\n\n\n\n2. You could add the t-statistic and p-value (from the contrasts table) above\n\n\n\nMore explanation of why it is advised you don’t use the word “significant” in the results can be found here (but if you or your adviser want to, that is fine too, since p-value is &lt; 0.05) and examples of writing results can be found here: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-7-report-the-model-results\n\n\n\n## Two-sample t-test (hypothesis test)\n\n\n::: {.cell}\n\n\n\n{.r .cell-code} # Review the help file for the t.test function, there are various options ?t.test :::\n\n\nStatistical Hypotheses (for a two-sample t-test)\n\n\n\nNull Hypothesis: there is no difference (i.e., they are equal) in the population mean lengths of the guinea pigs that received vitamin C through orange juice and ascorbic acid supplements.\n\n\n\nAlternative Hypothesis: there is a difference (i.e., they are not equal) in the population mean lengths of the guinea pigs that received vitamin C through orange juice and ascorbic acid supplements.\n\n\n\n\n\n\nWelch’s t-test does NOT assume equal variances (so you do not need to worry about that assumption of the regular/typical Student’s t-test)\n\nhttps://en.wikipedia.org/wiki/Welch%27s_t-test\nIt defines the statistic t slightly differently, unlike in Student’s t-test, the denominator is not based on a pooled variance estimate.\nIt is not recommended to pre-test for equal variances and then choose between Student’s t-test or Welch’s t-test [5]. Rather, Welch’s t-test can be applied directly and without any substantial disadvantages to Student’s t-test as noted above. Welch’s t-test remains robust for skewed distributions at large sample sizes.[6] Reliability decreases for skewed distributions and smaller samples.\n[5] Zimmerman, D. W. (2004). “A note on preliminary tests of equality of variances”. British Journal of Mathematical and Statistical Psychology. 57: 173–181.\n[6] Fagerland, M. W. (2012). “t-tests, non-parametric tests, and large studies—a paradox of statistical practice?”. BioMed Central Medical Research Methodology. 12: 78. doi:10.1186/1471-2288-12-78.\n\nUse a formula within t.test() and your data object with data = argument.\n\n\nresponse ~ explanatory (here: length as a function of supplement type)\nBy default it runs a two-tailed test.\n\n\n# run default arguments (two-tailed test and assume un-equal variances, with Welch's correction)\nt.test(len ~ supp, data = dat_tg)\n\n\n    Welch Two Sample t-test\n\ndata:  len by supp\nt = 4.0328, df = 15.358, p-value = 0.001038\nalternative hypothesis: true difference in means between group OJ and group VC is not equal to 0\n95 percent confidence interval:\n 2.802148 9.057852\nsample estimates:\nmean in group OJ mean in group VC \n           22.70            16.77 \n\n\nThis p-value is slightly larger than the one calculated in the contrasts table above because it is adjusted larger in this “Welch’s” t-test as part of the process of not needed to assume equal variances.\nAlso note: the 95% CI the t.test() function outputs is the 95% CI of the difference between the two means (i.e., the effect size): mean OJ - mean VC = 5.9 (95% CI: 2.8 to 9.1).\nIn words: if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference to be between 2.8 and 9.1 (length). Because this does not include 0, it by itself can be interpreted as a “significant result.”\n\n\nCan also wrap the tidy() function from broom package around the t.test, to get a “tidy” output with the same values organized in a data.frame\nCan be useful if you want to store the results and directly output values (like p-value or CIs etc.)\n\nhttps://cran.r-project.org/web/packages/broom/vignettes/broom.html\n\nt_test_len_supp &lt;- t.test(len ~ supp, data = dat_tg)\n\n# show results in \"tidy\" data.frame format (from broom package)\ntidy(t_test_len_supp)\n\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1     5.93      22.7      16.8      4.03 0.00104      15.4     2.80      9.06\n# ℹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;\n\n# select mean difference, 95%CIs and p-value\ntidy(t_test_len_supp) |&gt; \n  select(estimate, conf.low, conf.high, p.value)\n\n# A tibble: 1 × 4\n  estimate conf.low conf.high p.value\n     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1     5.93     2.80      9.06 0.00104"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#general-modeling-strategy",
    "href": "Compare_means_independent_paried_samples.html#general-modeling-strategy",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "General modeling strategy:",
    "text": "General modeling strategy:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#modeling-strategy"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#initial-exploratory-analysis",
    "href": "Compare_means_independent_paried_samples.html#initial-exploratory-analysis",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Initial Exploratory Analysis",
    "text": "Initial Exploratory Analysis\n\n# Individual Value Plot (Stripchart) length by supplement type\ndat_tg |&gt;\n  ggplot(aes(x = supp, y = len)) +\n  geom_jitter(width = 0.1)\n\n\n\n# Histogram of length faceted by supplement type\ndat_tg |&gt;\n  ggplot(aes(x = len)) +\n  geom_histogram(bins = 6) +\n  facet_grid(rows = vars(supp))\n\n\n\n# Boxplots of length by supplement type\ndat_tg |&gt;\n  ggplot(aes(x = supp, y = len)) +\n  geom_boxplot()\n\n\n\n# summary/descriptive statistics of length by supplement type\ndat_tg |&gt;\n  group_by(supp) |&gt;\n  skim()\n\n\nData summary\n\n\nName\ngroup_by(dat_tg, supp)\n\n\nNumber of rows\n20\n\n\nNumber of columns\n2\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nnumeric\n1\n\n\n________________________\n\n\n\nGroup variables\nsupp\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nsupp\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\n\nlen\nOJ\n0\n1\n22.70\n3.91\n14.5\n20.30\n23.45\n25.65\n27.3\n▂▁▆▃▇\n\n\nlen\nVC\n0\n1\n16.77\n2.52\n13.6\n15.27\n16.50\n17.30\n22.5\n▇▇▇▁▂"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#assumptions-checking",
    "href": "Compare_means_independent_paried_samples.html#assumptions-checking",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "“assumptions checking”",
    "text": "“assumptions checking”\nLinear model assumptions\nMore details/descriptions can be found here:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model\nt-test assumptions are also described in (way too much) detail here: https://en.wikipedia.org/wiki/Student%27s_t-test#Assumptions\nThe most relevant are:\n\ndata are independent (e.g., not paired, grouped, or otherwise related by some other factor that the grouping variable already in your model), collected with a random sampling approach\nmodel residuals are normally distributed\nConstant/“equal” variance or homoskedasticity\nIn practical terms just check to make sure during exploratory analysis:\n\nthere are no “large” outliers\n\nthe distributions of each group are not highly skewed or bimodal (although this is often hard to judge at small sample sizes)\nLook at plots above (histogram, boxplot, individual value plot): Does the spread look similar in 2 samples?\n\n“equal” variances within each group (homoscedasticity)\n\n\nThis assumption says that all groups (samples) of data have “the same” variance (e.g., spread, sd), but in terms of checking it’s about making sure the standard deviations are not too different from each other.\n\nCan assess equal variance assumption with a “rule of thumb”:\n\n\nPrimary rule: (When n/group &gt; 5 & n/groups similar) Consider alternative approach if largest sd &gt; 4*smallest sd (i.e., variances not similar enough)\n\nSecondary Rule: (When n/group NOT similar) Be extra cautious when largest sd is associated with the group with the smallest n. In this case consider alternative approach if largest sd &gt; 2*smallest sd.\nsee Zar Biostatistical Analysis textbook for more info (and/or could cite in thesis/paper if necessary)\n\nIf there are large outliers, one/both of the distributions are very highly skewed, and/or the spread in the data is very different between groups, then can consider other options for calculating the 95% CIs (e.g., bootstrapping), using a Generalized linear model, and/or running a non-parametric test."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#calculate-relevant-descriptive-statistics-for-comparison-of-two-groups",
    "href": "Compare_means_independent_paried_samples.html#calculate-relevant-descriptive-statistics-for-comparison-of-two-groups",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Calculate Relevant Descriptive Statistics for comparison of two groups",
    "text": "Calculate Relevant Descriptive Statistics for comparison of two groups\nFor EACH GROUP (SAMPLE) of numerical response variable length we’ll calculate:\n\nmean: mean()\nstandard deviation (spread in data): sd()\nsample size: n()\n\n\ndat_tg |&gt;  \n  group_by(supp) |&gt;\n  summarise(mean_length = mean(len),\n            sd_length = sd(len),\n            n_length = n())\n\n# A tibble: 2 × 4\n  supp  mean_length sd_length n_length\n  &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;int&gt;\n1 OJ           22.7      3.91       10\n2 VC           16.8      2.52       10"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#magnitude-of-the-effect-size",
    "href": "Compare_means_independent_paried_samples.html#magnitude-of-the-effect-size",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Magnitude of the effect size",
    "text": "Magnitude of the effect size\nWe can then pull values from the calculated statistics above to make an additional calculation of the magnitude of the effect size (i.e., how different are the 2 means?)\n\neffect size (difference between the means)\neffect size as a percent difference (difference between the means/smaller mean * 100)\nNote: “Direction” of effect size in this instance refers to indicating which mean is larger.\n\n\n# effect size: mean OJ - mean VC\n22.7-16.8\n\n[1] 5.9\n\n# effect size expressed as percentage difference\n# use round() function to round to 0 decimal places\nround((22.7-16.8)/16.8*100, 0) \n\n[1] 35"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#fit-linear-model-then-create-coefficient-table",
    "href": "Compare_means_independent_paried_samples.html#fit-linear-model-then-create-coefficient-table",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Fit linear model, then create coefficient table",
    "text": "Fit linear model, then create coefficient table\nNote this code/process is adapted from: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#oneway\n\nIf you want more background, detailed explanation or need to do a more complicated analysis, that is a great resource.\n\nFit the linear model (numerical response w/ 1 categorical X value)\n\nin lm() formula:\n\nY ~ X\nResponse (numeric variable) ~ Explanatory (in this case a categorical variable)\n\n\n\n\nlm_len_supp &lt;- lm(len ~ supp, data = dat_tg)\n\nlm_len_supp\n\n\nCall:\nlm(formula = len ~ supp, data = dat_tg)\n\nCoefficients:\n(Intercept)       suppVC  \n      22.70        -5.93  \n\n\nCoefficient table\nCreate a “coefficient table” in a “tidy” table format using tidy() function from broom package, with a conf.int = T argument to include calculation of 95% CIs.\n\nNote: the coefficient table is not the most useful/friendly format and can include some irrelevant information. While it is a good idea to create and review it, but you will mostly use/interpret the emmeans and contrast (pairs) tables below.\n\n\n# use tidy function from broom package with the linear model object\nlm_len_supp_coef &lt;- tidy(lm_len_supp, conf.int = TRUE)\n\nlm_len_supp_coef\n\n# A tibble: 2 × 7\n  term        estimate std.error statistic  p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)    22.7       1.04     21.8  2.11e-14    20.5      24.9 \n2 suppVC         -5.93      1.47     -4.03 7.81e- 4    -9.02     -2.84"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#create-emmeans-table",
    "href": "Compare_means_independent_paried_samples.html#create-emmeans-table",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Create emmeans table",
    "text": "Create emmeans table\nUsing emmeans() function from the emmeans package\n\nProvides the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n& Lots of vignettes for other uses of functions in this package: https://cran.r-project.org/web/packages/emmeans/index.html\n\n\n# create emmeans table object\nlm_len_supp_emm &lt;- emmeans(lm_len_supp, ~ supp)\n\nlm_len_supp_emm\n\n supp emmean   SE df lower.CL upper.CL\n OJ     22.7 1.04 18     20.5     24.9\n VC     16.8 1.04 18     14.6     19.0\n\nConfidence level used: 0.95 \n\n\n\nThe means (emmean column) in the emmeans table are technically “modeled” means, but here, and for many linear models, these will be equal to the sampled means (the means calculated from each group of raw data). This may not be the case for some more complicated models.\n\nThe 95% CIs in the emmeans table (lower.CL to upper.CL) are calculated using all the data in the model (using a pooled standard deviation and sample size across both groups of data). You’ll notice they both have the same size:\n\nOJ: 20.5 to 24.9 = 4.4\nVC: 14.6 to 19.0 = 4.4\nIf 95% CIs were calculated using just the OJ (or VC) data for each mean individually they would be different sizes.\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#points-means-plot-w-model-95-cis",
    "href": "Compare_means_independent_paried_samples.html#points-means-plot-w-model-95-cis",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Points & means plot w/ (model) 95% CIs",
    "text": "Points & means plot w/ (model) 95% CIs\n\n# note in ggplot below we had to turn the emmeans object into a tibble (data.frame) so it would work as data in ggplot\n# as_tibble(lm_len_supp_emm)\n\nplot_lm_len_supp_emm &lt;- dat_tg |&gt;\n  ggplot(aes(x = supp, y = len, color = supp)) +\n  geom_jitter(width = 0.1) +\n  ylab(\"Length of Odontoblasts (μm)\") +\n  xlab(\"Supplement Type\") +\n  #use emm object as 2nd data table to plot 95% CIs\n  geom_crossbar(\n    data = as_tibble(lm_len_supp_emm),\n    aes(y = emmean,\n        ymin = lower.CL,\n        ymax = upper.CL),\n    width = 0.1\n  ) +\n  theme_classic() +\n  theme(legend.position = \"none\")\n\nplot_lm_len_supp_emm\n\n\n\n\nThis plot shows the raw data for each group (OJ, VC) as points. The geom_crossbar() plots the group means (middle line) and the 95% CIs from the associated linear model which were calculated in the emmeans table above.\n\nNote geom_pointrange() could be used instead of geom_crossbar() if you prefer that style of plotting mean + CIs https://ggplot2.tidyverse.org/reference/geom_linerange.html (scroll down to bottom of page to see various examples of ways to plot error bars around a mean)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#create-contrasts-table-corresponding-effects-plot",
    "href": "Compare_means_independent_paried_samples.html#create-contrasts-table-corresponding-effects-plot",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Create contrasts table & corresponding “effects” plot",
    "text": "Create contrasts table & corresponding “effects” plot\n“Contrasts table” using contrast() function from emmeans package\n\nFor details on the argument method = see help(“contrast-methods”)\n\n\nlm_len_supp_pairs &lt;- contrast(lm_len_supp_emm,\n                            method = \"pairwise\") |&gt; \n  summary(infer = TRUE)\n#Note: method = \"revpairwise\" switches the order in subtraction for comparison (up to researcher/you to determine which is more appropriate)\n\nlm_len_supp_pairs\n\n contrast estimate   SE df lower.CL upper.CL t.ratio p.value\n OJ - VC      5.93 1.47 18     2.84     9.02   4.033  0.0008\n\nConfidence level used: 0.95 \n\n\nThis table is important for reporting treatment effect and 95% CI and it lm_len_supp_pairs is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-value here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 0.08% chance that these data came from a true population where there was no difference between the 2 means.\n\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#effects-plot-w-95-ci",
    "href": "Compare_means_independent_paried_samples.html#effects-plot-w-95-ci",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Effects plot w/ 95% CI",
    "text": "Effects plot w/ 95% CI\n\n# NOTE: in ggplot code below we had to turn the contrast object into \n# a tibble (data.frame) so it would work as data in ggplot\n\nplot_lm_len_supp_pairs &lt;- as_tibble(lm_len_supp_pairs) |&gt;\n  ggplot(aes(y = contrast, x = estimate)) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (μm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic()\n\nplot_lm_len_supp_pairs\n\n\n\n\nThis plot shows the difference between the 2 means (OJ mean - VC mean = 5.9), and the 95% CI for that difference (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between OJ and VC to be between 2.8 and 9.0”).\n\nThe dashed line at 0 is there for reference since if the OJ and VC treatments produced the same tooth cell growth, the difference in their means would be 0."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure-save-it-export-it-as-a-.png-image-file",
    "href": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure-save-it-export-it-as-a-.png-image-file",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Combine plots into a single results figure & save it (export it) as a .png image file",
    "text": "Combine plots into a single results figure & save it (export it) as a .png image file\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure.\n\nThe align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\nresults_plot &lt;- plot_grid(plot_lm_len_supp_pairs, \n                          plot_lm_len_supp_emm, \n                          nrow = 2,\n                          align = \"v\",\n                          axis = \"rl\",\n                          rel_heights = c(0.25, 1)\n                          )\n# rel_heights argument specifies relative size of two plots (i.e., first plot is 0.25 as tall as the second plot) \n\nresults_plot\n\n\n\n\nThis primary results plot is adapted from code in (the version you are using is based on regular ggplot code): https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-6-plot-the-model"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#write-save-plot-to-a-.png-file-with-ggsave",
    "href": "Compare_means_independent_paried_samples.html#write-save-plot-to-a-.png-file-with-ggsave",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Write (save) plot to a .png file with ggsave()",
    "text": "Write (save) plot to a .png file with ggsave()\n\nthe file will be saved to your “working directory” (typically the folder where your .qmd file is). You’ll need to look in that folder to see the .png file!\nYou identify the type of file format you want to save it to with the file name extension at the end of the file name. Here we use .png (a great default for putting images into word docs or PPT presentations). But many others are available such as: “.pdf” (easy to view or email a .pdf to someone; and good to use for uploading plot files to journals if they’ll accept this format), “.eps” (another vector format some journals one), “.png”, “.jpeg”, “.tiff”, “.svg”(use for further editing in https://inkscape.org/ freeware on windows).\nYou can read more about the difference between vector vs. raster image file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885352. And more about specific file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885348\nYou specify the dimensions of the plot with the width = and height = arguments, default is inches. Try different widths and heights (keeping in mind what would fit on a 8in by 11in page size) and see what works for the plot you making. Often a plot shows the data better when it is taller or wider (so try different ratios of width to height).\nYou can also specify the image “quality” using the “dots per inch” argument dpi = and typically you want to use 300 or 600 for a high quality image. Depending on the file type (with .tiff for example) 600 dpi can sometimes create huge file sizes, but that is usually where I start (then only go down to 300 if needed).\nNOTE - sometimes you can get an error when running ggsave() repeatedly if the saved .png file is already open on your computer in your image viewer - need to close it each time you want to edit and re-output the image file.\n\n\n# output plot to .png file type, set size (default is inches), 300 or 600 dpi is high quality\nggsave(\"plot_len_by_supp_95CIs.png\", results_plot, \n       width = 4, \n       height = 4, \n       dpi = 600)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#results-sentence",
    "href": "Compare_means_independent_paried_samples.html#results-sentence",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Results sentence:",
    "text": "Results sentence:\nUsing statistics produced in the code chunks above we can write:\nMean length of odontoblasts that received vitamin C from orange juice (mean length: 22.7 μm, 95% CI: 20.5 to 24.9) was 35% higher (mean difference: 5.9 μm , 95% CI: 2.84 to 9.02, p = 0.0008) than those that received vitamin C from an ascorbic acid supplement (mean length: 16.8 μm, 95% CI: 14.6 to 19.0) (Fig. X).\nNote:\n\n(Fig. X) would be citing the combined results figure that includes (top) the effects plot and (below) plot w/ the data points, means and the 95% CIs for each group.\nYou can add the t-statistic and p-value (from the contrasts table) above or two-sample t-test output below, both are equivalent.\n\nMore explanation of why it is optional to (and advised by this author that you don’t) use the word “significant” in the results can be found here (but if you or your adviser want to, that is fine too, since p-value is &lt; 0.05) and examples of writing results can be found here: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-7-report-the-model-results"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#two-sample-t-test-hypothesis-test",
    "href": "Compare_means_independent_paried_samples.html#two-sample-t-test-hypothesis-test",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Two-sample t-test (hypothesis test)",
    "text": "Two-sample t-test (hypothesis test)\n\n# Review the help file for the t.test function, there are various options\n?t.test\n\nStatistical Hypotheses (for a two-sample t-test)\nNull Hypothesis: there is no difference (i.e., they are equal) in the population mean lengths of the guinea pigs that received vitamin C through orange juice and ascorbic acid supplements.\nAlternative Hypothesis: there is a difference (i.e., they are not equal) in the population mean lengths of the guinea pigs that received vitamin C through orange juice and ascorbic acid supplements.\n\nWelch’s t-test is default that the t.test() function in R runs\n\n\nWelch’s t-test does NOT assume equal variances (so you do not need to worry about that assumption of the regular/typical Student’s t-test)\n\nhttps://en.wikipedia.org/wiki/Welch%27s_t-test\nIt defines the statistic t slightly differently, unlike in Student’s t-test, the denominator is not based on a pooled variance estimate.\nIt is not recommended to pre-test for equal variances and then choose between Student’s t-test or Welch’s t-test [5]. Rather, Welch’s t-test can be applied directly and without any substantial disadvantages to Student’s t-test as noted above. Welch’s t-test remains robust for skewed distributions at large sample sizes.[6] Reliability decreases for skewed distributions and smaller samples.\n[5] Zimmerman, D. W. (2004). “A note on preliminary tests of equality of variances”. British Journal of Mathematical and Statistical Psychology. 57: 173–181.\n[6] Fagerland, M. W. (2012). “t-tests, non-parametric tests, and large studies—a paradox of statistical practice?”. BioMed Central Medical Research Methodology. 12: 78. doi:10.1186/1471-2288-12-78.\n\nUse a formula within t.test() and your data object with data = argument.\n\n\nresponse ~ explanatory (here: length as a function of supplement type)\nBy default it runs a two-tailed test.\n\n\n# run default arguments (two-tailed test and assume un-equal variances, with Welch's correction)\nt.test(len ~ supp, data = dat_tg)\n\n\n    Welch Two Sample t-test\n\ndata:  len by supp\nt = 4.0328, df = 15.358, p-value = 0.001038\nalternative hypothesis: true difference in means between group OJ and group VC is not equal to 0\n95 percent confidence interval:\n 2.802148 9.057852\nsample estimates:\nmean in group OJ mean in group VC \n           22.70            16.77 \n\n\nThis p-value is slightly larger than the one calculated in the contrasts table above because it is adjusted larger in this “Welch’s” t-test as part of the process of not needed to assume equal variances.\nAlso note: the 95% CI the t.test() function outputs is the 95% CI of the difference between the two means (i.e., the effect size): mean OJ - mean VC = 5.9 (95% CI: 2.8 to 9.1).\nIn words: if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference to be between 2.8 and 9.1 (length). Because this does not include 0, it by itself can be interpreted as a “significant result.”\nExtra: Use of broom package tidy() function w/ t.test()\n\nCan also wrap the tidy() function from broom package around the t.test, to get a “tidy” output with the same values organized in a data.frame\nCan be useful if you want to store the results and directly output values (like p-value or CIs etc.)\n\nhttps://cran.r-project.org/web/packages/broom/vignettes/broom.html\n\nt_test_len_supp &lt;- t.test(len ~ supp, data = dat_tg)\n\n# show results in \"tidy\" data.frame format (from broom package)\ntidy(t_test_len_supp)\n\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1     5.93      22.7      16.8      4.03 0.00104      15.4     2.80      9.06\n# ℹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;\n\n# select mean difference, 95%CIs and p-value\ntidy(t_test_len_supp) |&gt; \n  select(estimate, conf.low, conf.high, p.value)\n\n# A tibble: 1 × 4\n  estimate conf.low conf.high p.value\n     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1     5.93     2.80      9.06 0.00104"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#extra-use-of-broom-package-tidy-function-w-t.test",
    "href": "Compare_means_independent_paried_samples.html#extra-use-of-broom-package-tidy-function-w-t.test",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Extra: Use of broom package tidy() function w/ t.test()",
    "text": "Extra: Use of broom package tidy() function w/ t.test()\n\nCan also wrap the tidy() function from broom package around the t.test, to get a “tidy” output with the same values organized in a data.frame\nCan be useful if you want to store the results and directly output values (like p-value or CIs etc.)\n\nhttps://cran.r-project.org/web/packages/broom/vignettes/broom.html\n\nt_test_len_supp &lt;- t.test(len ~ supp, data = dat_tg)\n\n# show results in \"tidy\" data.frame format (from broom package)\ntidy(t_test_len_supp)\n\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1     5.93      22.7      16.8      4.03 0.00104      15.4     2.80      9.06\n# ℹ 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;\n\n# select mean difference, 95%CIs and p-value\ntidy(t_test_len_supp) |&gt; \n  select(estimate, conf.low, conf.high, p.value)\n\n# A tibble: 1 × 4\n  estimate conf.low conf.high p.value\n     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1     5.93     2.80      9.06 0.00104"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#convert-data-from-wide-to-long-format",
    "href": "Compare_means_independent_paried_samples.html#convert-data-from-wide-to-long-format",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Convert Data From “Wide” to “Long” Format",
    "text": "Convert Data From “Wide” to “Long” Format\nIf the data are in wide format, you’ll want to convert them to long format before proceeding with an analysis using tidyverse functions. These function (e.g., functions from ggplot2 and dplyr packages) always want data in a “tidy” format, which includes having the data in “long” format (one variable per column).\nWe can use the tidyr functions pivot_longer() and pivot_wider() to reformat data from wide to long, or from long to wide format.\nSee here for examples: https://tidyr.tidyverse.org/reference/pivot_longer.html\n\n## use pivot_longer function from dplyr to convert from wide to long data table format\ndat_paired &lt;- dat_paired_wide |&gt;\n  pivot_longer(cols = placebo:drug, \n               names_to = \"treatment\", values_to = \"cell_count\")\n# look at \"long\" format \n# i.e., what you always want your data to be if possible\n# and typcially need long format for plotting w/ ggplot\n# single variable in each colum\ndat_paired\n\n# A tibble: 18 × 3\n   patient_no treatment cell_count\n        &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;\n 1          1 placebo           78\n 2          1 drug              79\n 3          2 placebo           54\n 4          2 drug              48\n 5          3 placebo          142\n 6          3 drug              52\n 7          4 placebo           25\n 8          4 drug              15\n 9          5 placebo          101\n10          5 drug              61\n11          6 placebo           99\n12          6 drug             107\n13          7 placebo           94\n14          7 drug              77\n15          8 placebo          107\n16          8 drug              54\n17          9 placebo           64\n18          9 drug               5\n\n\nWhile in the long format it might be a little harder to see, but data are still “paired” by patient_no.\n\nuse glimpse() function to examine the structure of the data.frame named dat_yt\n\n\nglimpse(dat_paired)\n\nRows: 18\nColumns: 3\n$ patient_no &lt;int&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9\n$ treatment  &lt;chr&gt; \"placebo\", \"drug\", \"placebo\", \"drug\", \"placebo\", \"drug\", \"p…\n$ cell_count &lt;dbl&gt; 78, 79, 54, 48, 142, 52, 25, 15, 101, 61, 99, 107, 94, 77, …"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#use-factor-function-to-covert-numeric-or-character-to-a-factor",
    "href": "Compare_means_independent_paried_samples.html#use-factor-function-to-covert-numeric-or-character-to-a-factor",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Use factor() function to covert numeric or character to a factor",
    "text": "Use factor() function to covert numeric or character to a factor\n\nChange patient_no (which was by default set as numeric) to a factor since the numbers are just labels for each person, and could as easily been patient A, B, C… or their names used,\nChange count_type to a factor, with levels (to specify the order of the two levels: placebo, then drug for plotting). Otherwise it would default to alphabetical order, with drug before placebo. In this case there’s no right or wrong order, really up to researcher preference.\n\n\ndat_paired &lt;- dat_paired |&gt;\n  mutate(patient_no = factor(patient_no),\n         treatment = factor(treatment,\n                            levels = c(\"placebo\", \"drug\")))\n# look at the data again\nglimpse(dat_paired)\n\nRows: 18\nColumns: 3\n$ patient_no &lt;fct&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9\n$ treatment  &lt;fct&gt; placebo, drug, placebo, drug, placebo, drug, placebo, drug,…\n$ cell_count &lt;dbl&gt; 78, 79, 54, 48, 142, 52, 25, 15, 101, 61, 99, 107, 94, 77, …\n\n\nIn the glimpse output, you can see that patient_no and treatment are now factors."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#initial-exploratory-analysis-for-paired-data",
    "href": "Compare_means_independent_paried_samples.html#initial-exploratory-analysis-for-paired-data",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Initial Exploratory Analysis (for Paired Data)",
    "text": "Initial Exploratory Analysis (for Paired Data)\nExploratory Analysis of cell_count by treatment:\nRecognizing that these are paired data, we first want to see how much variability there was across individuals (for example, if some patients just had naturally higher or lower cell counts). Using a paired analysis design would then help us remove this additional variability due the to the patient, and better isolate just the effect of the drug.\nCreate an individual value plot\n\ncolor points by patient number (note for this to work, patient number must be a factor - converted in code chunk above)\nAdd lines connecting the pairs of points using the group = argument in within aes()in geom_line()\n\n\n\n# note in a code chunk above treatment and patient_no were \n# already converted to factors in a code chunk above, and \n# therefore ggplot treats them accordingly.\n\nplot_dat_paired &lt;-\n  ggplot(dat_paired, aes(x = treatment, y = cell_count,\n                         color = patient_no)) +\n  geom_point() +\n  geom_line(aes(group = patient_no)) +\n  ylab(\"Cell Count\") +\n  theme_classic()\n\n\nplot_dat_paired\n\n\n\n\n\nThe drug appears to have an effect, lower cell counts relative to the placebo, in most, but not all individuals. This effect varies from person to person (i.e., some cell counts decrease a lot, some very little or even increase slightly)\nThere is a lot of variability in overall cell counts among patients (ranging from 25 to over 125 for placebo, and similar for drug). This “patient-to-patient” variability is what we’ll try to account for (remove) by converting these data to differences since this is a paired experimental design."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#convert-paired-data-to-differences-between-pairs",
    "href": "Compare_means_independent_paried_samples.html#convert-paired-data-to-differences-between-pairs",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Convert Paired Data to Differences (between pairs)",
    "text": "Convert Paired Data to Differences (between pairs)\n\ncreate a new version the data table named dat_diff starting from dat_paired\n\nuse pivot_wider() to put each treatment in its own column\nthen mutate() to add a column named cell_count_diff which is the difference between the two treatments: drug - placebo\n\nNote: subtraction can be done in either order - BUT you always must know what the order is to properly interpret the differences (i.e., in this case a negative difference means the placebo value was larger than the drug value, so the drug lowered the cell counts)\n\n\n\n\n# convert from long to wide format, then subtract drug - placebo values \n# for each patient creating a new column named cell_count_diff\ndat_diff &lt;- dat_paired |&gt;\n  # select just columns you want to be involved in pivot\n  # don't include extra numeric data columns\n  select(patient_no, treatment, cell_count) |&gt;\n  pivot_wider(names_from = treatment,\n              values_from = cell_count) |&gt;\n  mutate(cell_count_diff = drug - placebo)\n\ndat_diff\n\n# A tibble: 9 × 4\n  patient_no placebo  drug cell_count_diff\n  &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;\n1 1               78    79               1\n2 2               54    48              -6\n3 3              142    52             -90\n4 4               25    15             -10\n5 5              101    61             -40\n6 6               99   107               8\n7 7               94    77             -17\n8 8              107    54             -53\n9 9               64     5             -59"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#exploratory-analysis-with-the-difference-values",
    "href": "Compare_means_independent_paried_samples.html#exploratory-analysis-with-the-difference-values",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Exploratory analysis with the difference values",
    "text": "Exploratory analysis with the difference values\nSince the primary data we’ll be using for the rest of the analysis is the differences (drug - placebo) we’ll do the regular exploratory analyses with the differences:\n\nIndividual Value Plot (Stripchart)\nHistogram\nBoxplot\nskim() descriptive statistics\n\nAnd a horizontal or vertical line is added to represent the 0 value we want to compare our data to (to be an effect one way or the other the mean difference needs to be higher or lower than 0)\n\n# Individual Value Plot (Stripchart)\n# add a horizontal line at 0\ndat_diff |&gt;\n  ggplot(aes(x = 1, y = cell_count_diff)) +\n  geom_jitter(width = 0.1) +\n  geom_hline(yintercept = 0, color = \"red\")\n\n\n\n# Histogram of cell_count_diff\ndat_diff |&gt;\n  ggplot(aes(x = cell_count_diff)) +\n  geom_histogram(bins = 8)  +\n  geom_vline(xintercept = 0, color = \"red\")\n\n\n\n# Boxplot of cell_count_diff\ndat_diff |&gt;\n  ggplot(aes(x = 1, y = cell_count_diff)) +\n  geom_boxplot() +\n  geom_hline(yintercept = 0, color = \"red\")\n\n\n\n# summary/descriptive statistics of cell_count_diff\ndat_diff |&gt;\n  skim(cell_count_diff)\n\n\nData summary\n\n\nName\ndat_diff\n\n\nNumber of rows\n9\n\n\nNumber of columns\n4\n\n\n_______________________\n\n\n\nColumn type frequency:\n\n\n\nnumeric\n1\n\n\n________________________\n\n\n\nGroup variables\nNone\n\n\n\nVariable type: numeric\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nskim_variable\nn_missing\ncomplete_rate\nmean\nsd\np0\np25\np50\np75\np100\nhist\n\n\ncell_count_diff\n0\n1\n-29.56\n32.82\n-90\n-53\n-17\n-6\n8\n▂▃▂▂▇\n\n\n\n\nMost values are below 0, indicating the drug lowered cell counts."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#assumptions-checking-1",
    "href": "Compare_means_independent_paried_samples.html#assumptions-checking-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "“assumptions checking”",
    "text": "“assumptions checking”\nMore details/descriptions can be found here:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model\nt-test assumptions are also described in (way too much) detail here: https://en.wikipedia.org/wiki/Student%27s_t-test#Assumptions\nThe most relevant are:\n\ndata DIFFERENCES are independent (e.g., the pairing/dependence was removed when we subtracted drug - placebo), collected with a random sampling approach\nmodel residuals are normally distributed\nBUT - WE DO NOT HAVE TO WORRY ABOUT: “equal” variance assumption (since there is only one column of data now that we’ve converted it to differences)\n\nIn practical terms just check to make sure during exploratory analysis:\n\nthere are no large outliers in the differences\n\nthe distribution of the differences is not highly skewed\n\nIf both of these are the case, then you can be confident in calculating 95% CI and using that as a basis for comparison. Note: these assumptions also apply to a paried and one-sample t-tests.\nIf there are large outliers or one the distribution is very highly skewed, then you could consider options for calculating the 95% CIs (e.g., bootstrapping), or using a Generalized Linear Model or running a non-parametric test procedure."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#calculate-relevant-descriptive-statistics-with-the-difference-values",
    "href": "Compare_means_independent_paried_samples.html#calculate-relevant-descriptive-statistics-with-the-difference-values",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Calculate relevant descriptive statistics with the difference values\n",
    "text": "Calculate relevant descriptive statistics with the difference values\n\nRemember - if the average difference in near 0 then the drug had no/minimal effect\nFor the numerical response variable cell_count_diff we’ll calculate:\n\n\nmean: mean()\n\n\nstandard deviation (spread in data): sd()\n\n\nsample size: n()\n\n\n\ndat_diff |&gt;\n  summarise(mean_count_diff = mean(cell_count_diff),\n            sd_count_diff = sd(cell_count_diff),\n            n_count_diff = n())\n\n# A tibble: 1 × 3\n  mean_count_diff sd_count_diff n_count_diff\n            &lt;dbl&gt;         &lt;dbl&gt;        &lt;int&gt;\n1           -29.6          32.8            9\n\n\nFit linear model\n\n\nin lm() formula:\n\nY ~ X\nResponse (numeric variable) ~ Explanatory (in this case we just put ~1 because there is no categorical explanatory variable after we converted the data to differences)\n\n\n\n\nlm_cell_diff &lt;- lm(cell_count_diff ~ 1, data = dat_diff)\nlm_cell_diff\n\n\nCall:\nlm(formula = cell_count_diff ~ 1, data = dat_diff)\n\nCoefficients:\n(Intercept)  \n     -29.56  \n\n\nCoefficient table\nCreate a “coefficient table” in a “tidy” table format using tidy() function from broom package, with a conf.int = T argument to include calculation of 95% CIs.\n\n\nNote: often the coefficient table for a linear model is not the most useful/friendly format and can include some irrelevant information. However, in this simplified case of a single mean of the differences (estimate column) the 95% CIs produced are the same as those in the emmeans table below.\nThe p-value here can also be reported in your results - it is for the significance test: is the mean of the differences significantly different from 0\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the paired cell counts?\n\nAnd interpret it as a %: There is only a 2.7% chance that these data came from a true population where there was no difference between paired cell counts.\n\n\n\n\n\n# use tidy function from broom package with the linear model object\nlm_len_supp_coef &lt;- tidy(lm_cell_diff, conf.int = TRUE)\n\nlm_len_supp_coef\n\n# A tibble: 1 × 7\n  term        estimate std.error statistic p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)    -29.6      10.9     -2.70  0.0270    -54.8     -4.33\n\n\nCreate emmeans table\nUsing emmeans() function from the emmeans package\n\nProvides the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n& Lots of vignettes for other uses of functions in this package: https://cran.r-project.org/web/packages/emmeans/index.html\n\n\n# create emmeans table object\nlm_cell_diff_emm &lt;- emmeans(lm_cell_diff, ~ 1)\n\nlm_cell_diff_emm\n\n 1       emmean   SE df lower.CL upper.CL\n overall  -29.6 10.9  8    -54.8    -4.33\n\nConfidence level used: 0.95 \n\n\nThe drug lowered cell counts by an average of 29.6 relative to the placebo. 95% CIs are from -54.8 to -4.3 (i.e., if we repeated the experiment, 95% of the time the true mean would be in this interval). At the same time this 95% CI is pretty wide, which is to be expected with only 9 individuals in the study and a decent about of patient to patient variability in cell count differences (including a couple cases that had 0 or positive count differences).\n\n\nThe mean (emmean column) in the emmeans table is technically a “modeled” mean, but here, and for many linear models, these will be equal to the sampled mean (the mean of the differences calculated we calcualted from the data above). This may not be the case for some more complicated models.\n\nThe 95% CIs in the emmeans table (lower.CL to upper.CL) are calculated using all the data in the model (using a pooled standard deviation and sample size across both groups of data). However, in this case there is only one group of data so the 95% CIs here are the same as the one in the coefficient table above.\n\nNOTE: we will NOT make a “Contrasts Table” here because there is only one mean (and we are comparing that to 0). In the tooth cell length analysis above we had 2 means to compare and the contrasts table reports the difference between those 2 means and the 95% CI of that difference.\nPoints & Mean plot w/ (model) 95% CIs\n\n# note in ggplot below we had to turn the emmeans object into a tibble (data.frame) so it would work as data in ggplot\n\nplot_lm_cell_diff_emm &lt;- dat_diff |&gt;\n  ggplot(aes(x = cell_count_diff, y = 1)) +\n  #use emm object as 2nd data table to plot 95% CIs\n  geom_crossbar(data = as_tibble(lm_cell_diff_emm),\n                aes(x = emmean,\n                    xmin = lower.CL,\n                    xmax = upper.CL)) +\n  xlab(\"Difference in cell counts with drug\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  #remove y-axis elements\n  theme(\n    axis.title.y = element_blank(),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank()\n  ) +\n  geom_vline(xintercept = 0,\n             color = \"red\",\n             linewidth = 1.5) +\n  geom_point(size = 3, alpha = 0.4)\n\n# The alpha argument in geom_point makes the points transparent so if they overlapped you should be able to see both overlapping points.\n\nplot_lm_cell_diff_emm\n\n\n\n\nThe mean (drug - placebo) difference was -29.6 (thicker vertical line). And the 95% CIs are from -54.8 to -4.3 (i.e., if we repeated the experiment, 95% of the time the true mean would be in this interval). At the same time this 95% CI is pretty wide, which is to be expected with only 9 individuals in the study and a decent about of patient to patient variability in cell count differences (including a couple cases that had 0 or positive count differences).\n\nThe Think red line at 0 is there for reference since if both the placebo and drug treatments had the same (or no) effect on patent cell counts, the difference between them would be 0.\n\nNote: geom_pointrange() could be used instead of geom_crossbar() if you prefer that style of plotting mean + CIs https://ggplot2.tidyverse.org/reference/geom_linerange.html (scroll down to bottom of page to see various error bar plotting examples)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure-save-it-export-it-as-a-.png-image-file-1",
    "href": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure-save-it-export-it-as-a-.png-image-file-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Combine plots into a single results figure & save it (export it) as a .png image file",
    "text": "Combine plots into a single results figure & save it (export it) as a .png image file\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure\n\nThe align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\n# We will combine the plot of the differences w/ 95% CI with\n# the initial plot we made the connects each placebo & drug point with a line\nresults_plot &lt;- plot_grid(plot_lm_cell_diff_emm,\n                          plot_dat_paired,\n                          nrow = 2,\n                          align = \"v\",\n                          axis = \"rl\",\n                          rel_heights = c(0.25, 1)\n                          )\n# rel_heights argument specifies relative size of two plots (i.e., first plot is 0.25 as tall as the second plot)\nresults_plot"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#write-save-plot-to-a-.png-file-with-ggsave-1",
    "href": "Compare_means_independent_paried_samples.html#write-save-plot-to-a-.png-file-with-ggsave-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Write (save) plot to a .png file with ggsave()",
    "text": "Write (save) plot to a .png file with ggsave()\n\nthe file will be saved to your “working directory” (typically the folder where your .qmd file is). You’ll need to look in that folder to see the .png file!\nYou identify the type of file format you want to save it to with the file name extension at the end of the file name. Here we use .png (a great default for putting images into word docs or PPT presentations). But many others are available such as: “.pdf” (easy to view or email a .pdf to someone; and good to use for uploading plot files to journals if they’ll accept this format), “.eps” (another vector format some journals one), “.png”, “.jpeg”, “.tiff”, “.svg”(use for further editing in https://inkscape.org/ freeware on windows).\nYou can read more about the difference between vector vs. raster image file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885352. And more about specific file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885348\nYou specify the dimensions of the plot with the width = and height = arguments, default is inches. Try different widths and heights (keeping in mind what would fit on a 8in by 11in page size) and see what works for the plot you making. Often a plot shows the data better when it is taller or wider (so try different ratios of width to height).\nYou can also specify the image “quality” using the “dots per inch” argument dpi = and typically you want to use 300 or 600 for a high quality image. Depending on the file type (with .tiff for example) 600 dpi can sometimes create huge file sizes, but that is usually where I start (then only go down to 300 if needed).\nNOTE - sometimes you can get an error when running ggsave() repeatedly if the saved .png file is already open on your computer in your image viewer - need to close it each time you want to edit and re-output the image file.\n\n\n# output plot to .png file type, set size (default is inches), 300 or 600 dpi is high quality\nggsave(\"plot_cell_diff_95CIs.png\", results_plot, \n       width = 4, \n       height = 4, \n       dpi = 600)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#results-sentence-1",
    "href": "Compare_means_independent_paried_samples.html#results-sentence-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Results sentence",
    "text": "Results sentence\n\nYou should include both the magnitude (effect size) and direction of difference\nFocus on the biology and do not make a statistical result the subject of the sentence.\n\nThe drug decreased cell counts by an average of 29.6 cells (95% CI: 4.3 to 54.8, p = 0.027) compared to taking a placebo (Fig. X).\n\nFigure X would be combined results plot above with effects plot on top (w/ 95% CI of mean differences) and plot witht he original data points on the bottom.\nthe p-value could be found in the contrasts table above or in the t-test outputs below.\n\nMore explanation of why it is optional to (and why this author advises you don’t need to) use the word “significant” in the results can be found here (but if you or your adviser want to, that is fine too, since p-value is &lt; 0.05) and other examples of writing results can be found here: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-7-report-the-model-results"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#paired-sample-t-test-or-one-sample-t-test-w-mu-0",
    "href": "Compare_means_independent_paried_samples.html#paired-sample-t-test-or-one-sample-t-test-w-mu-0",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Paired-Sample t-test (or one-sample t-test w/ mu = 0)",
    "text": "Paired-Sample t-test (or one-sample t-test w/ mu = 0)\nStatistical Hypotheses (for a Paired-Sample t-test)\nNull Hypothesis: mean of the differences in the population is equal to 0\nAlternative Hypothesis: mean of the differences in the population is NOT equal to 0\n\nThere are two ways to specify a paired-t-test using the t.test() function both yield the same results.\n(my preferred method) Calculate the differences, then run a one-sample t-test with the constant = 0 (that you are comparing the mean of the differences to):\n\n\ndifferences_variable ~ 1 (use 1 since there is no explanatory variable)\nthen set the a prior constant to 0 with argument mu = 0\n\n\n\n# using differences data table, run as one-sample t-test compared to 0\nt.test(cell_count_diff ~ 1, mu=0, data = dat_diff)\n\n\n    One Sample t-test\n\ndata:  cell_count_diff\nt = -2.7014, df = 8, p-value = 0.02701\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n -54.784709  -4.326402\nsample estimates:\nmean of x \n-29.55556 \n\n\nOr w/ Paired Data:\n\nspecify with formula: response ~ explanatory\nthen add argument paired = TRUE (which then has the t.test function calculate the differences for you)\n\nNOTE - DATA MUST BE SORTED so each pair is in the same order by explanatory variable, here data was entered that way, but you could use the dplyr function arrange() to sort rows if necessary https://dplyr.tidyverse.org/reference/arrange.html\n\n\n\n# using paired data table, run as actual paired-sample t-test\nt.test(cell_count~treatment, data = dat_paired, paired = TRUE)\n\n\n    Paired t-test\n\ndata:  cell_count by treatment\nt = 2.7014, df = 8, p-value = 0.02701\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n  4.326402 54.784709\nsample estimates:\nmean difference \n       29.55556 \n\n\nBoth methods yield identical results, with the exception of sign differences (negative/positive) on the mean difference and t-statistic values (which just depends on the order of the pairs in the data set when the differences are calculated), so just keep track of what is being subtracted from what.\n\nExtra: Use of broom package tidy() function w/ t.test()\n\nCan also wrap the tidy() function from broom package around the t.test, to get a “tidy” output with the same values organized in a data.frame\nCan be useful if you want to store the results and directly output values (like p-value or CIs etc.)\n\nhttps://cran.r-project.org/web/packages/broom/vignettes/broom.html\n\nt_test_cell_diff &lt;- t.test(cell_count_diff ~ 1, mu=0, data = dat_diff)\n\n# show results in \"tidy\" data.frame format (from broom package)\ntidy(t_test_cell_diff)\n\n# A tibble: 1 × 8\n  estimate statistic p.value parameter conf.low conf.high method     alternative\n     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      \n1    -29.6     -2.70  0.0270         8    -54.8     -4.33 One Sampl… two.sided  \n\n# select mean difference, 95%CIs and p-value\ntidy(t_test_cell_diff) |&gt; \n  select(estimate, conf.low, conf.high, p.value)\n\n# A tibble: 1 × 4\n  estimate conf.low conf.high p.value\n     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1    -29.6    -54.8     -4.33  0.0270"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#results-sentence-based-on-t-test-results",
    "href": "Compare_means_independent_paried_samples.html#results-sentence-based-on-t-test-results",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Results sentence (based on t-test results)",
    "text": "Results sentence (based on t-test results)\nUsing statistics produced in t-test output and potentially additional code chunks above, we can write the results in multiple ways (depending on what the researcher wants to emphasize):\n\ninclude both the magnitude (effect size) and direction of difference\nreport name of test and relevant statistics in parentheses at end of sentence (don’t make the test the subject of the sentence).\n\nThe drug decreased cell counts by an average of 29.6 cells (95% CI: 4.3 to 54.8) compared to receiving a placebo (paired-sample t-test, t8 = 2.7, p = 0.027, Fig. X)\nNote:\n\n(Fig. X) would be citing a results figure (plot) that included the data, the mean and the 95% CI (even if you are going to run a t-test, still show the 95% CI).\nIncluding “significant” is optional, as that can already be seen by interpreting the p-value in the parentheses at the end of the sentence."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#linear-model-w-a-categorical-x-explanatory-variable-comparing-means-of-2-independent-samples",
    "href": "Compare_means_independent_paried_samples.html#linear-model-w-a-categorical-x-explanatory-variable-comparing-means-of-2-independent-samples",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Linear model w/ a categorical X (explanatory) variable (comparing means of 2 independent samples)",
    "text": "Linear model w/ a categorical X (explanatory) variable (comparing means of 2 independent samples)\nFor this analysis we’ll use one of the data sets built into R:\nToothGrowth (The Effect of Vitamin C on Tooth Growth in Guinea Pigs)\nFrom: Crampton, E. W. (1947). The growth of the odontoblast of the incisor teeth as a criterion of vitamin C intake of the guinea pig. The Journal of Nutrition, 33(5), 491-504. doi: https://academic.oup.com/jn/article-abstract/33/5/491/4726758.\nNote: R has many built-in data sets and a list of them can be viewed with the data() function\nIn the ToothGrowth data set the response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\n\n#Each built in data set has a help file that can be viewed:\n?ToothGrowth\n\n#View the structure of the full data set:\nglimpse(ToothGrowth)\n\nRows: 60\nColumns: 3\n$ len  &lt;dbl&gt; 4.2, 11.5, 7.3, 5.8, 6.4, 10.0, 11.2, 11.2, 5.2, 7.0, 16.5, 16.5,…\n$ supp &lt;fct&gt; VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, V…\n$ dose &lt;dbl&gt; 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, …\n\n\nWhile the full data set has 1 numeric response (len) and 2 categorical explanatory variables (Supplement Type and Dose) we are going to reduce the data set to only one explanatory variable (supp: Supplement Type) with 2 levels (OJ: Orange Juice; VC: Ascorbic Acid) by filtering the data to select only guinea pigs that received a dose == 1\n\ndat_tg &lt;- ToothGrowth |&gt; \n  filter(dose == 1) |&gt;\n  select(len, supp)\n\nglimpse(dat_tg)\n\nRows: 20\nColumns: 2\n$ len  &lt;dbl&gt; 16.5, 16.5, 15.2, 17.3, 22.5, 17.3, 13.6, 14.5, 18.8, 15.5, 19.7,…\n$ supp &lt;fct&gt; VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, OJ, OJ, OJ, OJ, OJ, OJ, O…\n\n\nBiological Question: Does supplement type of vitamin C have an effect on length of odontoblasts (cells responsible for tooth growth) in guinea pigs? (when given a dose level of 1 mg/day)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#checking-assumptions",
    "href": "Compare_means_independent_paried_samples.html#checking-assumptions",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Checking assumptions",
    "text": "Checking assumptions\nLinear model assumptions:\nMore details/descriptions can be found here:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model\nt-test assumptions are also described in (way too much) detail here: https://en.wikipedia.org/wiki/Student%27s_t-test#Assumptions\nThe most relevant are:\n\ndata are independent (e.g., not paired, grouped, or otherwise related by some other factor that the grouping variable already in your model), collected with a random sampling approach\nmodel residuals are normally distributed\nConstant or “equal” variance or homoskedasticity\n\nIn practical terms just check to make sure during exploratory analysis:\n\nthere are no “large” outliers\n\nthe distributions of each group are not highly skewed or bimodal (although this is often hard to judge at small sample sizes)\nCheck for “equal” variances among groups (homoscedasticity)\n\n\n\nThis assumption says that all groups (samples) of data have “the same” variance (e.g., spread, sd), but in terms of checking it’s about making sure the standard deviations are not too different from each other.\n\nFirst look at plots above (histogram, boxplot, individual value plot): Does the spread look similar in 2 samples?\nThen assess equal variance assumption with a “rule of thumb”:\n\n\nPrimary rule: (When n/group &gt; 5 & n/groups similar) Consider alternative approach if largest sd &gt; 4*smallest sd (i.e., variances not similar enough)\n\nSecondary Rule: (When n/group NOT similar) Be extra cautious when largest sd is associated with the group with the smallest n. In this case consider alternative approach if largest sd &gt; 2*smallest sd.\nsee Zar Biostatistical Analysis textbook for more info (and/or could cite in thesis/paper if necessary)\n\nIf there are large outliers, one/both of the distributions are very highly skewed, and/or the spread in the data is very different between groups, then can consider other options for calculating the 95% CIs (e.g., bootstrapping), using a Generalized linear model, and/or running a non-parametric test."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#descriptive-statistics-for-comparing-two-groups",
    "href": "Compare_means_independent_paried_samples.html#descriptive-statistics-for-comparing-two-groups",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Descriptive Statistics for comparing two groups",
    "text": "Descriptive Statistics for comparing two groups\nFor EACH GROUP (SAMPLE) of numerical response variable length we’ll calculate:\n\nmean: mean()\nstandard deviation (spread in data): sd()\nsample size: n()\n\n\ndat_tg |&gt;\n  group_by(supp) |&gt;\n  summarise(\n    mean_length = mean(len),\n    sd_length = sd(len),\n    n_length = n()\n  )\n\n# A tibble: 2 × 4\n  supp  mean_length sd_length n_length\n  &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;int&gt;\n1 OJ           22.7      3.91       10\n2 VC           16.8      2.52       10"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#fit-linear-model",
    "href": "Compare_means_independent_paried_samples.html#fit-linear-model",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Fit linear model",
    "text": "Fit linear model\nNote this code/process is adapted from: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#oneway\n\nIf you want more background, detailed explanation or need to do a more complicated analysis, that is a great resource.\n\nFit the linear model (numerical response w/ 1 categorical X value)\n\nin lm() formula:\n\nY ~ X\nResponse (numeric variable) ~ Explanatory (in this case a categorical variable)\n\n\n\n\nlm_len_supp &lt;- lm(len ~ supp, data = dat_tg)\n\nlm_len_supp\n\n\nCall:\nlm(formula = len ~ supp, data = dat_tg)\n\nCoefficients:\n(Intercept)       suppVC  \n      22.70        -5.93  \n\n\nCoefficient table\nCreate a “coefficient table” in a “tidy” table format using tidy() function from broom package, with a conf.int = T argument to include calculation of 95% CIs.\n\nNote: the coefficient table is not the most useful/friendly format and can include some irrelevant information. While it is a good idea to create and review it, you will mostly use/interpret the emmeans and contrast (pairs) tables below.\n\n\n# use tidy function from broom package with the linear model object\nlm_len_supp_coef &lt;- tidy(lm_len_supp, conf.int = TRUE)\n\nlm_len_supp_coef\n\n# A tibble: 2 × 7\n  term        estimate std.error statistic  p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)    22.7       1.04     21.8  2.11e-14    20.5      24.9 \n2 suppVC         -5.93      1.47     -4.03 7.81e- 4    -9.02     -2.84"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#contrasts-table-corresponding-effects-plot",
    "href": "Compare_means_independent_paried_samples.html#contrasts-table-corresponding-effects-plot",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Contrasts table & corresponding “effects” plot",
    "text": "Contrasts table & corresponding “effects” plot\n“Contrasts table” using contrast() function from emmeans package\n\nFor details on the argument method = see help(“contrast-methods”)\n\n\nlm_len_supp_pairs &lt;- contrast(lm_len_supp_emm,\n                            method = \"pairwise\") |&gt; \n  summary(infer = TRUE)\n# Note: method = \"revpairwise\" switches the order in subtraction for comparison \n# (up to researcher/you to determine which is more appropriate)\n\nlm_len_supp_pairs\n\n contrast estimate   SE df lower.CL upper.CL t.ratio p.value\n OJ - VC      5.93 1.47 18     2.84     9.02   4.033  0.0008\n\nConfidence level used: 0.95 \n\n\nThis table is important for reporting treatment effect and 95% CI and the object lm_len_supp_pairs is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-value here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 0.08% chance that these data came from a true population where there was no difference between the 2 means.\n\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure",
    "href": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Combine plots into a single results figure",
    "text": "Combine plots into a single results figure\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure.\n\nThe align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\nresults_plot &lt;- plot_grid(plot_lm_len_supp_pairs, \n                          plot_lm_len_supp_emm, \n                          nrow = 2,\n                          align = \"v\",\n                          axis = \"rl\",\n                          rel_heights = c(0.25, 1)\n                          )\n# rel_heights argument specifies relative size of two plots (i.e., first plot is 0.25 as tall as the second plot) \n\nresults_plot\n\n\n\n\nThis primary results plot is adapted from code in (the version you are using is based on regular ggplot code): https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-6-plot-the-model"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#export-save-plot-to-a-.png-file-with-ggsave",
    "href": "Compare_means_independent_paried_samples.html#export-save-plot-to-a-.png-file-with-ggsave",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Export (save) plot to a .png file with ggsave()",
    "text": "Export (save) plot to a .png file with ggsave()\n\nthe file will be saved to your “working directory” (typically the folder where your .qmd file is). You’ll need to look in that folder to see the .png file\nYou identify the type of file format you want to save it to with the file name extension at the end of the file name. Here we use .png (a great default for putting images into word docs or PPT presentations). But many others are available such as: “.pdf” (easy to view or email a .pdf to someone; and good to use for uploading plot files to journals if they’ll accept this format), “.eps” (another vector format some journals one), “.png”, “.jpeg”, “.tiff”, “.svg”(use for further editing in https://inkscape.org/ freeware on windows).\nYou can read more about the difference between vector vs. raster image file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885352. And more about specific file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885348\nYou specify the dimensions of the plot with the width = and height = arguments, default is inches. Try different widths and heights (keeping in mind what would fit on a 8in by 11in page size) and see what works for the plot you making. Often a plot shows the data better when it is taller or wider (so try different ratios of width to height).\nYou can also specify the image “quality” using the “dots per inch” argument dpi = and typically you want to use 300 or 600 for a high quality image. Depending on the file type (with .tiff for example) 600 dpi can sometimes create huge file sizes, but that is usually where I start (then only go down to 300 if needed).\nNOTE - sometimes you can get an error when running ggsave() repeatedly if the saved .png file is already open on your computer in your image viewer - need to close it each time you want to edit and re-output the image file.\n\n\n# output plot to .png file type, set size (default is inches), 300 or 600 dpi is high quality\nggsave(\n  \"plot_len_by_supp_95CIs.png\",\n  results_plot,\n  width = 4,\n  height = 4,\n  dpi = 600\n)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#checking-assumptions-1",
    "href": "Compare_means_independent_paried_samples.html#checking-assumptions-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Checking assumptions",
    "text": "Checking assumptions\nMore details/descriptions can be found here:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model\nt-test assumptions are also described in (way too much) detail here: https://en.wikipedia.org/wiki/Student%27s_t-test#Assumptions\nThe most relevant are:\n\ndata DIFFERENCES are independent (e.g., the pairing/dependence was removed when we subtracted drug - placebo), collected with a random sampling approach\nmodel residuals are normally distributed\nBUT - WE DO NOT HAVE TO WORRY ABOUT: “equal” variance assumption (since there is only one column of data now that we’ve converted it to differences)\n\nIn practical terms just check to make sure during exploratory analysis:\n\nthere are no large outliers in the differences\n\nthe distribution of the differences is not highly skewed\n\nIf both of these are the case, then you can be confident in calculating 95% CI and using that as a basis for comparison. Note: these assumptions also apply to a paired and one-sample t-tests.\nIf there are large outliers or one the distribution is very highly skewed, then you could consider options for calculating the 95% CIs (e.g., bootstrapping), or using a Generalized Linear Model or running a non-parametric test procedure."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#descriptive-statistics-of-the-difference-values",
    "href": "Compare_means_independent_paried_samples.html#descriptive-statistics-of-the-difference-values",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Descriptive statistics of the difference values",
    "text": "Descriptive statistics of the difference values\nRemember - if the average difference in near 0 then the drug had no/minimal effect\nFor the numerical response variable cell_count_diff we’ll calculate:\n\n\nmean: mean()\n\n\nstandard deviation (spread in data): sd()\n\n\nsample size: n()\n\n\n\ndat_diff |&gt;\n  summarise(mean_count_diff = mean(cell_count_diff),\n            sd_count_diff = sd(cell_count_diff),\n            n_count_diff = n())\n\n# A tibble: 1 × 3\n  mean_count_diff sd_count_diff n_count_diff\n            &lt;dbl&gt;         &lt;dbl&gt;        &lt;int&gt;\n1           -29.6          32.8            9"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#fit-linear-model-1",
    "href": "Compare_means_independent_paried_samples.html#fit-linear-model-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Fit linear model",
    "text": "Fit linear model\n\n\nin lm() formula:\n\nY ~ X\nResponse (numeric variable) ~ Explanatory (in this case we just put ~1 because there is no categorical explanatory variable after we converted the data to differences)\n\n\n\n\nlm_cell_diff &lt;- lm(cell_count_diff ~ 1, data = dat_diff)\nlm_cell_diff\n\n\nCall:\nlm(formula = cell_count_diff ~ 1, data = dat_diff)\n\nCoefficients:\n(Intercept)  \n     -29.56  \n\n\nCoefficient table\nCreate a “coefficient table” in a “tidy” table format using tidy() function from broom package, with a conf.int = T argument to include calculation of 95% CIs.\n\n\nNote: often the coefficient table for a linear model is not the most useful/friendly format and can include some irrelevant information. However, in this simplified case of a single mean of the differences (estimate column) the 95% CIs produced are the same as those in the emmeans table below.\nThe p-value here can also be reported in your results - it is for the significance test: Is the mean of the differences significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the paired cell counts?\n\nAnd interpret it as a %: There is only a 2.7% chance that these data came from a true population where there was no difference between paired cell counts.\n\n\n\n\n\n# use tidy function from broom package with the linear model object\nlm_len_supp_coef &lt;- tidy(lm_cell_diff, conf.int = TRUE)\n\nlm_len_supp_coef\n\n# A tibble: 1 × 7\n  term        estimate std.error statistic p.value conf.low conf.high\n  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)    -29.6      10.9     -2.70  0.0270    -54.8     -4.33"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#create-emmeans-table-1",
    "href": "Compare_means_independent_paried_samples.html#create-emmeans-table-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Create emmeans table",
    "text": "Create emmeans table\nUsing emmeans() function from the emmeans package\n\nProvides the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n& Lots of vignettes for other uses of functions in this package: https://cran.r-project.org/web/packages/emmeans/index.html\n\n\n# create emmeans table object\nlm_cell_diff_emm &lt;- emmeans(lm_cell_diff, ~ 1)\n\nlm_cell_diff_emm\n\n 1       emmean   SE df lower.CL upper.CL\n overall  -29.6 10.9  8    -54.8    -4.33\n\nConfidence level used: 0.95 \n\n\nThe drug lowered cell counts by an average of 29.6 cells relative to the placebo. 95% CIs are from -54.8 to -4.3 (i.e., if we repeated the experiment, 95% of the time the true mean would be in this interval). At the same time this 95% CI is pretty wide, which is to be expected with only 9 individuals in the study and a decent about of “patient-to-patient” variability in cell count differences (including a couple cases that had 0 or positive count differences).\n\n\nThe mean (emmean column) in the emmeans table is technically a “modeled” mean, but here, and for many linear models, these will be equal to the sampled mean (the mean of the differences calculated we calcualted from the data above). This may not be the case for some more complicated models.\n\nThe 95% CIs in the emmeans table (lower.CL to upper.CL) are calculated using all the data in the model (using a pooled standard deviation and sample size across both groups of data). However, in this case there is only one group of data so the 95% CIs here are the same as the one in the coefficient table above.\n\nNOTE: we will NOT make a “Contrasts Table” here because there is only one mean (and we are comparing that to 0). In the tooth cell length analysis above we had 2 means to compare and the contrasts table reports the difference between those 2 means and the 95% CI of that difference."
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#points-mean-plot-w-model-95-cis",
    "href": "Compare_means_independent_paried_samples.html#points-mean-plot-w-model-95-cis",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Points & Mean plot w/ (model) 95% CIs",
    "text": "Points & Mean plot w/ (model) 95% CIs\n\n# NOTE in ggplot code below we had to turn the emmeans object into \n# a tibble (data.frame) so it would work as data in ggplot\nplot_lm_cell_diff_emm &lt;- dat_diff |&gt;\n  ggplot(aes(x = cell_count_diff, y = 1)) +\n  #use emm object as 2nd data table to plot 95% CIs\n  geom_crossbar(data = as_tibble(lm_cell_diff_emm),\n                aes(x = emmean,\n                    xmin = lower.CL,\n                    xmax = upper.CL)) +\n  xlab(\"Difference in cell counts with drug\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  #remove y-axis elements\n  theme(\n    axis.title.y = element_blank(),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank()\n  ) +\n  geom_vline(xintercept = 0,\n             color = \"red\",\n             linewidth = 1.5) +\n  geom_point(size = 3, alpha = 0.4)\n\n# The alpha argument in geom_point makes the points transparent so \n# if they overlapped you should be able to see both overlapping points.\n\nplot_lm_cell_diff_emm\n\n\n\n\nThe mean (drug - placebo) difference was -29.6 (thicker vertical line). And the 95% CIs are from -54.8 to -4.3 (i.e., if we repeated the experiment, 95% of the time the true mean would be in this interval). At the same time this 95% CI is pretty wide, which is to be expected with only 9 individuals in the study and a decent about of patient to patient variability in cell count differences (including a couple cases that had 0 or positive count differences).\n\nThe thick red line at 0 is there for reference since if both the placebo and drug treatments had the same (or no) effect on patent cell counts, the difference between them would be 0.\n\nNote: geom_pointrange() could be used instead of geom_crossbar() if you prefer that style of plotting a mean with 95% CIs https://ggplot2.tidyverse.org/reference/geom_linerange.html (scroll down to bottom of page to see various examples of ways to plot error bars around a mean)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure-1",
    "href": "Compare_means_independent_paried_samples.html#combine-plots-into-a-single-results-figure-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Combine plots into a single results figure",
    "text": "Combine plots into a single results figure\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure\n\nThe align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\n# We will combine the plot of the differences w/ 95% CI with\n# the initial plot we made the connects each placebo & drug point with a line\nresults_plot &lt;- plot_grid(\n  plot_lm_cell_diff_emm,\n  plot_dat_paired,\n  nrow = 2,\n  align = \"v\",\n  axis = \"rl\",\n  rel_heights = c(0.25, 1)\n)\n# rel_heights argument specifies relative size of two \n# plots (i.e., first plot is 0.25 as tall as the second plot)\n\nresults_plot"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#export-save-plot-to-a-.png-file-with-ggsave-1",
    "href": "Compare_means_independent_paried_samples.html#export-save-plot-to-a-.png-file-with-ggsave-1",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Export (save) plot to a .png file with ggsave()",
    "text": "Export (save) plot to a .png file with ggsave()\n\nthe file will be saved to your “working directory” (typically the folder where your .qmd file is). You’ll need to look in that folder to see the .png file!\nYou identify the type of file format you want to save it to with the file name extension at the end of the file name. Here we use .png (a great default for putting images into word docs or PPT presentations). But many others are available such as: “.pdf” (easy to view or email a .pdf to someone; and good to use for uploading plot files to journals if they’ll accept this format), “.eps” (another vector format some journals one), “.png”, “.jpeg”, “.tiff”, “.svg”(use for further editing in https://inkscape.org/ freeware on windows).\nYou can read more about the difference between vector vs. raster image file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885352. And more about specific file types here: https://guides.lib.umich.edu/c.php?g=282942&p=1885348\nYou specify the dimensions of the plot with the width = and height = arguments, default is inches. Try different widths and heights (keeping in mind what would fit on a 8in by 11in page size) and see what works for the plot you making. Often a plot shows the data better when it is taller or wider (so try different ratios of width to height).\nYou can also specify the image “quality” using the “dots per inch” argument dpi = and typically you want to use 300 or 600 for a high quality image. Depending on the file type (with .tiff for example) 600 dpi can sometimes create huge file sizes, but that is usually where I start (then only go down to 300 if needed).\nNOTE - sometimes you can get an error when running ggsave() repeatedly if the saved .png file is already open on your computer in your image viewer - need to close it each time you want to edit and re-output the image file.\n\n\n# output plot to .png file type, set size (default is inches), 300 or 600 dpi is high quality\nggsave(\n  \"plot_cell_diff_95CIs.png\",\n  results_plot,\n  width = 4,\n  height = 4,\n  dpi = 600\n)"
  },
  {
    "objectID": "Compare_means_independent_paried_samples.html#linear-model-w-a-categorical-x-explanatory-variable",
    "href": "Compare_means_independent_paried_samples.html#linear-model-w-a-categorical-x-explanatory-variable",
    "title": "Week 7 - Comparing Means from independent and paired samples",
    "section": "Linear model w/ a categorical X (explanatory) variable",
    "text": "Linear model w/ a categorical X (explanatory) variable\nFor this analysis we’ll use one of the data sets built into R:\nToothGrowth (The Effect of Vitamin C on Tooth Growth in Guinea Pigs)\nFrom: Crampton, E. W. (1947). The growth of the odontoblast of the incisor teeth as a criterion of vitamin C intake of the guinea pig. The Journal of Nutrition, 33(5), 491-504. doi: https://academic.oup.com/jn/article-abstract/33/5/491/4726758.\nNote: R has many built-in data sets and a list of them can be viewed with the data() function\nIn the ToothGrowth data set the response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC).\n\n#Each built in data set has a help file that can be viewed:\n?ToothGrowth\n\n#View the structure of the full data set:\nglimpse(ToothGrowth)\n\nRows: 60\nColumns: 3\n$ len  &lt;dbl&gt; 4.2, 11.5, 7.3, 5.8, 6.4, 10.0, 11.2, 11.2, 5.2, 7.0, 16.5, 16.5,…\n$ supp &lt;fct&gt; VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, V…\n$ dose &lt;dbl&gt; 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, …\n\n\nWhile the full data set has 1 numeric response (len) and 2 categorical explanatory variables (Supplement Type and Dose) we are going to reduce the data set to only one explanatory variable (supp: Supplement Type) with 2 levels (OJ: Orange Juice; VC: Ascorbic Acid) by filtering the data to select only guinea pigs that received a dose == 1\n\ndat_tg &lt;- ToothGrowth |&gt; \n  filter(dose == 1) |&gt;\n  select(len, supp)\n\nglimpse(dat_tg)\n\nRows: 20\nColumns: 2\n$ len  &lt;dbl&gt; 16.5, 16.5, 15.2, 17.3, 22.5, 17.3, 13.6, 14.5, 18.8, 15.5, 19.7,…\n$ supp &lt;fct&gt; VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, OJ, OJ, OJ, OJ, OJ, OJ, O…\n\n\nBiological Question: Does supplement type of vitamin C have an effect on length of odontoblasts (cells responsible for tooth growth) in guinea pigs? (when given a dose level of 1 mg/day)"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "# load tidyverse\nlibrary(tidyverse)\n\n# load tidymodels package (to use functions in broom package)\nlibrary(tidymodels)\n\n# load skimr package - to use skim() function \n# for descriptive statistics\nlibrary(skimr)\n\n# load emmeans package: \"estimated marginal means\" package\n#install.packages(\"emmeans\")\nlibrary(emmeans)\n\n#load cowplot package\n# used to combine multiple ggplots into a single figure\nlibrary(cowplot)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nThe broom Package is loaded/installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\nThe emmeans Package will be used to output means, 95% CIs, p-values and other statistics from specified lm() objects\n\nLots of vignettes here that demo what the package can do: https://cran.r-project.org/web/packages/emmeans/index.html\nThis one reviews the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\nThe cowplot Package will be used here to combined multiple ggplots into a single figure. But it also contains functions for all sorts other plotting purposes (some cool/useful, others I would not necessarily advise using):\n\ncowplot https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html\n\n\n\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#modeling-strategy\n\nThe Laysan Finch (Telespiza contans), a species in the Hawaiian honeycreeper radiation, is endemic to Laysan Island in the Northwest Hawaiian Islands. Early last century rabbits, introduced in 1903, devoured the island’s vegetation and caused the near extinction of the Finch (and extinction of several other bird species). After the elimination of rabbits in 1923, the Finch population recovered. Concern about the species’ vulnerability to such catastrophes, however, led the U.S. Fish and Wildlife Service to establish additional populations at Pearl and Hermes Reef (also in the Northwest Hawaiian Islands). A few birds were introduced to Southeast Island at Pearl and Hermes in 1967, and by the early 1970s several other of the small islands of the atoll had been colonized (including North Island also in this data set).\nDr. Sheila Conant (University of Hawaii Professor) and her students have been studying Laysan Finches since the 1980s. One question of great interest has been whether the populations at Pearl and Hermes have evolved differences from the source population on Laysan Island (see Conant, C., 1988, “Geographic variation in the Laysan Finch (Telespyza contans)’, Evolutionary Ecology 2:270-282). Of particular interest is whether the beak morphology of the birds in the translocated populations differs from that of birds on Laysan; if so, this could represent an evolutionary response to the marked differences in the size and hardness of the main food (seeds) between Laysan and North and South East Islands in the Pearl and Hermes Atoll.\nThe data provided here are from a morphological study by Dr. Conant and Marie Morin in the 1980s. For simplicity and to avoid confounding factors, this data considers only the beak widths of adult female birds captured in 1987. On Southeast Island, North Island (both islands in the Pearl and Hermes Reef atoll complex) and Laysan Island birds were netting or trapped then measured. “Beak width” is the width of the upper mandible at the distal end of the nares perpendicular to the mouth line, measured by caliper to the nearest 0.01mm and recorded in mm.\n\n\ndat_bw &lt;- read_csv(\"bird_beak_width.csv\")\n\n#View the structure of the full data set:\nglimpse(dat_bw)\n\nRows: 92\nColumns: 2\n$ beakwid_mm &lt;dbl&gt; 7.42, 7.12, 7.64, 7.78, 8.14, 8.01, 8.16, 7.59, 7.44, 7.82,…\n$ island     &lt;chr&gt; \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\",…\n\n\n\nConvert the island variable (column) to a factor and use the argument levels = to set the order that the levels will be arranged in a plot or output table. Here we will put Laysan Island first since that is where the birds originally came from when they were translocated to Southeast Island and North Island.\n\nNOTE:\nthe order of your levels will affect their order in the emmeans and contrast tables you’ll create below, so if you change the level here, you may need to revise that code accordingly as well.\n\n\n# Can first see what the different values are \n# to include in the levels argument below\ndat_bw |&gt; distinct(island)\n\n# A tibble: 3 × 1\n  island   \n  &lt;chr&gt;    \n1 Laysan   \n2 North    \n3 Southeast\n\n# then use those values in the level argument\n# (you choose the order)\ndat_bw &lt;- dat_bw |&gt;\n  mutate(island = factor(island,\n                         levels = c(\"Laysan\", \"Southeast\", \"North\")))\n\n# the base R levels() function can be used to\n# check level order matches what is above\nlevels(dat_bw$island)\n\n[1] \"Laysan\"    \"Southeast\" \"North\"    \n\n\nBiological Question: Do the beak widths differ, on average, among the three populations, and in particular, between the source population (Laysan) and the two Southeast and North Island populations?\n\n\nResponse Variable: Beak Width (mm)\n\n\nFactor (Independent Variable): Island\n\n\nLevels (groups/samples) in the Factor: Laysan Island, Southeast Island, North Island"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#load-packages",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#load-packages",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "# load tidyverse\nlibrary(tidyverse)\n\n# load tidymodels package (to use functions in broom package)\nlibrary(tidymodels)\n\n# load skimr package - to use skim() function \n# for descriptive statistics\nlibrary(skimr)\n\n# load emmeans package: \"estimated marginal means\" package\n#install.packages(\"emmeans\")\nlibrary(emmeans)\n\n#load cowplot package\n# used to combine multiple ggplots into a single figure\nlibrary(cowplot)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nThe broom Package is loaded/installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\nThe emmeans Package will be used to output means, 95% CIs, p-values and other statistics from specified lm() objects\n\nLots of vignettes here that demo what the package can do: https://cran.r-project.org/web/packages/emmeans/index.html\nThis one reviews the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\nThe cowplot Package will be used here to combined multiple ggplots into a single figure. But it also contains functions for all sorts other plotting purposes (some cool/useful, others I would not necessarily advise using):\n\ncowplot https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#general-modeling-strategy",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#general-modeling-strategy",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#modeling-strategy"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#background-of-data-set",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#background-of-data-set",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "The Laysan Finch (Telespiza contans), a species in the Hawaiian honeycreeper radiation, is endemic to Laysan Island in the Northwest Hawaiian Islands. Early last century rabbits, introduced in 1903, devoured the island’s vegetation and caused the near extinction of the Finch (and extinction of several other bird species). After the elimination of rabbits in 1923, the Finch population recovered. Concern about the species’ vulnerability to such catastrophes, however, led the U.S. Fish and Wildlife Service to establish additional populations at Pearl and Hermes Reef (also in the Northwest Hawaiian Islands). A few birds were introduced to Southeast Island at Pearl and Hermes in 1967, and by the early 1970s several other of the small islands of the atoll had been colonized (including North Island also in this data set).\nDr. Sheila Conant (University of Hawaii Professor) and her students have been studying Laysan Finches since the 1980s. One question of great interest has been whether the populations at Pearl and Hermes have evolved differences from the source population on Laysan Island (see Conant, C., 1988, “Geographic variation in the Laysan Finch (Telespyza contans)’, Evolutionary Ecology 2:270-282). Of particular interest is whether the beak morphology of the birds in the translocated populations differs from that of birds on Laysan; if so, this could represent an evolutionary response to the marked differences in the size and hardness of the main food (seeds) between Laysan and North and South East Islands in the Pearl and Hermes Atoll.\nThe data provided here are from a morphological study by Dr. Conant and Marie Morin in the 1980s. For simplicity and to avoid confounding factors, this data considers only the beak widths of adult female birds captured in 1987. On Southeast Island, North Island (both islands in the Pearl and Hermes Reef atoll complex) and Laysan Island birds were netting or trapped then measured. “Beak width” is the width of the upper mandible at the distal end of the nares perpendicular to the mouth line, measured by caliper to the nearest 0.01mm and recorded in mm."
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#read-in-data-table",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#read-in-data-table",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "dat_bw &lt;- read_csv(\"bird_beak_width.csv\")\n\n#View the structure of the full data set:\nglimpse(dat_bw)\n\nRows: 92\nColumns: 2\n$ beakwid_mm &lt;dbl&gt; 7.42, 7.12, 7.64, 7.78, 8.14, 8.01, 8.16, 7.59, 7.44, 7.82,…\n$ island     &lt;chr&gt; \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\",…"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#convert-a-variable-column-to-factor-and-set-the-order-of-levels",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#convert-a-variable-column-to-factor-and-set-the-order-of-levels",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "Convert the island variable (column) to a factor and use the argument levels = to set the order that the levels will be arranged in a plot or output table. Here we will put Laysan Island first since that is where the birds originally came from when they were translocated to Southeast Island and North Island.\n\nNOTE:\nthe order of your levels will affect their order in the emmeans and contrast tables you’ll create below, so if you change the level here, you may need to revise that code accordingly as well.\n\n\n# Can first see what the different values are \n# to include in the levels argument below\ndat_bw |&gt; distinct(island)\n\n# A tibble: 3 × 1\n  island   \n  &lt;chr&gt;    \n1 Laysan   \n2 North    \n3 Southeast\n\n# then use those values in the level argument\n# (you choose the order)\ndat_bw &lt;- dat_bw |&gt;\n  mutate(island = factor(island,\n                         levels = c(\"Laysan\", \"Southeast\", \"North\")))\n\n# the base R levels() function can be used to\n# check level order matches what is above\nlevels(dat_bw$island)\n\n[1] \"Laysan\"    \"Southeast\" \"North\"    \n\n\nBiological Question: Do the beak widths differ, on average, among the three populations, and in particular, between the source population (Laysan) and the two Southeast and North Island populations?\n\n\nResponse Variable: Beak Width (mm)\n\n\nFactor (Independent Variable): Island\n\n\nLevels (groups/samples) in the Factor: Laysan Island, Southeast Island, North Island"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#a.-simple-random-sample-srs-from-each-population-group-or-treatment-b.-observations-are-independent",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#a.-simple-random-sample-srs-from-each-population-group-or-treatment-b.-observations-are-independent",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "A. simple random sample (SRS) from each population (group or treatment) & B. Observations are independent",
    "text": "A. simple random sample (SRS) from each population (group or treatment) & B. Observations are independent\n\nThe potential for bias arises from the fact that which of the birds were in the sample was not determined randomly. If by some chance elusive birds which were not caught differ in their beak dimensions from the less-elusive birds which are in the sample, this undercoverage would produce samples unrepresentative of the entire population. This would be something the researchers would need assess based on previous published research, their own experience, and ultimately it comes down to “best professional judgement”."
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#c.-residuals-follow-a-normal-distribution",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#c.-residuals-follow-a-normal-distribution",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "C. Residuals follow a normal distribution",
    "text": "C. Residuals follow a normal distribution\n\nSame as “The distribution of Y within each group is normally distributed.”\n\nAssess “normality” assumption for this example:\n\n\nStart by using the exploratory analysis plots you already made above (Histograms, Individual Value Plots, Boxplots):\n\nYou can see in those plots that the distribution of data for each group (Island) are pretty symmetrical. The distribution for North island might look a little right skewed (positive tail) however the sample size is small (n = 10) so that skewness is just due to a couple bird widths being a little smaller, so not something I’d be concerned about.\n\n\nWe can also assess the assumption more formally by extracting the model residuals like we did in a regression context earlier in the semester using the augment() function with the linear model object (residuals = difference between the predicted mean for each group and the actual data points) and then plotting those residuals.\n\n\n# use augment function (in broom package loaded with tidymodels)\n# to extract residuals of our new model\nlm_bw_island_augment &lt;- augment(lm_bw_island)\n# histogram of residuals\nggplot(lm_bw_island_augment, aes(x = .resid)) +\n  geom_histogram(bins = 20)\n\n\n\n# residuals vs. predictor (x-values) plot\nggplot(lm_bw_island_augment, aes(x =  island, y = .resid)) +\n  geom_point()\n\n\n\n\n\nAs expected the histogram of the residuals looks pretty symmetrical (i.e., “Normal” enough).\nAnd the residuals vs. predictor (x-values) plot (what is typically used for regression model assumption checking) looks fine (symmetrical around y = 0) as well."
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#d.-check-for-equal-variances-among-groups-homoscedasticity",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#d.-check-for-equal-variances-among-groups-homoscedasticity",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "D. Check for “equal” variances among groups (homoscedasticity)\n",
    "text": "D. Check for “equal” variances among groups (homoscedasticity)\n\n\nThis assumption says that all groups (samples) of data have “the same” variance (e.g., spread, sd), but in terms of checking it’s about making sure the standard deviations are not too different from each other.\n\nFirst look at plots above (histogram, boxplot, individual value plot): Does the spread look similar in 2 samples?\nThen assess equal variance assumption with a “rule of thumb”:\n\n\nPrimary rule: (When n/group &gt; 5 & n/groups similar) Consider alternative approach if largest sd &gt; 4*smallest sd (i.e., variances not similar enough)\n\nSecondary Rule: (When n/group NOT similar) Be extra cautious when largest sd is associated with the group with the smallest n. In this case consider alternative approach if largest sd &gt; 2*smallest sd.\nsee Zar Biostatistical Analysis textbook for more info (and/or could cite in thesis/paper if necessary)\n\nIf there are large outliers, one/both of the distributions are very highly skewed, and/or the spread in the data is very different between groups, then can consider other options for calculating the 95% CIs (e.g., bootstrapping), using a Generalized linear model, and/or running a non-parametric test.\nAssess “equal” variance assumption for this example:\n\n# note these sd and n values already produced in code \n# chunk above, just calculating them again here for demo purposes\ndat_bw |&gt;  \n  group_by(island) |&gt;\n  summarise(mean_beakwid_mm = mean(beakwid_mm, na.rm = TRUE),\n            sd_beakwid_mm = sd(beakwid_mm),\n            n_beakwid_mm = n())\n\n# A tibble: 3 × 4\n  island    mean_beakwid_mm sd_beakwid_mm n_beakwid_mm\n  &lt;fct&gt;               &lt;dbl&gt;         &lt;dbl&gt;        &lt;int&gt;\n1 Laysan               7.60         0.226           62\n2 Southeast            7.77         0.313           20\n3 North                8.00         0.240           10\n\n\n\nsample sizes are very different (“not similar”) 62 vs. 20 and 10, so would want to be more cautious, but\n\nlargest sd (SouthEast Island 0.31 ) is NOT 2*sd of smallest sd (Laysan 0.22) - SO WE ARE OK, Variances are “equal enough”\n\nAlso smallest n (North w/ 10) does not have smalled sd (0.24)\n\n\nalso interesting that in comparison to what you see in the plots, North actually has a larger sd than Laysan – since spread/range looks wider for Laysan in the plots - but remember the sd in-class activity - more points close to mean (in Laysan sample) results Laysan having a smaller average deviation from mean."
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#what-you-can-write-in-thesis-or-paper-methods-about-assumptions-checking",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#what-you-can-write-in-thesis-or-paper-methods-about-assumptions-checking",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "What you can write in thesis or paper methods about assumptions checking:",
    "text": "What you can write in thesis or paper methods about assumptions checking:\n“Data distributions and model residuals were assessed to confirm that they met linear model assumptions.”\n\nThen, if pushed by thesis adviser/committee or paper reviewers, you could add the specific details they are requesting."
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#what-if-data-do-not-meet-assumptions",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#what-if-data-do-not-meet-assumptions",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "What if data do not meet assumptions?",
    "text": "What if data do not meet assumptions?\n(some details/examples provided in future weeks of BIO 5100)\nYou could choose to:\n\n\nUse a Generalized Linear Model that assumes a different (than Normal) distribution\n\nIf you are going to be working a lot with data that doesn’t typically meet normality assumptions (for example, if data are counts of things with mostly very small counts, but then sometimes very large counts, i.e., data strongly skewed right) then this could be a good approach to learn and use.\n\n\nUse other methods that do not assume normal residual distributions and/or similar variances (e.g., bootstrap confidence intervals or permutation tests). We will discuss some of these later in the semester.\n(if you must just get a p-value) A nonparametric alternative test for one-way ANOVA using the Kruskal-Wallis test kruskal.test() (base R package). However, nonparametric tests do not provide effect sizes so this is not a preferred method.\n(also easy, but not preferred) Transform your data (e.g., Log10 or square-root transform the response variable) to try to have the transformed variable meet regular model assumptions. However this means your inference will be based on the transformed version of the variable which is often hard(er) to interpret."
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#points-means-plot-w-model-95-cis",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#points-means-plot-w-model-95-cis",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Points & means plot w/ (model) 95% CIs",
    "text": "Points & means plot w/ (model) 95% CIs\n(The bottom part of) your final results plot for this type of analysis should show all the raw data points in each group (island) so the reader can see the distributions of data along with the means and 95% CIs for each group that are calculated from those data.\n\nNote: This will be the bottom part of your final results plot regardless of what option you choose in the next steps to do the pairwise comparisons of the means.\n\n\n# note in ggplot below we had to turn the emmeans object into\n# a tibble (data.frame) so it would work as data in \n# ggplot as_tibble(lm_bw_island_emm)\n\nplot_lm_bw_island_emm &lt;- dat_bw |&gt;\nggplot(aes(x = island, y = beakwid_mm, color = island)) +\n  geom_jitter(width = 0.1, alpha = 0.4) +\n  ylab(\"Beakwidth (mm)\") +\n  xlab(\"Island\") +\n  #use emm object as 2nd data table to plot 95% CIs\n  geom_crossbar(data = as_tibble(lm_bw_island_emm), \n                aes(y = emmean,\n                    ymin = lower.CL,\n                    ymax = upper.CL), \n                width = 0.2,\n                color = \"black\") +\n  theme_classic() +\n  theme(legend.position=\"none\")\n\nplot_lm_bw_island_emm\n\n\n\n\nThis plot shows the raw data for each group (Island). The geom_crossbar() plots the group means (middle line) and the 95% CIs from the associated linear model which were calculated in the emmeans table above.\n\nNote geom_pointrange() could be used instead of geom_crossbar() if you prefer that style of plotting mean + CIs https://ggplot2.tidyverse.org/reference/geom_linerange.html (scroll down to bottom of page to see various error bar plotting examples)"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#option-1-tukey-honestly-significant-difference-hsd-contrasts-table-corresponding-effects-plot-w-adjusted-95-cis-and-p-values",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#option-1-tukey-honestly-significant-difference-hsd-contrasts-table-corresponding-effects-plot-w-adjusted-95-cis-and-p-values",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "\nOption 1: Tukey Honestly Significant Difference (HSD) contrasts table & corresponding “effects” plot w/ adjusted 95% CIs and p-values",
    "text": "Option 1: Tukey Honestly Significant Difference (HSD) contrasts table & corresponding “effects” plot w/ adjusted 95% CIs and p-values\nhttps://en.wikipedia.org/wiki/Tukey%27s_range_test\n\nruns all possible pairwise tests by default, but the more tests (determined by the number of levels within your factor variable), the more conservative each test becomes (i.e., more each p-value is adjusted larger)\n\n“Contrasts table” using contrast() function from emmeans package\n\nFor details on the argument method = see help(“contrast-methods”)\n\nhttps://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html\n\nThe Tukey HSD procedure is specified in the contrast() function by using both arguments:\n\n\nmethod = \"revpairwise\" or method = \"pairwise\" which will do “all possible” pairwise comparisons.\n\nThe choice of pairwise vs. revpairwise depends on which groups (islands) you want to be first in the difference calculation (switching them with make positive differences become negative and viceversa).\nHow many pairwise comparisons it does depends on how many groups/levels are in your categorical variable.\n\n\n\nadjust = \"tukey\" specifies that the Tukey HSD adjustment will be made to the pairwise 95% CIs and p-values. They will be adjusted larger, and how big that adjustment is depends on the total number of pairwise comparisons being done.\n\n\n\n\nlm_bw_island_pairs &lt;- contrast(lm_bw_island_emm,\n                               method = \"revpairwise\",\n                               adjust = \"tukey\") |&gt;\n  summary(infer = TRUE)\n#Note: method = \"revpairwise\" switches the order in subtraction\n# for comparison (up to researcher/you to determine which is\n# more appropriate)\n\nlm_bw_island_pairs\n\n contrast           estimate     SE df  lower.CL upper.CL t.ratio p.value\n Southeast - Laysan    0.163 0.0640 89  0.010393    0.315   2.546  0.0334\n North - Laysan        0.392 0.0848 89  0.189790    0.594   4.621  &lt;.0001\n North - Southeast     0.229 0.0964 89 -0.000741    0.459   2.376  0.0509\n\nConfidence level used: 0.95 \nConf-level adjustment: tukey method for comparing a family of 3 estimates \nP value adjustment: tukey method for comparing a family of 3 estimates \n\n\nThis table is important for reporting treatment effects and 95% CI and it lm_len_supp_pairs is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-values here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 3.3%, &lt;.01%, or 5.1% chance that these data came from a true population where there was no difference between the respective pairs of means.\n\n\n\nThe the p-values are adjusted (made larger) because you are running 3 different pairwise t-tests simultaneously.\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#effects-plot-w-95-ci-tukey-hsd-all-pairwise-comparisons-version",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#effects-plot-w-95-ci-tukey-hsd-all-pairwise-comparisons-version",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Effects plot w/ 95% CI (Tukey HSD all pairwise comparisons version)",
    "text": "Effects plot w/ 95% CI (Tukey HSD all pairwise comparisons version)\n\n# note in ggplot below we had to turn the contrast object into\n# a tibble (data.frame) so it would work as data in ggplot\n\nplot_lm_bw_island_pairs &lt;- as_tibble(lm_bw_island_pairs) |&gt;\n  ggplot(aes(\n    y = contrast,\n    x = estimate,\n    label = format.pval(p.value,\n                        digits = 2,\n                        eps = 0.001)\n  )) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (mm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  geom_text(vjust = 0,\n            nudge_y = 0.25,\n            size = 3)\n\nplot_lm_bw_island_pairs\n\n\n\n\nThis plot shows the 3 pairwise differences between the 3 means (each combination of 2 islands), and the 95% CI for those differences (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between those 95% CIs”).\n\nThe dashed line at 0 is there for reference since if the islands had the same average beak width, the difference in their means would be 0.\nThe pairwise difference between North & Laysan was the largest (and it’s 95% CI was not close to crossing 0), it also had the smallest Tukey HSD adjusted p-value in the output above.\nNote for (Southeast - Laysan, and North - Southeast) the two with p-values in the output above close to 0.05, the lower limit of their 95% CIs are close to 0 (i.e. 0 = no difference in beak widths)"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#option-2-pre-planned-contrasts-no-adjustments-contrasts-table-corresponding-effects-plot-w-95-ci-and-p-values",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#option-2-pre-planned-contrasts-no-adjustments-contrasts-table-corresponding-effects-plot-w-95-ci-and-p-values",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "\nOption 2: Pre-planned contrasts (no adjustments) contrasts table & corresponding “effects” plot w/ 95% CI and p-values",
    "text": "Option 2: Pre-planned contrasts (no adjustments) contrasts table & corresponding “effects” plot w/ 95% CI and p-values\n“Pre-planned contrasts” are typically used if you know in advance that you are primarily interested in just some of the specific pairwise comparisons and these do not have the 95% CIs and p-values “adjusted.” However, the author of the text below advocates for using a version of this approach in most situations (see more below).\n\nBiological question: Do the beak widths differ, on average, among the three populations, and in particular, between the source population (Laysan) and the two Southeast and North Island populations?\nSo we’ll focus on 2 (of the three possible) pairwise comparisons:\n\nSE - Laysan\nN - Laysan\n\n\n\nAccording to: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n“The most transparent best practice is to report all, unadjusted p-values. Reporting all unadjusted p-values allows a reader to compute whatever adjustment they deem appropriate for the question they are addressing. Reporting all p-values could overwhelm the principal message of a figure. Instead, report focal (planned comparison) p-values in the figure and a table of all p-values in the supplement. There should be a table of these for every experiment in the supplement.”\nPre-planned contrasts and associated plot of mean pairwise differences w/ 95% CIs\n\n# Pre-planned contrasts (pairwise mean differences we care\n# about)\n\n# lm_bw_island_emm # print the emmeans table in console to\n# get row numbers (factor level order) for each group\n\n# set the mean as the row number from the emmeans table\nLaysan &lt;- c(1, 0, 0)\nSoutheast &lt;- c(0, 1, 0)\nNorth &lt;- c(0, 0, 1)\n\n# NOTE: if you have more than 3 levels in your factor you'd\n# need to add more ,0 the c() above so there's one for\n# each level.\n\n# the method argument specifies which pre-planned contrasts\n# will be included\nlm_bw_island_planned &lt;- contrast(\n  lm_bw_island_emm,\n  method = list(\n    \"SE - Laysan\" = c(Southeast - Laysan),\n    \"N - Laysan\" = c(North - Laysan)\n  ),\n  adjust = \"none\" # no 95% CI or p-value adjustments\n) |&gt;\n  summary(infer = TRUE)\n\nlm_bw_island_planned\n\n contrast    estimate     SE df lower.CL upper.CL t.ratio p.value\n SE - Laysan    0.163 0.0640 89   0.0358     0.29   2.546  0.0126\n N - Laysan     0.392 0.0848 89   0.2234     0.56   4.621  &lt;.0001\n\nConfidence level used: 0.95 \n\n\nThis table is important for reporting treatment effects and 95% CI and it lm_bw_island_planned is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-values here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 1.3% and &lt;.01% chance that these data came from a true population where there was no difference between the respective pairs of means.\n\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table"
  },
  {
    "objectID": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#effects-plot-w-95-ci-preplanned-contrasts-version",
    "href": "Example_Code_Cat_explanitory_multiple_groups_ANOVA.html#effects-plot-w-95-ci-preplanned-contrasts-version",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Effects plot w/ 95% CI (preplanned contrasts version)",
    "text": "Effects plot w/ 95% CI (preplanned contrasts version)\nThis effects plot will just include the 2 pairwise comparisons (Southeast - Laysan & North - Laysan) that we are primarily interested in.\n\n# note in ggplot below we had to turn the contrast object into \n# a tibble (data.frame) so it would work as data in ggplot\nplot_lm_bw_island_planned &lt;- as_tibble(lm_bw_island_planned) |&gt;\n  ggplot(aes(\n    y = contrast,\n    x = estimate,\n    label = format.pval(p.value,\n                        digits = 2,\n                        eps = 0.001)\n  )) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (mm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  geom_text(vjust = 0,\n            nudge_y = 0.25,\n            size = 3)\n\nplot_lm_bw_island_planned\n\n\n\n\nThis plot shows the 2 (pre-planned) pairwise differences between the selected means (between the origin Laysan Island and the each of the other 2 islands the birds were relocated to), and the 95% CI for those differences (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between those 95% CIs”).\nThe dashed line at 0 is there for reference since if the islands had the same average beak width, the difference in their means would be 0.\nTable of all pairwise contrasts no adjustments (to include in appendix etc.)\nAccording to: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n“The most transparent best practice is to report all, unadjusted p-values. Reporting all unadjusted p-values allows a reader to compute whatever adjustment they deem appropriate for the question they are addressing. Reporting all p-values could overwhelm the principal message of a figure. Instead, report focal (planned comparison) p-values in the figure and a table of all p-values in the supplement. There should be a table of these for every experiment in the supplement.”\n\nlm_bw_island_pairs_no_adjust &lt;- contrast(lm_bw_island_emm,\n                                         method = \"revpairwise\",\n                                         adjust = \"none\") |&gt;\n  summary(infer = TRUE)\n\nlm_bw_island_pairs_no_adjust\n\n contrast           estimate     SE df lower.CL upper.CL t.ratio p.value\n Southeast - Laysan    0.163 0.0640 89   0.0358    0.290   2.546  0.0126\n North - Laysan        0.392 0.0848 89   0.2234    0.560   4.621  &lt;.0001\n North - Southeast     0.229 0.0964 89   0.0375    0.421   2.376  0.0197\n\nConfidence level used: 0.95"
  },
  {
    "objectID": "Compare_multiple_means.html",
    "href": "Compare_multiple_means.html",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "# load tidyverse\nlibrary(tidyverse)\n\n# load tidymodels package (to use functions in broom package)\nlibrary(tidymodels)\n\n# load skimr package - to use skim() function \n# for descriptive statistics\nlibrary(skimr)\n\n# load emmeans package: \"estimated marginal means\" package\n#install.packages(\"emmeans\")\nlibrary(emmeans)\n\n#load cowplot package\n# used to combine multiple ggplots into a single figure\nlibrary(cowplot)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nThe broom Package is loaded/installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\nThe emmeans Package will be used to output means, 95% CIs, p-values and other statistics from specified lm() objects\n\nLots of vignettes here that demo what the package can do: https://cran.r-project.org/web/packages/emmeans/index.html\nThis one reviews the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\nThe cowplot Package will be used here to combined multiple ggplots into a single figure. But it also contains functions for all sorts other plotting purposes (some cool/useful, others I would not necessarily advise using):\n\ncowplot https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"
  },
  {
    "objectID": "Compare_multiple_means.html#load-packages",
    "href": "Compare_multiple_means.html#load-packages",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "# load tidyverse\nlibrary(tidyverse)\n\n# load tidymodels package (to use functions in broom package)\nlibrary(tidymodels)\n\n# load skimr package - to use skim() function \n# for descriptive statistics\nlibrary(skimr)\n\n# load emmeans package: \"estimated marginal means\" package\n#install.packages(\"emmeans\")\nlibrary(emmeans)\n\n#load cowplot package\n# used to combine multiple ggplots into a single figure\nlibrary(cowplot)\n\nThe tidyverse package is actually a collection of multiple R packages https://www.tidyverse.org/packages/ including the ggplot2 package (for plotting) and dplyr package (for organizing and summarizing data). And you can load these (and others packages in the tidyverse) all at once using library(tidyverse).\nThe ggplot2 Package we will use primarily for making plots (and is part of the tidyverse) has great help pages: https://ggplot2.tidyverse.org/reference/index.html\nThe dplyr Package we will use for “data wrangling” (e.g., organizing, summarizing) and it also has (not as extensive) help pages https://dplyr.tidyverse.org/ (plus cheat sheets RStudio &gt; Help &gt; Cheatsheets)\nThe broom Package is loaded/installed as part of tidymodels meta-package (similar to tidyverse). More information/examples of broom package functions can be found here: https://broom.tidymodels.org/articles/broom.html\nThe emmeans Package will be used to output means, 95% CIs, p-values and other statistics from specified lm() objects\n\nLots of vignettes here that demo what the package can do: https://cran.r-project.org/web/packages/emmeans/index.html\nThis one reviews the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n\nThe cowplot Package will be used here to combined multiple ggplots into a single figure. But it also contains functions for all sorts other plotting purposes (some cool/useful, others I would not necessarily advise using):\n\ncowplot https://cran.r-project.org/web/packages/cowplot/vignettes/introduction.html"
  },
  {
    "objectID": "Compare_multiple_means.html#general-modeling-strategy",
    "href": "Compare_multiple_means.html#general-modeling-strategy",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#modeling-strategy"
  },
  {
    "objectID": "Compare_multiple_means.html#background-of-data-set",
    "href": "Compare_multiple_means.html#background-of-data-set",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "",
    "text": "The Laysan Finch (Telespiza contans), a species in the Hawaiian honeycreeper radiation, is endemic to Laysan Island in the Northwest Hawaiian Islands. Early last century rabbits, introduced in 1903, devoured the island’s vegetation and caused the near extinction of the Finch (and extinction of several other bird species). After the elimination of rabbits in 1923, the Finch population recovered. Concern about the species’ vulnerability to such catastrophes, however, led the U.S. Fish and Wildlife Service to establish additional populations at Pearl and Hermes Reef (also in the Northwest Hawaiian Islands). A few birds were introduced to Southeast Island at Pearl and Hermes in 1967, and by the early 1970s several other of the small islands of the atoll had been colonized (including North Island also in this data set).\nDr. Sheila Conant (University of Hawaii Professor) and her students have been studying Laysan Finches since the 1980s. One question of great interest has been whether the populations at Pearl and Hermes have evolved differences from the source population on Laysan Island (see Conant, C., 1988, “Geographic variation in the Laysan Finch (Telespyza contans)’, Evolutionary Ecology 2:270-282). Of particular interest is whether the beak morphology of the birds in the translocated populations differs from that of birds on Laysan; if so, this could represent an evolutionary response to the marked differences in the size and hardness of the main food (seeds) between Laysan and North and South East Islands in the Pearl and Hermes Atoll.\nThe data provided here are from a morphological study by Dr. Conant and Marie Morin in the 1980s. For simplicity and to avoid confounding factors, this data considers only the beak widths of adult female birds captured in 1987. On Southeast Island, North Island (both islands in the Pearl and Hermes Reef atoll complex) and Laysan Island birds were netting or trapped then measured. “Beak width” is the width of the upper mandible at the distal end of the nares perpendicular to the mouth line, measured by caliper to the nearest 0.01mm and recorded in mm."
  },
  {
    "objectID": "Compare_multiple_means.html#read-in-data-table",
    "href": "Compare_multiple_means.html#read-in-data-table",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Read in data table",
    "text": "Read in data table\n\ndat_bw &lt;- read_csv(\"bird_beak_width.csv\")\n\n#View the structure of the full data set:\nglimpse(dat_bw)\n\nRows: 92\nColumns: 2\n$ beakwid_mm &lt;dbl&gt; 7.42, 7.12, 7.64, 7.78, 8.14, 8.01, 8.16, 7.59, 7.44, 7.82,…\n$ island     &lt;chr&gt; \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\", \"Laysan\",…"
  },
  {
    "objectID": "Compare_multiple_means.html#convert-a-variable-column-to-factor-and-set-the-order-of-levels",
    "href": "Compare_multiple_means.html#convert-a-variable-column-to-factor-and-set-the-order-of-levels",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Convert a variable (column) to factor and set the order of levels",
    "text": "Convert a variable (column) to factor and set the order of levels\nConvert the island variable (column) to a factor and use the argument levels = to set the order that the levels will be arranged in a plot or output table. Here we will put Laysan Island first since that is where the birds originally came from when they were translocated to Southeast Island and North Island.\n\nNOTE:\nthe order of your levels will affect their order in the emmeans and contrast tables you’ll create below, so if you change the level here, you may need to revise that code accordingly as well.\n\n\n# Can first see what the different values are \n# to include in the levels argument below\ndat_bw |&gt; distinct(island)\n\n# A tibble: 3 × 1\n  island   \n  &lt;chr&gt;    \n1 Laysan   \n2 North    \n3 Southeast\n\n# then use those values in the level argument\n# (you choose the order)\ndat_bw &lt;- dat_bw |&gt;\n  mutate(island = factor(island,\n                         levels = c(\"Laysan\", \"Southeast\", \"North\")))\n\n# the base R levels() function can be used to\n# check level order matches what is above\nlevels(dat_bw$island)\n\n[1] \"Laysan\"    \"Southeast\" \"North\"    \n\n\nBiological Question: Do the beak widths differ, on average, among the three populations, and in particular, between the source population (Laysan) and the two Southeast and North Island populations?\n\n\nResponse Variable: Beak Width (mm)\n\n\nFactor (Independent Variable): Island\n\n\nLevels (groups/samples) in the Factor: Laysan Island, Southeast Island, North Island"
  },
  {
    "objectID": "Compare_multiple_means.html#a.-simple-random-sample-srs-from-each-population-group-or-treatment-b.-observations-are-independent",
    "href": "Compare_multiple_means.html#a.-simple-random-sample-srs-from-each-population-group-or-treatment-b.-observations-are-independent",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "A. simple random sample (SRS) from each population (group or treatment) & B. Observations are independent",
    "text": "A. simple random sample (SRS) from each population (group or treatment) & B. Observations are independent\n\nThe potential for bias arises from the fact that which of the birds were in the sample was not determined randomly. If by some chance elusive birds which were not caught differ in their beak dimensions from the less-elusive birds which are in the sample, this undercoverage would produce samples unrepresentative of the entire population. This would be something the researchers would need assess based on previous published research, their own experience, and ultimately it comes down to “best professional judgement”."
  },
  {
    "objectID": "Compare_multiple_means.html#c.-residuals-follow-a-normal-distribution",
    "href": "Compare_multiple_means.html#c.-residuals-follow-a-normal-distribution",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "C. Residuals follow a normal distribution",
    "text": "C. Residuals follow a normal distribution\n\nSame as “The distribution of Y within each group is normally distributed.”\n\nAssess “normality” assumption for this example:\n\n\nStart by using the exploratory analysis plots you already made above (Histograms, Individual Value Plots, Boxplots):\n\nYou can see in those plots that the distribution of data for each group (Island) are pretty symmetrical. The distribution for North island might look a little right skewed (positive tail) however the sample size is small (n = 10) so that skewness is just due to a couple bird widths being a little smaller, so not something I’d be concerned about.\n\n\nWe can also assess the assumption more formally by extracting the model residuals like we did in a regression context earlier in the semester using the augment() function with the linear model object (residuals = difference between the predicted mean for each group and the actual data points) and then plotting those residuals.\n\n\n# use augment function (in broom package loaded with tidymodels)\n# to extract residuals of our new model\nlm_bw_island_augment &lt;- augment(lm_bw_island)\n# histogram of residuals\nggplot(lm_bw_island_augment, aes(x = .resid)) +\n  geom_histogram(bins = 20)\n\n\n\n# residuals vs. predictor (x-values) plot\nggplot(lm_bw_island_augment, aes(x =  island, y = .resid)) +\n  geom_point()\n\n\n\n\n\nAs expected the histogram of the residuals looks pretty symmetrical (i.e., “Normal” enough).\nAnd the residuals vs. predictor (x-values) plot (what is typically used for regression model assumption checking) looks fine (symmetrical around y = 0) as well."
  },
  {
    "objectID": "Compare_multiple_means.html#d.-check-for-equal-variances-among-groups-homoscedasticity",
    "href": "Compare_multiple_means.html#d.-check-for-equal-variances-among-groups-homoscedasticity",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "D. Check for “equal” variances among groups (homoscedasticity)\n",
    "text": "D. Check for “equal” variances among groups (homoscedasticity)\n\n\nThis assumption says that all groups (samples) of data have “the same” variance (e.g., spread, sd), but in terms of checking it’s about making sure the standard deviations are not too different from each other.\n\nFirst look at plots above (histogram, boxplot, individual value plot): Does the spread look similar in 2 samples?\nThen assess equal variance assumption with a “rule of thumb”:\n\n\nPrimary rule: (When n/group &gt; 5 & n/groups similar) Consider alternative approach if largest sd &gt; 4*smallest sd (i.e., variances not similar enough)\n\nSecondary Rule: (When n/group NOT similar) Be extra cautious when largest sd is associated with the group with the smallest n. In this case consider alternative approach if largest sd &gt; 2*smallest sd.\nsee Zar Biostatistical Analysis textbook for more info (and/or could cite in thesis/paper if necessary)\n\nIf there are large outliers, one/both of the distributions are very highly skewed, and/or the spread in the data is very different between groups, then can consider other options for calculating the 95% CIs (e.g., bootstrapping), using a Generalized linear model, and/or running a non-parametric test.\nAssess “equal” variance assumption for this example:\n\n# note these sd and n values already produced in code \n# chunk above, just calculating them again here for demo purposes\ndat_bw |&gt;  \n  group_by(island) |&gt;\n  summarise(mean_beakwid_mm = mean(beakwid_mm, na.rm = TRUE),\n            sd_beakwid_mm = sd(beakwid_mm),\n            n_beakwid_mm = n())\n\n# A tibble: 3 × 4\n  island    mean_beakwid_mm sd_beakwid_mm n_beakwid_mm\n  &lt;fct&gt;               &lt;dbl&gt;         &lt;dbl&gt;        &lt;int&gt;\n1 Laysan               7.60         0.226           62\n2 Southeast            7.77         0.313           20\n3 North                8.00         0.240           10\n\n\n\nsample sizes are very different (“not similar”) 62 vs. 20 and 10, so would want to be more cautious, but\n\nlargest sd (SouthEast Island 0.31 ) is NOT 2*sd of smallest sd (Laysan 0.22) - SO WE ARE OK, Variances are “equal enough”\n\nAlso smallest n (North w/ 10) does not have smalled sd (0.24)\n\n\nalso interesting that in comparison to what you see in the plots, North actually has a larger sd than Laysan – since spread/range looks wider for Laysan in the plots - but remember the sd in-class activity - more points close to mean (in Laysan sample) results Laysan having a smaller average deviation from mean."
  },
  {
    "objectID": "Compare_multiple_means.html#what-you-can-write-in-thesis-or-paper-methods-about-assumptions-checking",
    "href": "Compare_multiple_means.html#what-you-can-write-in-thesis-or-paper-methods-about-assumptions-checking",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "What you can write in thesis or paper methods about assumptions checking:",
    "text": "What you can write in thesis or paper methods about assumptions checking:\n“Data distributions and model residuals were assessed to confirm that they met linear model assumptions.”\n\nThen, if pushed by thesis adviser/committee or paper reviewers, you could add the specific details they are requesting."
  },
  {
    "objectID": "Compare_multiple_means.html#what-if-data-do-not-meet-assumptions",
    "href": "Compare_multiple_means.html#what-if-data-do-not-meet-assumptions",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "What if data do not meet assumptions?",
    "text": "What if data do not meet assumptions?\n(some details/examples provided in future weeks of BIO 5100)\nYou could choose to:\n\n\nUse a Generalized Linear Model that assumes a different (than Normal) distribution\n\nIf you are going to be working a lot with data that doesn’t typically meet normality assumptions (for example, if data are counts of things with mostly very small counts, but then sometimes very large counts, i.e., data strongly skewed right) then this could be a good approach to learn and use.\n\n\nUse other methods that do not assume normal residual distributions and/or similar variances (e.g., bootstrap confidence intervals or permutation tests). We will discuss some of these later in the semester.\n(if you must just get a p-value) A nonparametric alternative test for one-way ANOVA using the Kruskal-Wallis test kruskal.test() (base R package). However, nonparametric tests do not provide effect sizes so this is not a preferred method.\n(also easy, but not preferred) Transform your data (e.g., Log10 or square-root transform the response variable) to try to have the transformed variable meet regular model assumptions. However this means your inference will be based on the transformed version of the variable which is often hard(er) to interpret."
  },
  {
    "objectID": "Compare_multiple_means.html#points-means-plot-w-model-95-cis",
    "href": "Compare_multiple_means.html#points-means-plot-w-model-95-cis",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Points & means plot w/ (model) 95% CIs",
    "text": "Points & means plot w/ (model) 95% CIs\n(The bottom part of) your final results plot for this type of analysis should show all the raw data points in each group (island) so the reader can see the distributions of data along with the means and 95% CIs for each group that are calculated from those data.\n\nNote: This will be the bottom part of your final results plot regardless of what option you choose in the next steps to do the pairwise comparisons of the means.\n\n\n# note in ggplot below we had to turn the emmeans object into\n# a tibble (data.frame) so it would work as data in \n# ggplot as_tibble(lm_bw_island_emm)\n\nplot_lm_bw_island_emm &lt;- dat_bw |&gt;\nggplot(aes(x = island, y = beakwid_mm, color = island)) +\n  geom_jitter(width = 0.1, alpha = 0.4) +\n  ylab(\"Beakwidth (mm)\") +\n  xlab(\"Island\") +\n  #use emm object as 2nd data table to plot 95% CIs\n  geom_crossbar(data = as_tibble(lm_bw_island_emm), \n                aes(y = emmean,\n                    ymin = lower.CL,\n                    ymax = upper.CL), \n                width = 0.2,\n                color = \"black\") +\n  theme_classic() +\n  theme(legend.position=\"none\")\n\nplot_lm_bw_island_emm\n\n\n\n\nThis plot shows the raw data for each group (Island). The geom_crossbar() plots the group means (middle line) and the 95% CIs from the associated linear model which were calculated in the emmeans table above.\n\nNote geom_pointrange() could be used instead of geom_crossbar() if you prefer that style of plotting mean + CIs https://ggplot2.tidyverse.org/reference/geom_linerange.html (scroll down to bottom of page to see various error bar plotting examples)"
  },
  {
    "objectID": "Compare_multiple_means.html#option-1-tukey-honestly-significant-difference-hsd-contrasts-table-corresponding-effects-plot-w-adjusted-95-cis-and-p-values",
    "href": "Compare_multiple_means.html#option-1-tukey-honestly-significant-difference-hsd-contrasts-table-corresponding-effects-plot-w-adjusted-95-cis-and-p-values",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "\nOption 1: Tukey Honestly Significant Difference (HSD) contrasts table & corresponding “effects” plot w/ adjusted 95% CIs and p-values",
    "text": "Option 1: Tukey Honestly Significant Difference (HSD) contrasts table & corresponding “effects” plot w/ adjusted 95% CIs and p-values\nhttps://en.wikipedia.org/wiki/Tukey%27s_range_test\n\nruns all possible pairwise tests by default, but the more tests (determined by the number of levels within your factor variable), the more conservative each test becomes (i.e., more each p-value is adjusted larger)\n\n“Contrasts table” using contrast() function from emmeans package\n\nFor details on the argument method = see help(“contrast-methods”)\n\nhttps://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html\n\nThe Tukey HSD procedure is specified in the contrast() function by using both arguments:\n\n\nmethod = \"revpairwise\" or method = \"pairwise\" which will do “all possible” pairwise comparisons.\n\nThe choice of pairwise vs. revpairwise depends on which groups (islands) you want to be first in the difference calculation (switching them with make positive differences become negative and viceversa).\nHow many pairwise comparisons it does depends on how many groups/levels are in your categorical variable.\n\n\n\nadjust = \"tukey\" specifies that the Tukey HSD adjustment will be made to the pairwise 95% CIs and p-values. They will be adjusted larger, and how big that adjustment is depends on the total number of pairwise comparisons being done.\n\n\n\n\nlm_bw_island_pairs &lt;- contrast(lm_bw_island_emm,\n                               method = \"revpairwise\",\n                               adjust = \"tukey\") |&gt;\n  summary(infer = TRUE)\n#Note: method = \"revpairwise\" switches the order in subtraction\n# for comparison (up to researcher/you to determine which is\n# more appropriate)\n\nlm_bw_island_pairs\n\n contrast           estimate     SE df  lower.CL upper.CL t.ratio p.value\n Southeast - Laysan    0.163 0.0640 89  0.010393    0.315   2.546  0.0334\n North - Laysan        0.392 0.0848 89  0.189790    0.594   4.621  &lt;.0001\n North - Southeast     0.229 0.0964 89 -0.000741    0.459   2.376  0.0509\n\nConfidence level used: 0.95 \nConf-level adjustment: tukey method for comparing a family of 3 estimates \nP value adjustment: tukey method for comparing a family of 3 estimates \n\n\nThis table is important for reporting treatment effects and 95% CI and it lm_len_supp_pairs is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-values here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 3.3%, &lt;.01%, or 5.1% chance that these data came from a true population where there was no difference between the respective pairs of means.\n\n\n\nThe the p-values are adjusted (made larger) because you are running 3 different pairwise t-tests simultaneously.\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table"
  },
  {
    "objectID": "Compare_multiple_means.html#effects-plot-w-95-ci-tukey-hsd-all-pairwise-comparisons-version",
    "href": "Compare_multiple_means.html#effects-plot-w-95-ci-tukey-hsd-all-pairwise-comparisons-version",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Effects plot w/ 95% CI (Tukey HSD all pairwise comparisons version)",
    "text": "Effects plot w/ 95% CI (Tukey HSD all pairwise comparisons version)\n\n# note in ggplot below we had to turn the contrast object into\n# a tibble (data.frame) so it would work as data in ggplot\n\nplot_lm_bw_island_pairs &lt;- as_tibble(lm_bw_island_pairs) |&gt;\n  ggplot(aes(\n    y = contrast,\n    x = estimate,\n    label = format.pval(p.value,\n                        digits = 2,\n                        eps = 0.001)\n  )) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (mm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  geom_text(vjust = 0,\n            nudge_y = 0.25,\n            size = 3)\n\nplot_lm_bw_island_pairs\n\n\n\n\nThis plot shows the 3 pairwise differences between the 3 means (each combination of 2 islands), and the 95% CI for those differences (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between those 95% CIs”).\n\nThe dashed line at 0 is there for reference since if the islands had the same average beak width, the difference in their means would be 0.\nThe pairwise difference between North & Laysan was the largest (and it’s 95% CI was not close to crossing 0), it also had the smallest Tukey HSD adjusted p-value in the output above.\nNote for (Southeast - Laysan, and North - Southeast) the two with p-values in the output above close to 0.05, the lower limit of their 95% CIs are close to 0 (i.e. 0 = no difference in beak widths)"
  },
  {
    "objectID": "Compare_multiple_means.html#option-2-pre-planned-contrasts-no-adjustments-contrasts-table-corresponding-effects-plot-w-95-ci-and-p-values",
    "href": "Compare_multiple_means.html#option-2-pre-planned-contrasts-no-adjustments-contrasts-table-corresponding-effects-plot-w-95-ci-and-p-values",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "\nOption 2: Pre-planned contrasts (no adjustments) contrasts table & corresponding “effects” plot w/ 95% CI and p-values",
    "text": "Option 2: Pre-planned contrasts (no adjustments) contrasts table & corresponding “effects” plot w/ 95% CI and p-values\n“Pre-planned contrasts” are typically used if you know in advance that you are primarily interested in just some of the specific pairwise comparisons and these do not have the 95% CIs and p-values “adjusted.” However, the author of the text below advocates for using a version of this approach in most situations (see more below).\n\nBiological question: Do the beak widths differ, on average, among the three populations, and in particular, between the source population (Laysan) and the two Southeast and North Island populations?\nSo we’ll focus on 2 (of the three possible) pairwise comparisons:\n\nSE - Laysan\nN - Laysan\n\n\n\nAccording to: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n“The most transparent best practice is to report all, unadjusted p-values. Reporting all unadjusted p-values allows a reader to compute whatever adjustment they deem appropriate for the question they are addressing. Reporting all p-values could overwhelm the principal message of a figure. Instead, report focal (planned comparison) p-values in the figure and a table of all p-values in the supplement. There should be a table of these for every experiment in the supplement.”\nPre-planned contrasts and associated plot of mean pairwise differences w/ 95% CIs\n\n# Pre-planned contrasts (pairwise mean differences we care\n# about)\n\n# lm_bw_island_emm # print the emmeans table in console to\n# get row numbers (factor level order) for each group\n\n# set the mean as the row number from the emmeans table\nLaysan &lt;- c(1, 0, 0)\nSoutheast &lt;- c(0, 1, 0)\nNorth &lt;- c(0, 0, 1)\n\n# NOTE: if you have more than 3 levels in your factor you'd\n# need to add more ,0 the c() above so there's one for\n# each level.\n\n# the method argument specifies which pre-planned contrasts\n# will be included\nlm_bw_island_planned &lt;- contrast(\n  lm_bw_island_emm,\n  method = list(\n    \"SE - Laysan\" = c(Southeast - Laysan),\n    \"N - Laysan\" = c(North - Laysan)\n  ),\n  adjust = \"none\" # no 95% CI or p-value adjustments\n) |&gt;\n  summary(infer = TRUE)\n\nlm_bw_island_planned\n\n contrast    estimate     SE df lower.CL upper.CL t.ratio p.value\n SE - Laysan    0.163 0.0640 89   0.0358     0.29   2.546  0.0126\n N - Laysan     0.392 0.0848 89   0.2234     0.56   4.621  &lt;.0001\n\nConfidence level used: 0.95 \n\n\nThis table is important for reporting treatment effects and 95% CI and it lm_bw_island_planned is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-values here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 1.3% and &lt;.01% chance that these data came from a true population where there was no difference between the respective pairs of means.\n\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table"
  },
  {
    "objectID": "Compare_multiple_means.html#effects-plot-w-95-ci-preplanned-contrasts-version",
    "href": "Compare_multiple_means.html#effects-plot-w-95-ci-preplanned-contrasts-version",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Effects plot w/ 95% CI (preplanned contrasts version)",
    "text": "Effects plot w/ 95% CI (preplanned contrasts version)\nThis effects plot will just include the 2 pairwise comparisons (Southeast - Laysan & North - Laysan) that we are primarily interested in.\n\n# note in ggplot below we had to turn the contrast object into \n# a tibble (data.frame) so it would work as data in ggplot\nplot_lm_bw_island_planned &lt;- as_tibble(lm_bw_island_planned) |&gt;\n  ggplot(aes(\n    y = contrast,\n    x = estimate,\n    label = format.pval(p.value,\n                        digits = 2,\n                        eps = 0.001)\n  )) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (mm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  geom_text(vjust = 0,\n            nudge_y = 0.25,\n            size = 3)\n\nplot_lm_bw_island_planned\n\n\n\n\nThis plot shows the 2 (pre-planned) pairwise differences between the selected means (between the origin Laysan Island and the each of the other 2 islands the birds were relocated to), and the 95% CI for those differences (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between those 95% CIs”).\nThe dashed line at 0 is there for reference since if the islands had the same average beak width, the difference in their means would be 0.\nTable of all pairwise contrasts no adjustments (to include in appendix etc.)\nAccording to: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n“The most transparent best practice is to report all, unadjusted p-values. Reporting all unadjusted p-values allows a reader to compute whatever adjustment they deem appropriate for the question they are addressing. Reporting all p-values could overwhelm the principal message of a figure. Instead, report focal (planned comparison) p-values in the figure and a table of all p-values in the supplement. There should be a table of these for every experiment in the supplement.”\n\nlm_bw_island_pairs_no_adjust &lt;- contrast(lm_bw_island_emm,\n                                         method = \"revpairwise\",\n                                         adjust = \"none\") |&gt;\n  summary(infer = TRUE)\n\nlm_bw_island_pairs_no_adjust\n\n contrast           estimate     SE df lower.CL upper.CL t.ratio p.value\n Southeast - Laysan    0.163 0.0640 89   0.0358    0.290   2.546  0.0126\n North - Laysan        0.392 0.0848 89   0.2234    0.560   4.621  &lt;.0001\n North - Southeast     0.229 0.0964 89   0.0375    0.421   2.376  0.0197\n\nConfidence level used: 0.95"
  },
  {
    "objectID": "Compare_multiple_means.html#linear-model-assumptions",
    "href": "Compare_multiple_means.html#linear-model-assumptions",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Linear model assumptions",
    "text": "Linear model assumptions\nMore details/descriptions can be found here:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/intro-linear-models.html#specific-assumptions-for-inference-with-a-linear-model\nOne-way (one-factor) ANOVA assumptions are also described further here:\nhttps://en.wikipedia.org/wiki/One-way_analysis_of_variance\nA. simple random sample (SRS) from each population (group or treatment) & B. Observations are independent\n\nThe potential for bias arises from the fact that which of the birds were in the sample was not determined randomly. If by some chance elusive birds which were not caught differ in their beak dimensions from the less-elusive birds which are in the sample, this undercoverage would produce samples unrepresentative of the entire population. This would be something the researchers would need assess based on previous published research, their own experience, and ultimately it comes down to “best professional judgement”.\nC. Residuals follow a normal distribution\n\nSame as “The distribution of Y within each group is normally distributed.”\n\nAssess “normality” assumption for this example:\n\n\nStart by using the exploratory analysis plots you already made above (Histograms, Individual Value Plots, Boxplots):\n\nYou can see in those plots that the distribution of data for each group (Island) are pretty symmetrical. The distribution for North island might look a little right skewed (positive tail) however the sample size is small (n = 10) so that skewness is just due to a couple bird widths being a little smaller, so not something I’d be concerned about.\n\n\nWe can also assess the assumption more formally by extracting the model residuals like we did in a regression context earlier in the semester using the augment() function with the linear model object (residuals = difference between the predicted mean for each group and the actual data points) and then plotting those residuals.\n\n\n# use augment function (in broom package loaded with tidymodels)\n# to extract residuals of our new model\nlm_bw_island_augment &lt;- augment(lm_bw_island)\n# histogram of residuals\nggplot(lm_bw_island_augment, aes(x = .resid)) +\n  geom_histogram(bins = 20)\n\n\n\n# residuals vs. predictor (x-values) plot\nggplot(lm_bw_island_augment, aes(x =  island, y = .resid)) +\n  geom_point()\n\n\n\n\n\nAs expected the histogram of the residuals looks pretty symmetrical (i.e., “Normal” enough).\nAnd the residuals vs. predictor (x-values) plot (what is typically used for regression model assumption checking) looks fine (symmetrical around y = 0) as well.\nD. Check for “equal” variances among groups (homoscedasticity)\n\n\nThis assumption says that all groups (samples) of data have “the same” variance (e.g., spread, sd), but in terms of checking it’s about making sure the standard deviations are not too different from each other.\n\nFirst look at plots above (histogram, boxplot, individual value plot): Does the spread look similar in 2 samples?\nThen assess equal variance assumption with a “rule of thumb”:\n\n\nPrimary rule: (When n/group &gt; 5 & n/groups similar) Consider alternative approach if largest sd &gt; 4*smallest sd (i.e., variances not similar enough)\n\nSecondary Rule: (When n/group NOT similar) Be extra cautious when largest sd is associated with the group with the smallest n. In this case consider alternative approach if largest sd &gt; 2*smallest sd.\nsee Zar Biostatistical Analysis textbook for more info (and/or could cite in thesis/paper if necessary)\n\nIf there are large outliers, one/both of the distributions are very highly skewed, and/or the spread in the data is very different between groups, then can consider other options for calculating the 95% CIs (e.g., bootstrapping), using a Generalized linear model, and/or running a non-parametric test.\nAssess “equal” variance assumption for this example:\n\n# note these sd and n values already produced in code \n# chunk above, just calculating them again here for demo purposes\ndat_bw |&gt;  \n  group_by(island) |&gt;\n  summarise(mean_beakwid_mm = mean(beakwid_mm, na.rm = TRUE),\n            sd_beakwid_mm = sd(beakwid_mm),\n            n_beakwid_mm = n())\n\n# A tibble: 3 × 4\n  island    mean_beakwid_mm sd_beakwid_mm n_beakwid_mm\n  &lt;fct&gt;               &lt;dbl&gt;         &lt;dbl&gt;        &lt;int&gt;\n1 Laysan               7.60         0.226           62\n2 Southeast            7.77         0.313           20\n3 North                8.00         0.240           10\n\n\n\nsample sizes are very different (“not similar”) 62 vs. 20 and 10, so would want to be more cautious, but\n\nlargest sd (SouthEast Island 0.31 ) is NOT 2*sd of smallest sd (Laysan 0.22) - SO WE ARE OK, Variances are “equal enough”\n\nAlso smallest n (North w/ 10) does not have smalled sd (0.24)\n\n\nalso interesting that in comparison to what you see in the plots, North actually has a larger sd than Laysan – since spread/range looks wider for Laysan in the plots - but remember the sd in-class activity - more points close to mean (in Laysan sample) results Laysan having a smaller average deviation from mean."
  },
  {
    "objectID": "Compare_multiple_means.html#coefficient-table",
    "href": "Compare_multiple_means.html#coefficient-table",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Coefficient table",
    "text": "Coefficient table\nCreate a “coefficient table” in a “tidy” table format\n\nUses tidy() function from broom package, with a conf.int = T argument to include calculation of 95% CIs.\nNote: the coefficient table is not the most useful/friendly format and can include some irrelevant information. While it is a good idea to create and review it, but you will mostly use/interpret the emmeans and contrast (pairs) tables below.\n\n\n# use tidy function from broom package with the \n# linear model object\nlm_bw_island_coef &lt;- tidy(lm_bw_island, conf.int = TRUE)\n\nlm_bw_island_coef\n\n# A tibble: 3 × 7\n  term            estimate std.error statistic   p.value conf.low conf.high\n  &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n1 (Intercept)        7.60     0.0316    241.   5.20e-127   7.54       7.67 \n2 islandSoutheast    0.163    0.0640      2.55 1.26e-  2   0.0358     0.290\n3 islandNorth        0.392    0.0848      4.62 1.28e-  5   0.223      0.560\n\n\nMore detail on what is in the coefficient table here: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#oneway-what-coefs-are"
  },
  {
    "objectID": "Compare_multiple_means.html#create-emmeans-table-mean-95-ci-for-each-group",
    "href": "Compare_multiple_means.html#create-emmeans-table-mean-95-ci-for-each-group",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Create emmeans table (mean + 95% CI for each group)",
    "text": "Create emmeans table (mean + 95% CI for each group)\nCalculate a mean and 95% confidence interval for each group (island) of beak widths.\nUsing emmeans() function from the emmeans package\n\nProvides the basics: https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html\n& Lots of vignettes for other uses of functions in this package: https://cran.r-project.org/web/packages/emmeans/index.html\n\n\n# create emmeans table object\nlm_bw_island_emm &lt;- emmeans(lm_bw_island, ~ island)\n\nlm_bw_island_emm\n\n island    emmean     SE df lower.CL upper.CL\n Laysan      7.60 0.0316 89     7.54     7.67\n Southeast   7.77 0.0556 89     7.66     7.88\n North       8.00 0.0787 89     7.84     8.15\n\nConfidence level used: 0.95 \n\n\n\nThe means (emmean column) in the emmeans table are technically “modeled” means, but here, and for many linear models, these will be equal to the sampled means (the means calculated from each group of raw data). This may not be the case for some more complicated models.\nThe 95% CIs in the emmeans table (lower.CL to upper.CL) are calculated using all the data in the model (using a pooled standard deviation and sample size across both groups of data).\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#the-emmeans-table-is-a-table-of-modeled-means-and-inferential-statistics"
  },
  {
    "objectID": "Compare_multiple_means.html#pairwise-differences-between-means-in-contrasts-table-2-options",
    "href": "Compare_multiple_means.html#pairwise-differences-between-means-in-contrasts-table-2-options",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Pairwise differences between means in contrasts table (2 options)",
    "text": "Pairwise differences between means in contrasts table (2 options)\nTo compare the island means to each other (WHAT WE REALLY CARE ABOUT FOR THIS ANALYSIS) you need to pick EITHER :\n\nto do pre-planned contrasts (which we’ll do further down)\n\n**OR**\n\none type of post-hoc (multiple comparisons) procedure that seems most appropriate for the question/experiment/data.\n\n\nHere we’ll first demo the Tukey HSD procedure which is one of the most common “post-hoc” (i.e., after the fact) procedures. This is an “all possible” pairwise comparisons approach that is appropriate if your analysis is exploratory (i.e., you didn’t have specific hypotheses from the outset that you’d expect certain effects and just want to compare all the treatments to see what the data shows).\nNext we’ll demo the pre-planned contrast approach advocated by the author of the text linked to below. This is for a situation where you expected certain treatments may have specific effects and your study is most focused on those specific treatments.\nBut you should NOT use both in your own data analysis or your class assignment (just pick the most appropriate one to use, and use only that approach).\n\ni.e., you SHOULD NOT first do the Tukey HSD procedure, and if you find that the results were not significant, then do the less conservative pre-planned contrasts procedure.\n\n\n\nFor more detail on different types (other options when analyzing your own data) of multiple testing/adjustment procedures see:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#adjustment-for-multiple-tests\nAnd see:\nhttps://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n\nOption 1: Tukey Honestly Significant Difference (HSD) contrasts table & corresponding “effects” plot w/ adjusted 95% CIs and p-values\nhttps://en.wikipedia.org/wiki/Tukey%27s_range_test\n\nruns all possible pairwise tests by default, but the more tests (determined by the number of levels within your factor variable), the more conservative each test becomes (i.e., more each p-value is adjusted larger)\n\n“Contrasts table” using contrast() function from emmeans package\n\nFor details on the argument method = see help(“contrast-methods”)\n\nhttps://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html\n\nThe Tukey HSD procedure is specified in the contrast() function by using both arguments:\n\n\nmethod = \"revpairwise\" or method = \"pairwise\" which will do “all possible” pairwise comparisons.\n\nThe choice of pairwise vs. revpairwise depends on which groups (islands) you want to be first in the difference calculation (switching them with make positive differences become negative and viceversa).\nHow many pairwise comparisons it does depends on how many groups/levels are in your categorical variable.\n\n\n\nadjust = \"tukey\" specifies that the Tukey HSD adjustment will be made to the pairwise 95% CIs and p-values. They will be adjusted larger, and how big that adjustment is depends on the total number of pairwise comparisons being done.\n\n\n\n\nlm_bw_island_pairs &lt;- contrast(lm_bw_island_emm,\n                               method = \"revpairwise\",\n                               adjust = \"tukey\") |&gt;\n  summary(infer = TRUE)\n#Note: method = \"revpairwise\" switches the order in subtraction\n# for comparison (up to researcher/you to determine which is\n# more appropriate)\n\nlm_bw_island_pairs\n\n contrast           estimate     SE df  lower.CL upper.CL t.ratio p.value\n Southeast - Laysan    0.163 0.0640 89  0.010393    0.315   2.546  0.0334\n North - Laysan        0.392 0.0848 89  0.189790    0.594   4.621  &lt;.0001\n North - Southeast     0.229 0.0964 89 -0.000741    0.459   2.376  0.0509\n\nConfidence level used: 0.95 \nConf-level adjustment: tukey method for comparing a family of 3 estimates \nP value adjustment: tukey method for comparing a family of 3 estimates \n\n\nThis table is important for reporting treatment effects and 95% CI and it lm_len_supp_pairs is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-values here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 3.3%, &lt;.01%, or 5.1% chance that these data came from a true population where there was no difference between the respective pairs of means.\n\n\n\nThe the p-values are adjusted (made larger) because you are running 3 different pairwise t-tests simultaneously.\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table\nEffects plot w/ 95% CI (Tukey HSD all pairwise comparisons version)\n\n# note in ggplot below we had to turn the contrast object into\n# a tibble (data.frame) so it would work as data in ggplot\n\nplot_lm_bw_island_pairs &lt;- as_tibble(lm_bw_island_pairs) |&gt;\n  ggplot(aes(\n    y = contrast,\n    x = estimate,\n    label = format.pval(p.value,\n                        digits = 2,\n                        eps = 0.001)\n  )) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (mm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  geom_text(vjust = 0,\n            nudge_y = 0.25,\n            size = 3)\n\nplot_lm_bw_island_pairs\n\n\n\n\nThis plot shows the 3 pairwise differences between the 3 means (each combination of 2 islands), and the 95% CI for those differences (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between those 95% CIs”).\n\nThe dashed line at 0 is there for reference since if the islands had the same average beak width, the difference in their means would be 0.\nThe pairwise difference between North & Laysan was the largest (and it’s 95% CI was not close to crossing 0), it also had the smallest Tukey HSD adjusted p-value in the output above.\nNote for (Southeast - Laysan, and North - Southeast) the two with p-values in the output above close to 0.05, the lower limit of their 95% CIs are close to 0 (i.e. 0 = no difference in beak widths)\nOption 2: Pre-planned contrasts (no adjustments) contrasts table & corresponding “effects” plot w/ 95% CI and p-values\n“Pre-planned contrasts” are typically used if you know in advance that you are primarily interested in just some of the specific pairwise comparisons and these do not have the 95% CIs and p-values “adjusted.” However, the author of the text below advocates for using a version of this approach in most situations (see more below).\n\nBiological question: Do the beak widths differ, on average, among the three populations, and in particular, between the source population (Laysan) and the two Southeast and North Island populations?\nSo we’ll focus on 2 (of the three possible) pairwise comparisons:\n\nSE - Laysan\nN - Laysan\n\n\n\nAccording to: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n“The most transparent best practice is to report all, unadjusted p-values. Reporting all unadjusted p-values allows a reader to compute whatever adjustment they deem appropriate for the question they are addressing. Reporting all p-values could overwhelm the principal message of a figure. Instead, report focal (planned comparison) p-values in the figure and a table of all p-values in the supplement. There should be a table of these for every experiment in the supplement.”\nPre-planned contrasts and associated plot of mean pairwise differences w/ 95% CIs\n\n# Pre-planned contrasts (pairwise mean differences we care\n# about)\n\n# lm_bw_island_emm # print the emmeans table in console to\n# get row numbers (factor level order) for each group\n\n# set the mean as the row number from the emmeans table\nLaysan &lt;- c(1, 0, 0)\nSoutheast &lt;- c(0, 1, 0)\nNorth &lt;- c(0, 0, 1)\n\n# NOTE: if you have more than 3 levels in your factor you'd\n# need to add more ,0 the c() above so there's one for\n# each level.\n\n# the method argument specifies which pre-planned contrasts\n# will be included\nlm_bw_island_planned &lt;- contrast(\n  lm_bw_island_emm,\n  method = list(\n    \"SE - Laysan\" = c(Southeast - Laysan),\n    \"N - Laysan\" = c(North - Laysan)\n  ),\n  adjust = \"none\" # no 95% CI or p-value adjustments\n) |&gt;\n  summary(infer = TRUE)\n\nlm_bw_island_planned\n\n contrast    estimate     SE df lower.CL upper.CL t.ratio p.value\n SE - Laysan    0.163 0.0640 89   0.0358     0.29   2.546  0.0126\n N - Laysan     0.392 0.0848 89   0.2234     0.56   4.621  &lt;.0001\n\nConfidence level used: 0.95 \n\n\nThis table is important for reporting treatment effects and 95% CI and it lm_bw_island_planned is used in the ggplot code below to create the effects plot.\n\nA contrast is a difference in means.\nThe “estimate” column is this difference\n\n95% CI of this difference is lower.CL to upper.CL\nThe columns “t.ratio” and “p.value” contains the t (test statistic) and p values of the significance test of the estimate. The t-statistic is the ratio of the estimate (difference in means) to the SE of the estimate (which includes sd, the spread in the data, and the sample size). It is a signal (the estimate) to noise (SE of the estimate) ratio.\nThe p-values here can also be reported in your results, it is for the significance test: is the difference between the 2 means significantly different from 0?\n\nOr a better interpretation of the p-value here is: what is the probability of getting this data if there was no difference between the 2 means?\n\nAnd interpret it as a %: There is only a 1.3% and &lt;.01% chance that these data came from a true population where there was no difference between the respective pairs of means.\n\n\n\n\nFor more explanation see: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#estimates-of-the-effects-are-in-the-contrasts-table\nEffects plot w/ 95% CI (preplanned contrasts version)\nThis effects plot will just include the 2 pairwise comparisons (Southeast - Laysan & North - Laysan) that we are primarily interested in.\n\n# note in ggplot below we had to turn the contrast object into \n# a tibble (data.frame) so it would work as data in ggplot\nplot_lm_bw_island_planned &lt;- as_tibble(lm_bw_island_planned) |&gt;\n  ggplot(aes(\n    y = contrast,\n    x = estimate,\n    label = format.pval(p.value,\n                        digits = 2,\n                        eps = 0.001)\n  )) +\n  geom_pointrange(aes(xmin = lower.CL,\n                      xmax = upper.CL)) +\n  geom_vline(xintercept = 0, linetype = 2) +\n  xlab(\"Effects (mm)\") +\n  ylab(\"\") +\n  scale_x_continuous(position = \"top\") +\n  theme_classic() +\n  geom_text(vjust = 0,\n            nudge_y = 0.25,\n            size = 3)\n\nplot_lm_bw_island_planned\n\n\n\n\nThis plot shows the 2 (pre-planned) pairwise differences between the selected means (between the origin Laysan Island and the each of the other 2 islands the birds were relocated to), and the 95% CI for those differences (i.e., “if the experiment was repeated, 95% of the time you’d expect the true population mean of the difference between those 95% CIs”).\nThe dashed line at 0 is there for reference since if the islands had the same average beak width, the difference in their means would be 0.\nTable of all pairwise contrasts no adjustments (to include in appendix etc.)\nAccording to: https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/factorial.html#twoway-multiple-tests\n“The most transparent best practice is to report all, unadjusted p-values. Reporting all unadjusted p-values allows a reader to compute whatever adjustment they deem appropriate for the question they are addressing. Reporting all p-values could overwhelm the principal message of a figure. Instead, report focal (planned comparison) p-values in the figure and a table of all p-values in the supplement. There should be a table of these for every experiment in the supplement.”\n\nlm_bw_island_pairs_no_adjust &lt;- contrast(lm_bw_island_emm,\n                                         method = \"revpairwise\",\n                                         adjust = \"none\") |&gt;\n  summary(infer = TRUE)\n\nlm_bw_island_pairs_no_adjust\n\n contrast           estimate     SE df lower.CL upper.CL t.ratio p.value\n Southeast - Laysan    0.163 0.0640 89   0.0358    0.290   2.546  0.0126\n North - Laysan        0.392 0.0848 89   0.2234    0.560   4.621  &lt;.0001\n North - Southeast     0.229 0.0964 89   0.0375    0.421   2.376  0.0197\n\nConfidence level used: 0.95"
  },
  {
    "objectID": "Compare_multiple_means.html#combine-plots-into-a-single-primary-results-figure",
    "href": "Compare_multiple_means.html#combine-plots-into-a-single-primary-results-figure",
    "title": "Week 9 - Comparing more than 2 means (traditionally one-way ANOVA)",
    "section": "Combine plots into a single primary results figure",
    "text": "Combine plots into a single primary results figure\nUse the effects plot above (Tukey HSD or pre-planned contrasts) for the approach you already chose as the most appropriate and use that plot object to create a combined results plot.\nBoth plot options are created here, but for your analysis you will just include 1 option (Tukey HSD or pre-planned contrasts).\nDO NOT INCLUDE BOTH VERSIONS OF THE RESULTS PLOTS BELOW IN YOUR ANALYSIS. PICK ONE.\nOption 1: Tukey HSD all pairwise comparisons versions (with adjusted difference p-values and 95% CIs)\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure.\n\nThe align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\nresults_plot &lt;- plot_grid(\n  plot_lm_bw_island_pairs,\n  plot_lm_bw_island_emm,\n  nrow = 2,\n  align = \"v\",\n  axis = \"rl\",\n  rel_heights = c(0.55, 1)\n)\n# rel_heights argument adjusts the relative size of two plots\n\nresults_plot\n\n\n\n\nOption 2: Preplanned contrasts version (with NO adjustment of p-values or 95% CIs)\nWe’ll use the plot_grid() function from the cowplot package to combine our two plots above into a single results figure.\n\nThe align = \"v\" and axis = \"rl\" arguments make the axes of our 2 plots line up appropriately when combined. See help file for more detail: https://rdrr.io/cran/cowplot/man/plot_grid.html\n\n\n\nresults_plot &lt;- plot_grid(\n  plot_lm_bw_island_planned,\n  plot_lm_bw_island_emm,\n  nrow = 2,\n  align = \"v\",\n  axis = \"rl\",\n  rel_heights = c(0.45, 1)\n)\n# rel_heights argument adjusts the relative size of two plots\n\nresults_plot\n\n\n\n\nThis primary results plot is adapted from code in (the version you are using is based on regular ggplot code): https://www.middleprofessor.com/files/applied-biostatistics_bookdown/_book/oneway.html#step-6-plot-the-model"
  }
]